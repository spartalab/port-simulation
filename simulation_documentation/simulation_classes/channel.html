<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>simulation_classes.channel API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../simulation_classes.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;simulation_classes</a>

            <img src="spartaStacked.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#ChannelSection">ChannelSection</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ChannelSection.can_accommodate_width">can_accommodate_width</a>
                        </li>
                        <li>
                                <a class="function" href="#ChannelSection.can_accommodate_draft">can_accommodate_draft</a>
                        </li>
                        <li>
                                <a class="function" href="#ChannelSection.can_accomodate_gap_out">can_accomodate_gap_out</a>
                        </li>
                        <li>
                                <a class="function" href="#ChannelSection.update_usage">update_usage</a>
                        </li>
                        <li>
                                <a class="function" href="#ChannelSection.space_out">space_out</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Channel">Channel</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Channel.channel_closed">channel_closed</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.channel_closed_restriction">channel_closed_restriction</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.beam_restriction">beam_restriction</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.draft_restriction">draft_restriction</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.minimal_spacing_not_avlbl">minimal_spacing_not_avlbl</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.daylight_restriction">daylight_restriction</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.scheduler">scheduler</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.move_through_channel">move_through_channel</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.check_restrictions">check_restrictions</a>
                        </li>
                        <li>
                                <a class="function" href="#Channel.channel_process">channel_process</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../simulation_classes.html">simulation_classes</a><wbr>.channel    </h1>

                        <div class="docstring"><p>This module defines the Channel and ChannelSection classes for simulating ship navigation through a channel.</p>
</div>

                        <input id="mod-channel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-channel-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">This module defines the Channel and ChannelSection classes for simulating ship navigation through a channel.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">constants</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">simulation_analysis.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">log_line</span><span class="p">,</span> <span class="n">update_ship_logs</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">simulation_handler.helpers</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_daytime</span><span class="p">,</span> <span class="n">save_warning</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="n">CHANNEL_SECTION_DIMENSIONS</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_SECTION_DIMENSIONS</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="n">START_DAYLIGHT_RESTRICTION_HR</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">START_DAYLIGHT_RESTRICTION_HR</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="n">TIME_FACTOR</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TIME_FACTOR</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="n">TIME_COMMON_CHANNEL</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TIME_COMMON_CHANNEL</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="n">TIME_FOR_UTURN</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TIME_FOR_UTURN</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="n">TIME_FOR_TUG_STEER</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TIME_FOR_TUG_STEER</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ChannelSection</span><span class="p">:</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">    Class for each section of the channel    </span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    This class manages the dimensions and capacities of a channel section, </span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    and provides methods to check if a ship can navigate through it based on its width, draft, and other restrictions.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    Args:</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">            env (Env): The simulation environment.</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">            id (int): The identifier for the channel section.</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">            length (float): The length of the channel section.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">            width (float): The width of the channel section.</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">            draft (float): The draft of the channel section.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">            speed (float): The speed of the channel section.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">            simulation_time (int): The total simulation time.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">            safeTwoway (bool): Whether the section is safe for two-way traffic.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">draft</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">simulation_time</span><span class="p">,</span> <span class="n">safeTwoway</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>        <span class="c1"># Initialize the channel section with its dimensions and capacities.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft</span> <span class="o">=</span> <span class="n">draft</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">simulation_time</span> <span class="o">=</span> <span class="n">simulation_time</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span> <span class="o">=</span> <span class="n">safeTwoway</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="c1"># Initialize the containers for width and draft restrictions.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="c1"># Set the capacity for width and draft based on whether the section is safe for two-way traffic.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_capacity</span> <span class="o">=</span> <span class="n">width</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">safeTwoway</span> <span class="k">else</span> <span class="mi">1000000</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_capacity</span> <span class="o">=</span> <span class="n">draft</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">safeTwoway</span> <span class="k">else</span> <span class="mi">1000000</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="c1"># Initialize the containers for width and draft restrictions for each time step.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">simulation_time</span><span class="p">):</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_capacity</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_capacity</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accommodate_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        Check if the channel section can accommodate the width of the ship at a given time step.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        Args:</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width and direction.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        Returns:</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">            bool: True if the section can accommodate the ship&#39;s width, False otherwise.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max beam restrictiom</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>                    <span class="k">continue</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max beam restrictiom</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>                    <span class="k">continue</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>            <span class="c1"># opposite direction combined beam restriction</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accommodate_draft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        Check if the channel section can accommodate the draft of the ship at a given time step.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">        Args:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">            ship_info (dict): Information about the ship, including its draft and direction.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        Returns:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">            bool: True if the section can accommodate the ship&#39;s draft, False otherwise.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max draft restrictiom</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                    <span class="k">continue</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max draft restrictiom</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                    <span class="k">continue</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>            <span class="c1"># opposite direction combined draft restriction</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accomodate_gap_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        Check if the channel section can accommodate the minimum spacing for the ship at a given time step.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">        Args:</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">            bool: True if the section can accommodate the minimum spacing, False otherwise.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>                    <span class="k">continue</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>                    <span class="k">continue</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">        Update the usage of the channel section based on the ship&#39;s information.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        Args:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width, draft, and direction.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        Returns:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">            None</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)):</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>                    <span class="n">excess_width_in</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_width_in</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_width_in</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>                    <span class="n">excess_draft_in</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_draft_in</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_draft_in</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                    <span class="n">excess_width_out</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_width_out</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_width_out</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>                    <span class="n">excess_draft_out</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_draft_out</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_draft_out</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="c1"># assert that the total width and draft in the section is equal to the capacity</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_capacity</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.1</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_capacity</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.1</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="c1"># assert that the width and draft containers are non-negative</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">space_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        Space out the channel section for the ship based on its direction and start time.</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        Args:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">        Returns:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">            None</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))):</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))):</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Channel</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">    Class for the entire channel.</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">    This class manages the sections of the channel and handles ship navigation through it. It implements the necessary methods to check for restrictions, schedule ships, and log their movements.</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">    Args:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        ship_logs (list): List to log ship information.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        env (Env): The simulation environment.</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">        numSections (int): Number of sections in the channel.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        simulation_time (int): Total simulation time for the channel.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        safeTwoway (bool): Whether the channel is safe for two-way traffic.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        channel_events (list): List to log channel events.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        channel_logs (list): List to log channel information.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        day_pilots (simpy.Container): Simpy container for day pilots.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        night_pilots (simpy.Container): Simpy container for night pilots.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        tugboats (simpy.Container): Simpy container for tugboats.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">        turnoffTime (dict): Dictionary with turnoff times and conditions.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        channel_scheduer (Resource): Resource for scheduling channel usage.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        seed (int): Random seed for reproducibility.</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_logs</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">numSections</span><span class="p">,</span> <span class="n">simulation_time</span><span class="p">,</span> <span class="n">safeTwoway</span><span class="p">,</span> <span class="n">channel_events</span><span class="p">,</span> <span class="n">channel_logs</span><span class="p">,</span> <span class="n">day_pilots</span><span class="p">,</span> <span class="n">night_pilots</span><span class="p">,</span> <span class="n">tugboats</span><span class="p">,</span> <span class="n">turnoffTime</span><span class="p">,</span> <span class="n">channel_scheduer</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span> <span class="o">=</span> <span class="n">ship_logs</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">numSections</span> <span class="o">=</span> <span class="n">numSections</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span> <span class="o">=</span> <span class="n">safeTwoway</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_events</span> <span class="o">=</span> <span class="n">channel_events</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_logs</span> <span class="o">=</span> <span class="n">channel_logs</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">simulation_time</span> <span class="o">=</span> <span class="n">simulation_time</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span> <span class="o">=</span> <span class="n">day_pilots</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span> <span class="o">=</span> <span class="n">night_pilots</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span> <span class="o">=</span> <span class="n">tugboats</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span> <span class="o">=</span> <span class="n">turnoffTime</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span> <span class="o">=</span> <span class="n">channel_scheduer</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">ChannelSection</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">*</span><span class="n">CHANNEL_SECTION_DIMENSIONS</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation_time</span><span class="p">),</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numSections</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Creating channel&quot;</span><span class="p">)]</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        Check if the channel is closed at a given time step.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        Args:</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">            time (int): The time step to check for channel closure.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span><span class="p">[</span><span class="s2">&quot;switch&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;channel_closed&quot;</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="k">for</span> <span class="n">start_end_tuples</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span><span class="p">[</span><span class="s2">&quot;closed_between&quot;</span><span class="p">]:</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>                <span class="k">if</span> <span class="n">start_end_tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span> <span class="o">&lt;</span> <span class="n">start_end_tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_closed_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">        Check if the ship has beam restriction in the channel in any section at a given time step.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">        Logic: </span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        - If the ship is entering the channel, check each section from the start to the last section.</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        - If the ship is leaving the channel, check each section from the last section to the start.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        - For each section, calculate the end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">        - For each section, check if the channel is closed at the end time.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        - If the channel is closed at the end time, return True (indicating the channel is closed for the ship).</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        - If no section is closed, return False (indicating the channel is open for the ship).</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        Args:</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        Returns:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">            bool: True if the channel is closed for the ship, False otherwise.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>                    <span class="k">break</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">end_time</span><span class="p">):</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>                    <span class="k">continue</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">end_time</span><span class="p">):</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">beam_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        Check if the ship has beam restriction in the channel in any section at a given time step.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        Logic: </span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        - If the ship is entering the channel, check each section from the start to the last section.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">        - If the ship is leaving the channel, check each section from the last section to the start.</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">        - For each section, calculate the end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">        - For each section, check if the width of the ship exceeds the available width in the section.</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">        - If the width of the ship exceeds the available width in any section, return True (indicating beam restriction).</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">        - If no section has beam restriction, return False (indicating no beam restriction).</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">        Args:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width and direction.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        Returns:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">            bool: True if the ship has beam restriction, False otherwise.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                    <span class="k">break</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_width</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>                    <span class="k">continue</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_width</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">draft_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        Check if the ship has draft restriction in the channel in any section at a given time step.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        Logic is similar to beam_restriction, but checks for draft instead of width.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        Args:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">            ship_info (dict): Information about the ship, including its draft and direction.</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">        Returns:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">            bool: True if the ship has draft restriction, False otherwise.</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>                    <span class="k">break</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_draft</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>                    <span class="k">continue</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_draft</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">minimal_spacing_not_avlbl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">        Check if the minimal spacing for the ship is not available in the channel in any section at a given time step.</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        Logic is similar to beam_restriction, but checks for minimal spacing instead of width.</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        Args:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        Returns:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">            bool: True if the minimal spacing is not available, False otherwise.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>                    <span class="k">break</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accomodate_gap_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>                    <span class="k">continue</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accomodate_gap_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">daylight_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">        Check if the ship has daylight restriction in the channel at a given time step.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        Logic:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">        - Check the ship&#39;s type and dimensions (width and length).</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        - If the ship is a Container, Liquid, or DryBulk type, check if its width or length exceeds the specified limits.</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">        - If the ship exceeds the limits, check if it is daytime at the time of entry.</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">        - If it is not daytime, return True (indicating daylight restriction).</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">        - If the ship does not exceed the limits or it is daytime, return False (indicating no daylight restriction).</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">        Args:</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">            ship_info (dict): Information about the ship, including its type, width, and length.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        Returns:</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">            bool: True if the ship has daylight restriction, False otherwise.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Container&#39;</span><span class="p">:</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>                <span class="c1"># if not daytime return True</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Liquid&#39;</span><span class="p">:</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">:</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DryBulk&#39;</span><span class="p">:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scheduler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">        Schedule the ship to navigate through the channel. This happens before the ship actually moves through the channel.</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">        Logic:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">        - Check if the ship has any restrictions in the channel (beam, draft, daylight, minimal spacing).</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="sd">        - If there are any restrictions, log the ship&#39;s information and return.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">        - If there are no restrictions, update the ship&#39;s logs and schedule the ship to move through the channel.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">        - If the ship is entering the channel, update the usage of each section in the channel.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">        - If the ship is leaving the channel, update the usage of each section in reverse order.</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        - Log the ship&#39;s movement through the channel.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">        - Finally, yield the ship&#39;s movement through the channel.</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">        Note this is different from the move_through_channel method, which is called when the ship actually moves through the channel.</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">        The scheduler method is called as soon as the ship requests to enter the channel.</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">        If the ship has any restrictions, it will not be scheduled to move through the channel.</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">        Args:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, width, draft, and speed.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">        Returns:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">            None</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                    <span class="k">break</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">update_usage</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">space_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>                    <span class="k">continue</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">update_usage</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">section_number</span><span class="p">]</span><span class="o">.</span><span class="n">space_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">move_through_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">):</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">        Simulate the movement of the ship through the channel.</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">        Logic:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">        - If the ship is entering the channel, iterate through each section from the start to the last section.</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        - If the ship is leaving the channel, iterate through each section from the last section to the start.</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">        - For each section, calculate the speed and end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">        - Log the ship&#39;s movement through the section, including its ship_id, ship_type, width, draft, and direction.</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        - Yield the ship&#39;s movement through the section.</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="sd">        - Log the time spent in each section.</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        - Finally, update the ship&#39;s logs with the time spent in the channel.</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">        - If the ship is entering the channel, log the time spent in each section going in.</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        - If the ship is leaving the channel, log the time spent in each section going out.</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        Note this is different from the scheduler method,which schedules before the ship actually moves through the channel.</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">        The sheduler happens as soon as the ship requests to enter the channel.</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">        The move_through_channel method is called when the ship actually moves through the channel (when there are no restrictions).</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">        Args:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">            ship_info (dict): Information about the ship, including its ship_id, ship_type, width, draft, and direction.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">        Returns:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">            None</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="n">enter_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>                    <span class="k">break</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span><span class="p">)</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>                <span class="n">log_line</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot;ships_in_channel.txt&quot;</span><span class="p">,</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>                         <span class="sa">f</span><span class="s2">&quot;Ship </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of width </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> and draft </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> spent from </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_time</span><span class="si">}</span><span class="s2"> in section </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> going in&quot;</span><span class="p">)</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>                    <span class="k">continue</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>                <span class="n">log_line</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot;ships_in_channel.txt&quot;</span><span class="p">,</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>                         <span class="sa">f</span><span class="s2">&quot;Ship </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of width </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> and draft </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> spent from </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_time</span><span class="si">}</span><span class="s2"> in section </span><span class="si">{</span><span class="n">section_number</span><span class="si">}</span><span class="s2"> going out&quot;</span><span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_restrictions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">):</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">        Check if the ship has any restrictions in the channel at a given time step.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">        Args:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, width, draft, and ship type.</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">            request_time (int): The time step when the ship requests to enter the channel.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">            wait_beam (int): The number of time steps the ship has waited for beam restrictions.</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="sd">            wait_draft (int): The number of time steps the ship has waited for draft restrictions.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="sd">            wait_daylight (int): The number of time steps the ship has waited for daylight restrictions.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="sd">        Returns:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a><span class="sd">            tuple: A tuple containing:</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="sd">                - restrictions (bool): True if there are any restrictions, False otherwise.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">                - wait_beam (int): The updated number of time steps the ship has waited for beam restrictions.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">                - wait_draft (int): The updated number of time steps the ship has waited for draft restrictions.</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">                - wait_daylight (int): The updated number of time steps the ship has waited for daylight restrictions.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>        <span class="n">channel_closed_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed_restriction</span><span class="p">(</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="n">beam_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_restriction</span><span class="p">(</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="n">draft_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_restriction</span><span class="p">(</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="n">daylight_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daylight_restriction</span><span class="p">(</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="k">if</span> <span class="n">beam_restriction</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>            <span class="n">wait_beam</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="n">draft_restriction</span><span class="p">:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>            <span class="n">wait_draft</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>        <span class="k">if</span> <span class="n">daylight_restriction</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>            <span class="n">wait_daylight</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>        <span class="n">restrictions</span> <span class="o">=</span> <span class="n">beam_restriction</span> <span class="ow">or</span> <span class="n">draft_restriction</span> <span class="ow">or</span> <span class="n">daylight_restriction</span> <span class="ow">or</span> <span class="n">channel_closed_restriction</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>        <span class="k">return</span> <span class="n">restrictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">run_id</span><span class="p">):</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="sd">        Process for handling the ship&#39;s entry into the channel.</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">        It handles the scheduling and movement of the ship through the channel, including checking for restrictions and logging the ship&#39;s information.</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">        The process has the following steps:</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        1. Check if the ship is entering or leaving the channel based on its direction.</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        2. If the ship is entering the channel, then:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">            2.1. Get the pilots based on the time of day (day or night).</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">            2.2. Check when the ship is allowed to enter being free of restrictions.</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">            2.3 Schedule the ship to move through the channel.</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a><span class="sd">            2.4 Wait till the ship can move through the channel.</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">            2.5 Move the ship through the channel.</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">            2.6 Get the tugboats and steer the ship.</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">        3. If the ship is leaving the channel, then:</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">            3.1. Get the pilots based on the time of day (day or night).</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">            3.2 Get the tugboats and steer the ship.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">            3.3.Check when the ship is allowed to leave being free of restrictions.</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">            3.4 Schedule the ship to move through the channel.</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a><span class="sd">            3.5 Wait till the ship can move through the channel.</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">            3.6 Move the ship through the channel.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">        Args:</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, pilots, tugboats, and other attributes.</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a><span class="sd">            day (bool): Whether it is daytime or nighttime.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">            ship_id (int): The identifier for the ship.</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a><span class="sd">            ship_terminal (str): The terminal where the ship is headed.</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="sd">            ship_type (str): The type of the ship (e.g., Container, Liquid, DryBulk).</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">        Returns:</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a><span class="sd">            None</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>        <span class="n">lastSection</span> <span class="o">=</span> <span class="n">lastSection</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>        <span class="n">request_time_initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>        <span class="n">inbound_closed_tuples</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">INBOUND_CLOSED</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>        <span class="n">outbound_closed_tuples</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">OUTBOUND_CLOSED</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>        <span class="n">wait_queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">request_time_initial</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>        <span class="c1"># If ship travels in</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>            <span class="n">ship_entering_channel_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>            <span class="c1"># get pilots</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>            <span class="n">day</span> <span class="o">=</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">ship_entering_channel_time</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>            <span class="n">time_to_get_pilot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">ship_entering_channel_time</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_pilot_in</span><span class="o">=</span><span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>            <span class="c1"># travel anchorage to mouth of the channel</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>                <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>                             <span class="n">time_to_common_channel_in</span><span class="o">=</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>            <span class="c1"># Schedule the ship to move through the channel</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>                <span class="k">yield</span> <span class="n">request</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>                <span class="n">request_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>                <span class="n">wait_daylight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>                <span class="n">wait_beam</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>                <span class="n">wait_draft</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>                <span class="c1"># Note that multiple restrictions can be active at the same time</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>                <span class="n">wait_total_restriction</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>                <span class="n">wait_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">:</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>                    <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>                    <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>                            <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>                    <span class="k">while</span> <span class="n">restrcictions</span> <span class="ow">or</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_inbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="n">channel_closed_inbound</span><span class="p">:</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Channel closed inbound at time&quot;</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>                        <span class="n">wait_total_restriction</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>                        <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>                        <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>                                <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>                    <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>                            <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>                    <span class="k">while</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_inbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>                        <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>                                <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>                <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>                                 <span class="n">time_for_restriction_in</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B:</span><span class="si">{</span><span class="n">wait_beam</span><span class="si">}</span><span class="s1">, D:</span><span class="si">{</span><span class="n">wait_draft</span><span class="si">}</span><span class="s1">, DL:</span><span class="si">{</span><span class="n">wait_daylight</span><span class="si">}</span><span class="s1">, Q:</span><span class="si">{</span><span class="n">wait_queue</span><span class="si">}</span><span class="s1">, T:</span><span class="si">{</span><span class="n">wait_total</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>                               <span class="n">enter_time</span><span class="o">=</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>            <span class="c1"># travel through the channel</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">request_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>            <span class="n">time_entered_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move_through_channel</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">))</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>            <span class="n">time_to_travel_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_entered_channel</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>                             <span class="n">time_to_travel_channel_in</span><span class="o">=</span><span class="n">time_to_travel_channel</span><span class="p">)</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>            <span class="c1"># get tugs</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>            <span class="n">time_tug_req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>            <span class="n">time_to_get_tugs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_tug_req</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_tugs_in</span><span class="o">=</span><span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>            <span class="c1"># steer the ship</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>            <span class="n">time_to_tug_steer</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>                <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_tug_steer_in</span><span class="o">=</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>            <span class="c1"># put the tugs back</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>            <span class="c1"># Release pilots</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a>            <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;out&#39;</span> <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span> <span class="k">else</span> <span class="s1">&#39;in&#39;</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a>        <span class="c1"># If ship travels out</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>        <span class="c1"># Dont enter this if ship is going in even though ship_info[&#39;direction&#39;] is &#39;out&#39;</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a>            <span class="n">ship_entering_channel_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a>            <span class="c1"># get pilots</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a>            <span class="n">day</span> <span class="o">=</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">ship_entering_channel_time</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a>            <span class="n">time_to_get_pilot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">ship_entering_channel_time</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_pilot_out</span><span class="o">=</span><span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>            <span class="c1"># get tugs</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a>            <span class="n">time_to_get_tugs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_tugs_out</span><span class="o">=</span><span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a>            <span class="c1"># make a uturn</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a>            <span class="n">time_to_uturn</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a>                <span class="n">TIME_FOR_UTURN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_UTURN</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_uturn</span><span class="p">)</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a>            <span class="n">time_for_uturn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span> <span class="o">+</span> <span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_for_uturn</span><span class="o">=</span><span class="n">time_for_uturn</span><span class="p">)</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a>            <span class="c1"># steer the ship</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a>            <span class="n">time_to_tug_steer</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a>                <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_tug_steer_out</span><span class="o">=</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a>            <span class="c1"># put the tugs back</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a>            <span class="c1"># Schedule the ship to move through the channel</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a>                <span class="k">yield</span> <span class="n">request</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a>                <span class="n">request_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a>                <span class="n">wait_daylight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a>                <span class="n">wait_beam</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a>                <span class="n">wait_draft</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a>                <span class="c1"># Note that multiple restrictions can be active at the same time</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a>                <span class="n">wait_total_restriction</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a>                <span class="n">wait_queue</span> <span class="o">=</span> <span class="n">request_time</span> <span class="o">-</span> <span class="n">request_time_initial</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a>                <span class="n">wait_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">:</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a>                    <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a>                    <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a>                            <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a>                    <span class="k">while</span> <span class="n">restrcictions</span> <span class="ow">or</span> <span class="n">channel_closed_outbound</span> <span class="ow">or</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a>
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a>                        <span class="k">if</span> <span class="n">channel_closed_outbound</span><span class="p">:</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Channel closed outbound at time&quot;</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a>                        <span class="n">wait_total_restriction</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos">830</span></a>                        <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos">831</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos">832</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos">833</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos">834</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos">835</span></a>
</span><span id="L-836"><a href="#L-836"><span class="linenos">836</span></a>                        <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos">837</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos">838</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos">839</span></a>                                <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos">840</span></a>
</span><span id="L-841"><a href="#L-841"><span class="linenos">841</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos">842</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos">843</span></a>                    <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos">844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos">845</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos">846</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos">847</span></a>                            <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos">848</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos">849</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos">850</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos">851</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos">852</span></a>                    <span class="k">while</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_outbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos">853</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos">854</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos">855</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos">856</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos">857</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos">858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos">859</span></a>                        <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos">860</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos">861</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos">862</span></a>                                <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos">863</span></a>
</span><span id="L-864"><a href="#L-864"><span class="linenos">864</span></a>                <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos">865</span></a>                                 <span class="n">time_for_restriction_out</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B:</span><span class="si">{</span><span class="n">wait_beam</span><span class="si">}</span><span class="s1">, D:</span><span class="si">{</span><span class="n">wait_draft</span><span class="si">}</span><span class="s1">, DL:</span><span class="si">{</span><span class="n">wait_daylight</span><span class="si">}</span><span class="s1">, Q:</span><span class="si">{</span><span class="n">wait_queue</span><span class="si">}</span><span class="s1">, T:</span><span class="si">{</span><span class="n">wait_total</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos">866</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos">867</span></a>                               <span class="n">enter_time</span><span class="o">=</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos">868</span></a>
</span><span id="L-869"><a href="#L-869"><span class="linenos">869</span></a>            <span class="c1"># travel through the channel</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos">870</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">request_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos">871</span></a>            <span class="n">time_entered_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos">872</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move_through_channel</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">))</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos">873</span></a>            <span class="n">time_to_travel_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_entered_channel</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos">874</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos">875</span></a>                             <span class="n">time_to_travel_channel_out</span><span class="o">=</span><span class="n">time_to_travel_channel</span><span class="p">)</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos">876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos">877</span></a>            <span class="c1"># travel from mouth of the channel to anchorage</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos">878</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos">879</span></a>                <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos">880</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos">881</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos">882</span></a>                             <span class="n">time_to_common_channel_out</span><span class="o">=</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos">883</span></a>
</span><span id="L-884"><a href="#L-884"><span class="linenos">884</span></a>            <span class="c1"># Release pilots</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos">885</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos">886</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos">887</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos">888</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span></pre></div>


            </section>
                <section id="ChannelSection">
                            <input id="ChannelSection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ChannelSection</span>:

                <label class="view-source-button" for="ChannelSection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChannelSection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChannelSection-22"><a href="#ChannelSection-22"><span class="linenos"> 22</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ChannelSection</span><span class="p">:</span>
</span><span id="ChannelSection-23"><a href="#ChannelSection-23"><span class="linenos"> 23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChannelSection-24"><a href="#ChannelSection-24"><span class="linenos"> 24</span></a><span class="sd">    Class for each section of the channel    </span>
</span><span id="ChannelSection-25"><a href="#ChannelSection-25"><span class="linenos"> 25</span></a><span class="sd">    This class manages the dimensions and capacities of a channel section, </span>
</span><span id="ChannelSection-26"><a href="#ChannelSection-26"><span class="linenos"> 26</span></a><span class="sd">    and provides methods to check if a ship can navigate through it based on its width, draft, and other restrictions.</span>
</span><span id="ChannelSection-27"><a href="#ChannelSection-27"><span class="linenos"> 27</span></a>
</span><span id="ChannelSection-28"><a href="#ChannelSection-28"><span class="linenos"> 28</span></a><span class="sd">    Args:</span>
</span><span id="ChannelSection-29"><a href="#ChannelSection-29"><span class="linenos"> 29</span></a><span class="sd">            env (Env): The simulation environment.</span>
</span><span id="ChannelSection-30"><a href="#ChannelSection-30"><span class="linenos"> 30</span></a><span class="sd">            id (int): The identifier for the channel section.</span>
</span><span id="ChannelSection-31"><a href="#ChannelSection-31"><span class="linenos"> 31</span></a><span class="sd">            length (float): The length of the channel section.</span>
</span><span id="ChannelSection-32"><a href="#ChannelSection-32"><span class="linenos"> 32</span></a><span class="sd">            width (float): The width of the channel section.</span>
</span><span id="ChannelSection-33"><a href="#ChannelSection-33"><span class="linenos"> 33</span></a><span class="sd">            draft (float): The draft of the channel section.</span>
</span><span id="ChannelSection-34"><a href="#ChannelSection-34"><span class="linenos"> 34</span></a><span class="sd">            speed (float): The speed of the channel section.</span>
</span><span id="ChannelSection-35"><a href="#ChannelSection-35"><span class="linenos"> 35</span></a><span class="sd">            simulation_time (int): The total simulation time.</span>
</span><span id="ChannelSection-36"><a href="#ChannelSection-36"><span class="linenos"> 36</span></a><span class="sd">            safeTwoway (bool): Whether the section is safe for two-way traffic.</span>
</span><span id="ChannelSection-37"><a href="#ChannelSection-37"><span class="linenos"> 37</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ChannelSection-38"><a href="#ChannelSection-38"><span class="linenos"> 38</span></a>
</span><span id="ChannelSection-39"><a href="#ChannelSection-39"><span class="linenos"> 39</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">draft</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">simulation_time</span><span class="p">,</span> <span class="n">safeTwoway</span><span class="p">):</span>
</span><span id="ChannelSection-40"><a href="#ChannelSection-40"><span class="linenos"> 40</span></a>        <span class="c1"># Initialize the channel section with its dimensions and capacities.</span>
</span><span id="ChannelSection-41"><a href="#ChannelSection-41"><span class="linenos"> 41</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="ChannelSection-42"><a href="#ChannelSection-42"><span class="linenos"> 42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
</span><span id="ChannelSection-43"><a href="#ChannelSection-43"><span class="linenos"> 43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
</span><span id="ChannelSection-44"><a href="#ChannelSection-44"><span class="linenos"> 44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft</span> <span class="o">=</span> <span class="n">draft</span>
</span><span id="ChannelSection-45"><a href="#ChannelSection-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
</span><span id="ChannelSection-46"><a href="#ChannelSection-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">simulation_time</span> <span class="o">=</span> <span class="n">simulation_time</span>
</span><span id="ChannelSection-47"><a href="#ChannelSection-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>
</span><span id="ChannelSection-48"><a href="#ChannelSection-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span> <span class="o">=</span> <span class="n">safeTwoway</span>
</span><span id="ChannelSection-49"><a href="#ChannelSection-49"><span class="linenos"> 49</span></a>
</span><span id="ChannelSection-50"><a href="#ChannelSection-50"><span class="linenos"> 50</span></a>        <span class="c1"># Initialize the containers for width and draft restrictions.</span>
</span><span id="ChannelSection-51"><a href="#ChannelSection-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-52"><a href="#ChannelSection-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-53"><a href="#ChannelSection-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-54"><a href="#ChannelSection-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-55"><a href="#ChannelSection-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-56"><a href="#ChannelSection-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-57"><a href="#ChannelSection-57"><span class="linenos"> 57</span></a>
</span><span id="ChannelSection-58"><a href="#ChannelSection-58"><span class="linenos"> 58</span></a>        <span class="c1"># Set the capacity for width and draft based on whether the section is safe for two-way traffic.</span>
</span><span id="ChannelSection-59"><a href="#ChannelSection-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width_capacity</span> <span class="o">=</span> <span class="n">width</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">safeTwoway</span> <span class="k">else</span> <span class="mi">1000000</span>
</span><span id="ChannelSection-60"><a href="#ChannelSection-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draft_capacity</span> <span class="o">=</span> <span class="n">draft</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">safeTwoway</span> <span class="k">else</span> <span class="mi">1000000</span>
</span><span id="ChannelSection-61"><a href="#ChannelSection-61"><span class="linenos"> 61</span></a>
</span><span id="ChannelSection-62"><a href="#ChannelSection-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-63"><a href="#ChannelSection-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChannelSection-64"><a href="#ChannelSection-64"><span class="linenos"> 64</span></a>
</span><span id="ChannelSection-65"><a href="#ChannelSection-65"><span class="linenos"> 65</span></a>        <span class="c1"># Initialize the containers for width and draft restrictions for each time step.</span>
</span><span id="ChannelSection-66"><a href="#ChannelSection-66"><span class="linenos"> 66</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">simulation_time</span><span class="p">):</span>
</span><span id="ChannelSection-67"><a href="#ChannelSection-67"><span class="linenos"> 67</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_capacity</span>
</span><span id="ChannelSection-68"><a href="#ChannelSection-68"><span class="linenos"> 68</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ChannelSection-69"><a href="#ChannelSection-69"><span class="linenos"> 69</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ChannelSection-70"><a href="#ChannelSection-70"><span class="linenos"> 70</span></a>
</span><span id="ChannelSection-71"><a href="#ChannelSection-71"><span class="linenos"> 71</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_capacity</span>
</span><span id="ChannelSection-72"><a href="#ChannelSection-72"><span class="linenos"> 72</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ChannelSection-73"><a href="#ChannelSection-73"><span class="linenos"> 73</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ChannelSection-74"><a href="#ChannelSection-74"><span class="linenos"> 74</span></a>
</span><span id="ChannelSection-75"><a href="#ChannelSection-75"><span class="linenos"> 75</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="ChannelSection-76"><a href="#ChannelSection-76"><span class="linenos"> 76</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="ChannelSection-77"><a href="#ChannelSection-77"><span class="linenos"> 77</span></a>
</span><span id="ChannelSection-78"><a href="#ChannelSection-78"><span class="linenos"> 78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accommodate_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="ChannelSection-79"><a href="#ChannelSection-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChannelSection-80"><a href="#ChannelSection-80"><span class="linenos"> 80</span></a><span class="sd">        Check if the channel section can accommodate the width of the ship at a given time step.</span>
</span><span id="ChannelSection-81"><a href="#ChannelSection-81"><span class="linenos"> 81</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection-82"><a href="#ChannelSection-82"><span class="linenos"> 82</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width and direction.</span>
</span><span id="ChannelSection-83"><a href="#ChannelSection-83"><span class="linenos"> 83</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-84"><a href="#ChannelSection-84"><span class="linenos"> 84</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-85"><a href="#ChannelSection-85"><span class="linenos"> 85</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection-86"><a href="#ChannelSection-86"><span class="linenos"> 86</span></a><span class="sd">            bool: True if the section can accommodate the ship&#39;s width, False otherwise.</span>
</span><span id="ChannelSection-87"><a href="#ChannelSection-87"><span class="linenos"> 87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection-88"><a href="#ChannelSection-88"><span class="linenos"> 88</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection-89"><a href="#ChannelSection-89"><span class="linenos"> 89</span></a>
</span><span id="ChannelSection-90"><a href="#ChannelSection-90"><span class="linenos"> 90</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max beam restrictiom</span>
</span><span id="ChannelSection-91"><a href="#ChannelSection-91"><span class="linenos"> 91</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-92"><a href="#ChannelSection-92"><span class="linenos"> 92</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection-93"><a href="#ChannelSection-93"><span class="linenos"> 93</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max beam restrictiom</span>
</span><span id="ChannelSection-94"><a href="#ChannelSection-94"><span class="linenos"> 94</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-95"><a href="#ChannelSection-95"><span class="linenos"> 95</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection-96"><a href="#ChannelSection-96"><span class="linenos"> 96</span></a>            <span class="c1"># opposite direction combined beam restriction</span>
</span><span id="ChannelSection-97"><a href="#ChannelSection-97"><span class="linenos"> 97</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-98"><a href="#ChannelSection-98"><span class="linenos"> 98</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-99"><a href="#ChannelSection-99"><span class="linenos"> 99</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-100"><a href="#ChannelSection-100"><span class="linenos">100</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection-101"><a href="#ChannelSection-101"><span class="linenos">101</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection-102"><a href="#ChannelSection-102"><span class="linenos">102</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-103"><a href="#ChannelSection-103"><span class="linenos">103</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-104"><a href="#ChannelSection-104"><span class="linenos">104</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-105"><a href="#ChannelSection-105"><span class="linenos">105</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection-106"><a href="#ChannelSection-106"><span class="linenos">106</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection-107"><a href="#ChannelSection-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="ChannelSection-108"><a href="#ChannelSection-108"><span class="linenos">108</span></a>
</span><span id="ChannelSection-109"><a href="#ChannelSection-109"><span class="linenos">109</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accommodate_draft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="ChannelSection-110"><a href="#ChannelSection-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="ChannelSection-111"><a href="#ChannelSection-111"><span class="linenos">111</span></a><span class="sd">        Check if the channel section can accommodate the draft of the ship at a given time step.</span>
</span><span id="ChannelSection-112"><a href="#ChannelSection-112"><span class="linenos">112</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection-113"><a href="#ChannelSection-113"><span class="linenos">113</span></a><span class="sd">            ship_info (dict): Information about the ship, including its draft and direction.</span>
</span><span id="ChannelSection-114"><a href="#ChannelSection-114"><span class="linenos">114</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-115"><a href="#ChannelSection-115"><span class="linenos">115</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-116"><a href="#ChannelSection-116"><span class="linenos">116</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection-117"><a href="#ChannelSection-117"><span class="linenos">117</span></a><span class="sd">            bool: True if the section can accommodate the ship&#39;s draft, False otherwise.</span>
</span><span id="ChannelSection-118"><a href="#ChannelSection-118"><span class="linenos">118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection-119"><a href="#ChannelSection-119"><span class="linenos">119</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection-120"><a href="#ChannelSection-120"><span class="linenos">120</span></a>
</span><span id="ChannelSection-121"><a href="#ChannelSection-121"><span class="linenos">121</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max draft restrictiom</span>
</span><span id="ChannelSection-122"><a href="#ChannelSection-122"><span class="linenos">122</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-123"><a href="#ChannelSection-123"><span class="linenos">123</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection-124"><a href="#ChannelSection-124"><span class="linenos">124</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max draft restrictiom</span>
</span><span id="ChannelSection-125"><a href="#ChannelSection-125"><span class="linenos">125</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-126"><a href="#ChannelSection-126"><span class="linenos">126</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection-127"><a href="#ChannelSection-127"><span class="linenos">127</span></a>            <span class="c1"># opposite direction combined draft restriction</span>
</span><span id="ChannelSection-128"><a href="#ChannelSection-128"><span class="linenos">128</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-129"><a href="#ChannelSection-129"><span class="linenos">129</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-130"><a href="#ChannelSection-130"><span class="linenos">130</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-131"><a href="#ChannelSection-131"><span class="linenos">131</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection-132"><a href="#ChannelSection-132"><span class="linenos">132</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection-133"><a href="#ChannelSection-133"><span class="linenos">133</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-134"><a href="#ChannelSection-134"><span class="linenos">134</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-135"><a href="#ChannelSection-135"><span class="linenos">135</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-136"><a href="#ChannelSection-136"><span class="linenos">136</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection-137"><a href="#ChannelSection-137"><span class="linenos">137</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection-138"><a href="#ChannelSection-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="ChannelSection-139"><a href="#ChannelSection-139"><span class="linenos">139</span></a>
</span><span id="ChannelSection-140"><a href="#ChannelSection-140"><span class="linenos">140</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accomodate_gap_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="ChannelSection-141"><a href="#ChannelSection-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChannelSection-142"><a href="#ChannelSection-142"><span class="linenos">142</span></a><span class="sd">        Check if the channel section can accommodate the minimum spacing for the ship at a given time step.</span>
</span><span id="ChannelSection-143"><a href="#ChannelSection-143"><span class="linenos">143</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection-144"><a href="#ChannelSection-144"><span class="linenos">144</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-145"><a href="#ChannelSection-145"><span class="linenos">145</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="ChannelSection-146"><a href="#ChannelSection-146"><span class="linenos">146</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection-147"><a href="#ChannelSection-147"><span class="linenos">147</span></a><span class="sd">            bool: True if the section can accommodate the minimum spacing, False otherwise.</span>
</span><span id="ChannelSection-148"><a href="#ChannelSection-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection-149"><a href="#ChannelSection-149"><span class="linenos">149</span></a>
</span><span id="ChannelSection-150"><a href="#ChannelSection-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-151"><a href="#ChannelSection-151"><span class="linenos">151</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection-152"><a href="#ChannelSection-152"><span class="linenos">152</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ChannelSection-153"><a href="#ChannelSection-153"><span class="linenos">153</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection-154"><a href="#ChannelSection-154"><span class="linenos">154</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection-155"><a href="#ChannelSection-155"><span class="linenos">155</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="ChannelSection-156"><a href="#ChannelSection-156"><span class="linenos">156</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ChannelSection-157"><a href="#ChannelSection-157"><span class="linenos">157</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection-158"><a href="#ChannelSection-158"><span class="linenos">158</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ChannelSection-159"><a href="#ChannelSection-159"><span class="linenos">159</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection-160"><a href="#ChannelSection-160"><span class="linenos">160</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection-161"><a href="#ChannelSection-161"><span class="linenos">161</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="ChannelSection-162"><a href="#ChannelSection-162"><span class="linenos">162</span></a>
</span><span id="ChannelSection-163"><a href="#ChannelSection-163"><span class="linenos">163</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="ChannelSection-164"><a href="#ChannelSection-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChannelSection-165"><a href="#ChannelSection-165"><span class="linenos">165</span></a><span class="sd">        Update the usage of the channel section based on the ship&#39;s information.</span>
</span><span id="ChannelSection-166"><a href="#ChannelSection-166"><span class="linenos">166</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection-167"><a href="#ChannelSection-167"><span class="linenos">167</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="ChannelSection-168"><a href="#ChannelSection-168"><span class="linenos">168</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width, draft, and direction.</span>
</span><span id="ChannelSection-169"><a href="#ChannelSection-169"><span class="linenos">169</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-170"><a href="#ChannelSection-170"><span class="linenos">170</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-171"><a href="#ChannelSection-171"><span class="linenos">171</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection-172"><a href="#ChannelSection-172"><span class="linenos">172</span></a><span class="sd">            None</span>
</span><span id="ChannelSection-173"><a href="#ChannelSection-173"><span class="linenos">173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection-174"><a href="#ChannelSection-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)):</span>
</span><span id="ChannelSection-175"><a href="#ChannelSection-175"><span class="linenos">175</span></a>
</span><span id="ChannelSection-176"><a href="#ChannelSection-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-177"><a href="#ChannelSection-177"><span class="linenos">177</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-178"><a href="#ChannelSection-178"><span class="linenos">178</span></a>                    <span class="n">excess_width_in</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-179"><a href="#ChannelSection-179"><span class="linenos">179</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-180"><a href="#ChannelSection-180"><span class="linenos">180</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_width_in</span>
</span><span id="ChannelSection-181"><a href="#ChannelSection-181"><span class="linenos">181</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_width_in</span>
</span><span id="ChannelSection-182"><a href="#ChannelSection-182"><span class="linenos">182</span></a>
</span><span id="ChannelSection-183"><a href="#ChannelSection-183"><span class="linenos">183</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-184"><a href="#ChannelSection-184"><span class="linenos">184</span></a>                    <span class="n">excess_draft_in</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-185"><a href="#ChannelSection-185"><span class="linenos">185</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-186"><a href="#ChannelSection-186"><span class="linenos">186</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_draft_in</span>
</span><span id="ChannelSection-187"><a href="#ChannelSection-187"><span class="linenos">187</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_draft_in</span>
</span><span id="ChannelSection-188"><a href="#ChannelSection-188"><span class="linenos">188</span></a>
</span><span id="ChannelSection-189"><a href="#ChannelSection-189"><span class="linenos">189</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-190"><a href="#ChannelSection-190"><span class="linenos">190</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-191"><a href="#ChannelSection-191"><span class="linenos">191</span></a>                    <span class="n">excess_width_out</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-192"><a href="#ChannelSection-192"><span class="linenos">192</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-193"><a href="#ChannelSection-193"><span class="linenos">193</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_width_out</span>
</span><span id="ChannelSection-194"><a href="#ChannelSection-194"><span class="linenos">194</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_width_out</span>
</span><span id="ChannelSection-195"><a href="#ChannelSection-195"><span class="linenos">195</span></a>
</span><span id="ChannelSection-196"><a href="#ChannelSection-196"><span class="linenos">196</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection-197"><a href="#ChannelSection-197"><span class="linenos">197</span></a>                    <span class="n">excess_draft_out</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection-198"><a href="#ChannelSection-198"><span class="linenos">198</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection-199"><a href="#ChannelSection-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_draft_out</span>
</span><span id="ChannelSection-200"><a href="#ChannelSection-200"><span class="linenos">200</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_draft_out</span>
</span><span id="ChannelSection-201"><a href="#ChannelSection-201"><span class="linenos">201</span></a>
</span><span id="ChannelSection-202"><a href="#ChannelSection-202"><span class="linenos">202</span></a>            <span class="c1"># assert that the total width and draft in the section is equal to the capacity</span>
</span><span id="ChannelSection-203"><a href="#ChannelSection-203"><span class="linenos">203</span></a>            <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span>
</span><span id="ChannelSection-204"><a href="#ChannelSection-204"><span class="linenos">204</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_capacity</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.1</span>
</span><span id="ChannelSection-205"><a href="#ChannelSection-205"><span class="linenos">205</span></a>            <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span>
</span><span id="ChannelSection-206"><a href="#ChannelSection-206"><span class="linenos">206</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_capacity</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.1</span>
</span><span id="ChannelSection-207"><a href="#ChannelSection-207"><span class="linenos">207</span></a>            <span class="c1"># assert that the width and draft containers are non-negative</span>
</span><span id="ChannelSection-208"><a href="#ChannelSection-208"><span class="linenos">208</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="ChannelSection-209"><a href="#ChannelSection-209"><span class="linenos">209</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="ChannelSection-210"><a href="#ChannelSection-210"><span class="linenos">210</span></a>
</span><span id="ChannelSection-211"><a href="#ChannelSection-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">space_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="ChannelSection-212"><a href="#ChannelSection-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="ChannelSection-213"><a href="#ChannelSection-213"><span class="linenos">213</span></a><span class="sd">        Space out the channel section for the ship based on its direction and start time.</span>
</span><span id="ChannelSection-214"><a href="#ChannelSection-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection-215"><a href="#ChannelSection-215"><span class="linenos">215</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection-216"><a href="#ChannelSection-216"><span class="linenos">216</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="ChannelSection-217"><a href="#ChannelSection-217"><span class="linenos">217</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection-218"><a href="#ChannelSection-218"><span class="linenos">218</span></a><span class="sd">            None</span>
</span><span id="ChannelSection-219"><a href="#ChannelSection-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection-220"><a href="#ChannelSection-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection-221"><a href="#ChannelSection-221"><span class="linenos">221</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))):</span>
</span><span id="ChannelSection-222"><a href="#ChannelSection-222"><span class="linenos">222</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="ChannelSection-223"><a href="#ChannelSection-223"><span class="linenos">223</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ChannelSection-224"><a href="#ChannelSection-224"><span class="linenos">224</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ChannelSection-225"><a href="#ChannelSection-225"><span class="linenos">225</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))):</span>
</span><span id="ChannelSection-226"><a href="#ChannelSection-226"><span class="linenos">226</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="ChannelSection-227"><a href="#ChannelSection-227"><span class="linenos">227</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Class for each section of the channel<br />
This class manages the dimensions and capacities of a channel section, 
and provides methods to check if a ship can navigate through it based on its width, draft, and other restrictions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>env (Env):</strong>  The simulation environment.</li>
<li><strong>id (int):</strong>  The identifier for the channel section.</li>
<li><strong>length (float):</strong>  The length of the channel section.</li>
<li><strong>width (float):</strong>  The width of the channel section.</li>
<li><strong>draft (float):</strong>  The draft of the channel section.</li>
<li><strong>speed (float):</strong>  The speed of the channel section.</li>
<li><strong>simulation_time (int):</strong>  The total simulation time.</li>
<li><strong>safeTwoway (bool):</strong>  Whether the section is safe for two-way traffic.</li>
</ul>
</div>


                            <div id="ChannelSection.can_accommodate_width" class="classattr">
                                        <input id="ChannelSection.can_accommodate_width-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">can_accommodate_width</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">start_time</span>, </span><span class="param"><span class="n">end_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ChannelSection.can_accommodate_width-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChannelSection.can_accommodate_width"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChannelSection.can_accommodate_width-78"><a href="#ChannelSection.can_accommodate_width-78"><span class="linenos"> 78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accommodate_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_width-79"><a href="#ChannelSection.can_accommodate_width-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChannelSection.can_accommodate_width-80"><a href="#ChannelSection.can_accommodate_width-80"><span class="linenos"> 80</span></a><span class="sd">        Check if the channel section can accommodate the width of the ship at a given time step.</span>
</span><span id="ChannelSection.can_accommodate_width-81"><a href="#ChannelSection.can_accommodate_width-81"><span class="linenos"> 81</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection.can_accommodate_width-82"><a href="#ChannelSection.can_accommodate_width-82"><span class="linenos"> 82</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width and direction.</span>
</span><span id="ChannelSection.can_accommodate_width-83"><a href="#ChannelSection.can_accommodate_width-83"><span class="linenos"> 83</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.can_accommodate_width-84"><a href="#ChannelSection.can_accommodate_width-84"><span class="linenos"> 84</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.can_accommodate_width-85"><a href="#ChannelSection.can_accommodate_width-85"><span class="linenos"> 85</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection.can_accommodate_width-86"><a href="#ChannelSection.can_accommodate_width-86"><span class="linenos"> 86</span></a><span class="sd">            bool: True if the section can accommodate the ship&#39;s width, False otherwise.</span>
</span><span id="ChannelSection.can_accommodate_width-87"><a href="#ChannelSection.can_accommodate_width-87"><span class="linenos"> 87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection.can_accommodate_width-88"><a href="#ChannelSection.can_accommodate_width-88"><span class="linenos"> 88</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_width-89"><a href="#ChannelSection.can_accommodate_width-89"><span class="linenos"> 89</span></a>
</span><span id="ChannelSection.can_accommodate_width-90"><a href="#ChannelSection.can_accommodate_width-90"><span class="linenos"> 90</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max beam restrictiom</span>
</span><span id="ChannelSection.can_accommodate_width-91"><a href="#ChannelSection.can_accommodate_width-91"><span class="linenos"> 91</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.can_accommodate_width-92"><a href="#ChannelSection.can_accommodate_width-92"><span class="linenos"> 92</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection.can_accommodate_width-93"><a href="#ChannelSection.can_accommodate_width-93"><span class="linenos"> 93</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max beam restrictiom</span>
</span><span id="ChannelSection.can_accommodate_width-94"><a href="#ChannelSection.can_accommodate_width-94"><span class="linenos"> 94</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.can_accommodate_width-95"><a href="#ChannelSection.can_accommodate_width-95"><span class="linenos"> 95</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection.can_accommodate_width-96"><a href="#ChannelSection.can_accommodate_width-96"><span class="linenos"> 96</span></a>            <span class="c1"># opposite direction combined beam restriction</span>
</span><span id="ChannelSection.can_accommodate_width-97"><a href="#ChannelSection.can_accommodate_width-97"><span class="linenos"> 97</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.can_accommodate_width-98"><a href="#ChannelSection.can_accommodate_width-98"><span class="linenos"> 98</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.can_accommodate_width-99"><a href="#ChannelSection.can_accommodate_width-99"><span class="linenos"> 99</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.can_accommodate_width-100"><a href="#ChannelSection.can_accommodate_width-100"><span class="linenos">100</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_width-101"><a href="#ChannelSection.can_accommodate_width-101"><span class="linenos">101</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection.can_accommodate_width-102"><a href="#ChannelSection.can_accommodate_width-102"><span class="linenos">102</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.can_accommodate_width-103"><a href="#ChannelSection.can_accommodate_width-103"><span class="linenos">103</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.can_accommodate_width-104"><a href="#ChannelSection.can_accommodate_width-104"><span class="linenos">104</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.can_accommodate_width-105"><a href="#ChannelSection.can_accommodate_width-105"><span class="linenos">105</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_width-106"><a href="#ChannelSection.can_accommodate_width-106"><span class="linenos">106</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection.can_accommodate_width-107"><a href="#ChannelSection.can_accommodate_width-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Check if the channel section can accommodate the width of the ship at a given time step.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its width and direction.</li>
<li><strong>start_time (int):</strong>  The start time of the ship's passage through the section.</li>
<li><strong>end_time (int):</strong>  The end time of the ship's passage through the section.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the section can accommodate the ship's width, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="ChannelSection.can_accommodate_draft" class="classattr">
                                        <input id="ChannelSection.can_accommodate_draft-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">can_accommodate_draft</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">start_time</span>, </span><span class="param"><span class="n">end_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ChannelSection.can_accommodate_draft-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChannelSection.can_accommodate_draft"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChannelSection.can_accommodate_draft-109"><a href="#ChannelSection.can_accommodate_draft-109"><span class="linenos">109</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accommodate_draft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_draft-110"><a href="#ChannelSection.can_accommodate_draft-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="ChannelSection.can_accommodate_draft-111"><a href="#ChannelSection.can_accommodate_draft-111"><span class="linenos">111</span></a><span class="sd">        Check if the channel section can accommodate the draft of the ship at a given time step.</span>
</span><span id="ChannelSection.can_accommodate_draft-112"><a href="#ChannelSection.can_accommodate_draft-112"><span class="linenos">112</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection.can_accommodate_draft-113"><a href="#ChannelSection.can_accommodate_draft-113"><span class="linenos">113</span></a><span class="sd">            ship_info (dict): Information about the ship, including its draft and direction.</span>
</span><span id="ChannelSection.can_accommodate_draft-114"><a href="#ChannelSection.can_accommodate_draft-114"><span class="linenos">114</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.can_accommodate_draft-115"><a href="#ChannelSection.can_accommodate_draft-115"><span class="linenos">115</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.can_accommodate_draft-116"><a href="#ChannelSection.can_accommodate_draft-116"><span class="linenos">116</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection.can_accommodate_draft-117"><a href="#ChannelSection.can_accommodate_draft-117"><span class="linenos">117</span></a><span class="sd">            bool: True if the section can accommodate the ship&#39;s draft, False otherwise.</span>
</span><span id="ChannelSection.can_accommodate_draft-118"><a href="#ChannelSection.can_accommodate_draft-118"><span class="linenos">118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection.can_accommodate_draft-119"><a href="#ChannelSection.can_accommodate_draft-119"><span class="linenos">119</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_draft-120"><a href="#ChannelSection.can_accommodate_draft-120"><span class="linenos">120</span></a>
</span><span id="ChannelSection.can_accommodate_draft-121"><a href="#ChannelSection.can_accommodate_draft-121"><span class="linenos">121</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max draft restrictiom</span>
</span><span id="ChannelSection.can_accommodate_draft-122"><a href="#ChannelSection.can_accommodate_draft-122"><span class="linenos">122</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.can_accommodate_draft-123"><a href="#ChannelSection.can_accommodate_draft-123"><span class="linenos">123</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection.can_accommodate_draft-124"><a href="#ChannelSection.can_accommodate_draft-124"><span class="linenos">124</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>  <span class="c1"># Same direction max draft restrictiom</span>
</span><span id="ChannelSection.can_accommodate_draft-125"><a href="#ChannelSection.can_accommodate_draft-125"><span class="linenos">125</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.can_accommodate_draft-126"><a href="#ChannelSection.can_accommodate_draft-126"><span class="linenos">126</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection.can_accommodate_draft-127"><a href="#ChannelSection.can_accommodate_draft-127"><span class="linenos">127</span></a>            <span class="c1"># opposite direction combined draft restriction</span>
</span><span id="ChannelSection.can_accommodate_draft-128"><a href="#ChannelSection.can_accommodate_draft-128"><span class="linenos">128</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.can_accommodate_draft-129"><a href="#ChannelSection.can_accommodate_draft-129"><span class="linenos">129</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.can_accommodate_draft-130"><a href="#ChannelSection.can_accommodate_draft-130"><span class="linenos">130</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.can_accommodate_draft-131"><a href="#ChannelSection.can_accommodate_draft-131"><span class="linenos">131</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_draft-132"><a href="#ChannelSection.can_accommodate_draft-132"><span class="linenos">132</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection.can_accommodate_draft-133"><a href="#ChannelSection.can_accommodate_draft-133"><span class="linenos">133</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.can_accommodate_draft-134"><a href="#ChannelSection.can_accommodate_draft-134"><span class="linenos">134</span></a>                <span class="n">excess</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.can_accommodate_draft-135"><a href="#ChannelSection.can_accommodate_draft-135"><span class="linenos">135</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.can_accommodate_draft-136"><a href="#ChannelSection.can_accommodate_draft-136"><span class="linenos">136</span></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">excess</span><span class="p">):</span>
</span><span id="ChannelSection.can_accommodate_draft-137"><a href="#ChannelSection.can_accommodate_draft-137"><span class="linenos">137</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection.can_accommodate_draft-138"><a href="#ChannelSection.can_accommodate_draft-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Check if the channel section can accommodate the draft of the ship at a given time step.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its draft and direction.</li>
<li><strong>start_time (int):</strong>  The start time of the ship's passage through the section.</li>
<li><strong>end_time (int):</strong>  The end time of the ship's passage through the section.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the section can accommodate the ship's draft, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="ChannelSection.can_accomodate_gap_out" class="classattr">
                                        <input id="ChannelSection.can_accomodate_gap_out-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">can_accomodate_gap_out</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">start_time</span>, </span><span class="param"><span class="n">ship_info</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ChannelSection.can_accomodate_gap_out-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChannelSection.can_accomodate_gap_out"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChannelSection.can_accomodate_gap_out-140"><a href="#ChannelSection.can_accomodate_gap_out-140"><span class="linenos">140</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_accomodate_gap_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="ChannelSection.can_accomodate_gap_out-141"><a href="#ChannelSection.can_accomodate_gap_out-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChannelSection.can_accomodate_gap_out-142"><a href="#ChannelSection.can_accomodate_gap_out-142"><span class="linenos">142</span></a><span class="sd">        Check if the channel section can accommodate the minimum spacing for the ship at a given time step.</span>
</span><span id="ChannelSection.can_accomodate_gap_out-143"><a href="#ChannelSection.can_accomodate_gap_out-143"><span class="linenos">143</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection.can_accomodate_gap_out-144"><a href="#ChannelSection.can_accomodate_gap_out-144"><span class="linenos">144</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.can_accomodate_gap_out-145"><a href="#ChannelSection.can_accomodate_gap_out-145"><span class="linenos">145</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="ChannelSection.can_accomodate_gap_out-146"><a href="#ChannelSection.can_accomodate_gap_out-146"><span class="linenos">146</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection.can_accomodate_gap_out-147"><a href="#ChannelSection.can_accomodate_gap_out-147"><span class="linenos">147</span></a><span class="sd">            bool: True if the section can accommodate the minimum spacing, False otherwise.</span>
</span><span id="ChannelSection.can_accomodate_gap_out-148"><a href="#ChannelSection.can_accomodate_gap_out-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection.can_accomodate_gap_out-149"><a href="#ChannelSection.can_accomodate_gap_out-149"><span class="linenos">149</span></a>
</span><span id="ChannelSection.can_accomodate_gap_out-150"><a href="#ChannelSection.can_accomodate_gap_out-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.can_accomodate_gap_out-151"><a href="#ChannelSection.can_accomodate_gap_out-151"><span class="linenos">151</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection.can_accomodate_gap_out-152"><a href="#ChannelSection.can_accomodate_gap_out-152"><span class="linenos">152</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ChannelSection.can_accomodate_gap_out-153"><a href="#ChannelSection.can_accomodate_gap_out-153"><span class="linenos">153</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection.can_accomodate_gap_out-154"><a href="#ChannelSection.can_accomodate_gap_out-154"><span class="linenos">154</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection.can_accomodate_gap_out-155"><a href="#ChannelSection.can_accomodate_gap_out-155"><span class="linenos">155</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="ChannelSection.can_accomodate_gap_out-156"><a href="#ChannelSection.can_accomodate_gap_out-156"><span class="linenos">156</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ChannelSection.can_accomodate_gap_out-157"><a href="#ChannelSection.can_accomodate_gap_out-157"><span class="linenos">157</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="ChannelSection.can_accomodate_gap_out-158"><a href="#ChannelSection.can_accomodate_gap_out-158"><span class="linenos">158</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ChannelSection.can_accomodate_gap_out-159"><a href="#ChannelSection.can_accomodate_gap_out-159"><span class="linenos">159</span></a>                    <span class="k">continue</span>
</span><span id="ChannelSection.can_accomodate_gap_out-160"><a href="#ChannelSection.can_accomodate_gap_out-160"><span class="linenos">160</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="ChannelSection.can_accomodate_gap_out-161"><a href="#ChannelSection.can_accomodate_gap_out-161"><span class="linenos">161</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Check if the channel section can accommodate the minimum spacing for the ship at a given time step.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>start_time (int):</strong>  The start time of the ship's passage through the section.</li>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its direction.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the section can accommodate the minimum spacing, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="ChannelSection.update_usage" class="classattr">
                                        <input id="ChannelSection.update_usage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_usage</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">run_id</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">start_time</span>, </span><span class="param"><span class="n">end_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ChannelSection.update_usage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChannelSection.update_usage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChannelSection.update_usage-163"><a href="#ChannelSection.update_usage-163"><span class="linenos">163</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="ChannelSection.update_usage-164"><a href="#ChannelSection.update_usage-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChannelSection.update_usage-165"><a href="#ChannelSection.update_usage-165"><span class="linenos">165</span></a><span class="sd">        Update the usage of the channel section based on the ship&#39;s information.</span>
</span><span id="ChannelSection.update_usage-166"><a href="#ChannelSection.update_usage-166"><span class="linenos">166</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection.update_usage-167"><a href="#ChannelSection.update_usage-167"><span class="linenos">167</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="ChannelSection.update_usage-168"><a href="#ChannelSection.update_usage-168"><span class="linenos">168</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width, draft, and direction.</span>
</span><span id="ChannelSection.update_usage-169"><a href="#ChannelSection.update_usage-169"><span class="linenos">169</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.update_usage-170"><a href="#ChannelSection.update_usage-170"><span class="linenos">170</span></a><span class="sd">            end_time (int): The end time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.update_usage-171"><a href="#ChannelSection.update_usage-171"><span class="linenos">171</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection.update_usage-172"><a href="#ChannelSection.update_usage-172"><span class="linenos">172</span></a><span class="sd">            None</span>
</span><span id="ChannelSection.update_usage-173"><a href="#ChannelSection.update_usage-173"><span class="linenos">173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection.update_usage-174"><a href="#ChannelSection.update_usage-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">end_time</span><span class="p">)):</span>
</span><span id="ChannelSection.update_usage-175"><a href="#ChannelSection.update_usage-175"><span class="linenos">175</span></a>
</span><span id="ChannelSection.update_usage-176"><a href="#ChannelSection.update_usage-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.update_usage-177"><a href="#ChannelSection.update_usage-177"><span class="linenos">177</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.update_usage-178"><a href="#ChannelSection.update_usage-178"><span class="linenos">178</span></a>                    <span class="n">excess_width_in</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.update_usage-179"><a href="#ChannelSection.update_usage-179"><span class="linenos">179</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.update_usage-180"><a href="#ChannelSection.update_usage-180"><span class="linenos">180</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_width_in</span>
</span><span id="ChannelSection.update_usage-181"><a href="#ChannelSection.update_usage-181"><span class="linenos">181</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_width_in</span>
</span><span id="ChannelSection.update_usage-182"><a href="#ChannelSection.update_usage-182"><span class="linenos">182</span></a>
</span><span id="ChannelSection.update_usage-183"><a href="#ChannelSection.update_usage-183"><span class="linenos">183</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.update_usage-184"><a href="#ChannelSection.update_usage-184"><span class="linenos">184</span></a>                    <span class="n">excess_draft_in</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.update_usage-185"><a href="#ChannelSection.update_usage-185"><span class="linenos">185</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.update_usage-186"><a href="#ChannelSection.update_usage-186"><span class="linenos">186</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_draft_in</span>
</span><span id="ChannelSection.update_usage-187"><a href="#ChannelSection.update_usage-187"><span class="linenos">187</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_draft_in</span>
</span><span id="ChannelSection.update_usage-188"><a href="#ChannelSection.update_usage-188"><span class="linenos">188</span></a>
</span><span id="ChannelSection.update_usage-189"><a href="#ChannelSection.update_usage-189"><span class="linenos">189</span></a>            <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.update_usage-190"><a href="#ChannelSection.update_usage-190"><span class="linenos">190</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.update_usage-191"><a href="#ChannelSection.update_usage-191"><span class="linenos">191</span></a>                    <span class="n">excess_width_out</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.update_usage-192"><a href="#ChannelSection.update_usage-192"><span class="linenos">192</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.update_usage-193"><a href="#ChannelSection.update_usage-193"><span class="linenos">193</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_width_out</span>
</span><span id="ChannelSection.update_usage-194"><a href="#ChannelSection.update_usage-194"><span class="linenos">194</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_width_out</span>
</span><span id="ChannelSection.update_usage-195"><a href="#ChannelSection.update_usage-195"><span class="linenos">195</span></a>
</span><span id="ChannelSection.update_usage-196"><a href="#ChannelSection.update_usage-196"><span class="linenos">196</span></a>                <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]:</span>
</span><span id="ChannelSection.update_usage-197"><a href="#ChannelSection.update_usage-197"><span class="linenos">197</span></a>                    <span class="n">excess_draft_out</span> <span class="o">=</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span> <span class="o">-</span> \
</span><span id="ChannelSection.update_usage-198"><a href="#ChannelSection.update_usage-198"><span class="linenos">198</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span>
</span><span id="ChannelSection.update_usage-199"><a href="#ChannelSection.update_usage-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_draft_out</span>
</span><span id="ChannelSection.update_usage-200"><a href="#ChannelSection.update_usage-200"><span class="linenos">200</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-=</span> <span class="n">excess_draft_out</span>
</span><span id="ChannelSection.update_usage-201"><a href="#ChannelSection.update_usage-201"><span class="linenos">201</span></a>
</span><span id="ChannelSection.update_usage-202"><a href="#ChannelSection.update_usage-202"><span class="linenos">202</span></a>            <span class="c1"># assert that the total width and draft in the section is equal to the capacity</span>
</span><span id="ChannelSection.update_usage-203"><a href="#ChannelSection.update_usage-203"><span class="linenos">203</span></a>            <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span>
</span><span id="ChannelSection.update_usage-204"><a href="#ChannelSection.update_usage-204"><span class="linenos">204</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">width_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_capacity</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.1</span>
</span><span id="ChannelSection.update_usage-205"><a href="#ChannelSection.update_usage-205"><span class="linenos">205</span></a>            <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">+</span>
</span><span id="ChannelSection.update_usage-206"><a href="#ChannelSection.update_usage-206"><span class="linenos">206</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_capacity</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.1</span>
</span><span id="ChannelSection.update_usage-207"><a href="#ChannelSection.update_usage-207"><span class="linenos">207</span></a>            <span class="c1"># assert that the width and draft containers are non-negative</span>
</span><span id="ChannelSection.update_usage-208"><a href="#ChannelSection.update_usage-208"><span class="linenos">208</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="ChannelSection.update_usage-209"><a href="#ChannelSection.update_usage-209"><span class="linenos">209</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_containers</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Update the usage of the channel section based on the ship's information.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>run_id (int):</strong>  The identifier for the current simulation run.</li>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its width, draft, and direction.</li>
<li><strong>start_time (int):</strong>  The start time of the ship's passage through the section.</li>
<li><strong>end_time (int):</strong>  The end time of the ship's passage through the section.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="ChannelSection.space_out" class="classattr">
                                        <input id="ChannelSection.space_out-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">space_out</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">start_time</span>, </span><span class="param"><span class="n">ship_info</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ChannelSection.space_out-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChannelSection.space_out"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChannelSection.space_out-211"><a href="#ChannelSection.space_out-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">space_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="ChannelSection.space_out-212"><a href="#ChannelSection.space_out-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="ChannelSection.space_out-213"><a href="#ChannelSection.space_out-213"><span class="linenos">213</span></a><span class="sd">        Space out the channel section for the ship based on its direction and start time.</span>
</span><span id="ChannelSection.space_out-214"><a href="#ChannelSection.space_out-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="ChannelSection.space_out-215"><a href="#ChannelSection.space_out-215"><span class="linenos">215</span></a><span class="sd">            start_time (int): The start time of the ship&#39;s passage through the section.</span>
</span><span id="ChannelSection.space_out-216"><a href="#ChannelSection.space_out-216"><span class="linenos">216</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="ChannelSection.space_out-217"><a href="#ChannelSection.space_out-217"><span class="linenos">217</span></a><span class="sd">        Returns:</span>
</span><span id="ChannelSection.space_out-218"><a href="#ChannelSection.space_out-218"><span class="linenos">218</span></a><span class="sd">            None</span>
</span><span id="ChannelSection.space_out-219"><a href="#ChannelSection.space_out-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChannelSection.space_out-220"><a href="#ChannelSection.space_out-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="ChannelSection.space_out-221"><a href="#ChannelSection.space_out-221"><span class="linenos">221</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))):</span>
</span><span id="ChannelSection.space_out-222"><a href="#ChannelSection.space_out-222"><span class="linenos">222</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="ChannelSection.space_out-223"><a href="#ChannelSection.space_out-223"><span class="linenos">223</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_in</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ChannelSection.space_out-224"><a href="#ChannelSection.space_out-224"><span class="linenos">224</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ChannelSection.space_out-225"><a href="#ChannelSection.space_out-225"><span class="linenos">225</span></a>            <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="n">start_time</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">TIME_FACTOR</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">CHANNEL_ENTRY_SPACING</span><span class="p">))):</span>
</span><span id="ChannelSection.space_out-226"><a href="#ChannelSection.space_out-226"><span class="linenos">226</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="ChannelSection.space_out-227"><a href="#ChannelSection.space_out-227"><span class="linenos">227</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gap_out_out</span><span class="p">[</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Space out the channel section for the ship based on its direction and start time.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>start_time (int):</strong>  The start time of the ship's passage through the section.</li>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its direction.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Channel">
                            <input id="Channel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Channel</span>:

                <label class="view-source-button" for="Channel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel-230"><a href="#Channel-230"><span class="linenos">230</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Channel</span><span class="p">:</span>
</span><span id="Channel-231"><a href="#Channel-231"><span class="linenos">231</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-232"><a href="#Channel-232"><span class="linenos">232</span></a><span class="sd">    Class for the entire channel.</span>
</span><span id="Channel-233"><a href="#Channel-233"><span class="linenos">233</span></a>
</span><span id="Channel-234"><a href="#Channel-234"><span class="linenos">234</span></a><span class="sd">    This class manages the sections of the channel and handles ship navigation through it. It implements the necessary methods to check for restrictions, schedule ships, and log their movements.</span>
</span><span id="Channel-235"><a href="#Channel-235"><span class="linenos">235</span></a>
</span><span id="Channel-236"><a href="#Channel-236"><span class="linenos">236</span></a><span class="sd">    Args:</span>
</span><span id="Channel-237"><a href="#Channel-237"><span class="linenos">237</span></a><span class="sd">        ship_logs (list): List to log ship information.</span>
</span><span id="Channel-238"><a href="#Channel-238"><span class="linenos">238</span></a><span class="sd">        env (Env): The simulation environment.</span>
</span><span id="Channel-239"><a href="#Channel-239"><span class="linenos">239</span></a><span class="sd">        numSections (int): Number of sections in the channel.</span>
</span><span id="Channel-240"><a href="#Channel-240"><span class="linenos">240</span></a><span class="sd">        simulation_time (int): Total simulation time for the channel.</span>
</span><span id="Channel-241"><a href="#Channel-241"><span class="linenos">241</span></a><span class="sd">        safeTwoway (bool): Whether the channel is safe for two-way traffic.</span>
</span><span id="Channel-242"><a href="#Channel-242"><span class="linenos">242</span></a><span class="sd">        channel_events (list): List to log channel events.</span>
</span><span id="Channel-243"><a href="#Channel-243"><span class="linenos">243</span></a><span class="sd">        channel_logs (list): List to log channel information.</span>
</span><span id="Channel-244"><a href="#Channel-244"><span class="linenos">244</span></a><span class="sd">        day_pilots (simpy.Container): Simpy container for day pilots.</span>
</span><span id="Channel-245"><a href="#Channel-245"><span class="linenos">245</span></a><span class="sd">        night_pilots (simpy.Container): Simpy container for night pilots.</span>
</span><span id="Channel-246"><a href="#Channel-246"><span class="linenos">246</span></a><span class="sd">        tugboats (simpy.Container): Simpy container for tugboats.</span>
</span><span id="Channel-247"><a href="#Channel-247"><span class="linenos">247</span></a><span class="sd">        turnoffTime (dict): Dictionary with turnoff times and conditions.</span>
</span><span id="Channel-248"><a href="#Channel-248"><span class="linenos">248</span></a><span class="sd">        channel_scheduer (Resource): Resource for scheduling channel usage.</span>
</span><span id="Channel-249"><a href="#Channel-249"><span class="linenos">249</span></a><span class="sd">        seed (int): Random seed for reproducibility.</span>
</span><span id="Channel-250"><a href="#Channel-250"><span class="linenos">250</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-251"><a href="#Channel-251"><span class="linenos">251</span></a>
</span><span id="Channel-252"><a href="#Channel-252"><span class="linenos">252</span></a>
</span><span id="Channel-253"><a href="#Channel-253"><span class="linenos">253</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_logs</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">numSections</span><span class="p">,</span> <span class="n">simulation_time</span><span class="p">,</span> <span class="n">safeTwoway</span><span class="p">,</span> <span class="n">channel_events</span><span class="p">,</span> <span class="n">channel_logs</span><span class="p">,</span> <span class="n">day_pilots</span><span class="p">,</span> <span class="n">night_pilots</span><span class="p">,</span> <span class="n">tugboats</span><span class="p">,</span> <span class="n">turnoffTime</span><span class="p">,</span> <span class="n">channel_scheduer</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
</span><span id="Channel-254"><a href="#Channel-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="Channel-255"><a href="#Channel-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
</span><span id="Channel-256"><a href="#Channel-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span> <span class="o">=</span> <span class="n">ship_logs</span>
</span><span id="Channel-257"><a href="#Channel-257"><span class="linenos">257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">numSections</span> <span class="o">=</span> <span class="n">numSections</span>
</span><span id="Channel-258"><a href="#Channel-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span> <span class="o">=</span> <span class="n">safeTwoway</span>
</span><span id="Channel-259"><a href="#Channel-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_events</span> <span class="o">=</span> <span class="n">channel_events</span>
</span><span id="Channel-260"><a href="#Channel-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_logs</span> <span class="o">=</span> <span class="n">channel_logs</span>
</span><span id="Channel-261"><a href="#Channel-261"><span class="linenos">261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">simulation_time</span> <span class="o">=</span> <span class="n">simulation_time</span>
</span><span id="Channel-262"><a href="#Channel-262"><span class="linenos">262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span> <span class="o">=</span> <span class="n">day_pilots</span>
</span><span id="Channel-263"><a href="#Channel-263"><span class="linenos">263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span> <span class="o">=</span> <span class="n">night_pilots</span>
</span><span id="Channel-264"><a href="#Channel-264"><span class="linenos">264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span> <span class="o">=</span> <span class="n">tugboats</span>
</span><span id="Channel-265"><a href="#Channel-265"><span class="linenos">265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span> <span class="o">=</span> <span class="n">turnoffTime</span>
</span><span id="Channel-266"><a href="#Channel-266"><span class="linenos">266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span> <span class="o">=</span> <span class="n">channel_scheduer</span>
</span><span id="Channel-267"><a href="#Channel-267"><span class="linenos">267</span></a>
</span><span id="Channel-268"><a href="#Channel-268"><span class="linenos">268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">ChannelSection</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">*</span><span class="n">CHANNEL_SECTION_DIMENSIONS</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation_time</span><span class="p">),</span>
</span><span id="Channel-269"><a href="#Channel-269"><span class="linenos">269</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numSections</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Creating channel&quot;</span><span class="p">)]</span>
</span><span id="Channel-270"><a href="#Channel-270"><span class="linenos">270</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Channel-271"><a href="#Channel-271"><span class="linenos">271</span></a>
</span><span id="Channel-272"><a href="#Channel-272"><span class="linenos">272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
</span><span id="Channel-273"><a href="#Channel-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-274"><a href="#Channel-274"><span class="linenos">274</span></a><span class="sd">        Check if the channel is closed at a given time step.</span>
</span><span id="Channel-275"><a href="#Channel-275"><span class="linenos">275</span></a><span class="sd">        Args:</span>
</span><span id="Channel-276"><a href="#Channel-276"><span class="linenos">276</span></a><span class="sd">            time (int): The time step to check for channel closure.</span>
</span><span id="Channel-277"><a href="#Channel-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-278"><a href="#Channel-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span><span class="p">[</span><span class="s2">&quot;switch&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;channel_closed&quot;</span><span class="p">:</span>
</span><span id="Channel-279"><a href="#Channel-279"><span class="linenos">279</span></a>            <span class="k">for</span> <span class="n">start_end_tuples</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span><span class="p">[</span><span class="s2">&quot;closed_between&quot;</span><span class="p">]:</span>
</span><span id="Channel-280"><a href="#Channel-280"><span class="linenos">280</span></a>                <span class="k">if</span> <span class="n">start_end_tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span> <span class="o">&lt;</span> <span class="n">start_end_tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="Channel-281"><a href="#Channel-281"><span class="linenos">281</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-282"><a href="#Channel-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-283"><a href="#Channel-283"><span class="linenos">283</span></a>
</span><span id="Channel-284"><a href="#Channel-284"><span class="linenos">284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_closed_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel-285"><a href="#Channel-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-286"><a href="#Channel-286"><span class="linenos">286</span></a><span class="sd">        Check if the ship has beam restriction in the channel in any section at a given time step.</span>
</span><span id="Channel-287"><a href="#Channel-287"><span class="linenos">287</span></a><span class="sd">        Logic: </span>
</span><span id="Channel-288"><a href="#Channel-288"><span class="linenos">288</span></a><span class="sd">        - If the ship is entering the channel, check each section from the start to the last section.</span>
</span><span id="Channel-289"><a href="#Channel-289"><span class="linenos">289</span></a><span class="sd">        - If the ship is leaving the channel, check each section from the last section to the start.</span>
</span><span id="Channel-290"><a href="#Channel-290"><span class="linenos">290</span></a><span class="sd">        - For each section, calculate the end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="Channel-291"><a href="#Channel-291"><span class="linenos">291</span></a><span class="sd">        - For each section, check if the channel is closed at the end time.</span>
</span><span id="Channel-292"><a href="#Channel-292"><span class="linenos">292</span></a><span class="sd">        - If the channel is closed at the end time, return True (indicating the channel is closed for the ship).</span>
</span><span id="Channel-293"><a href="#Channel-293"><span class="linenos">293</span></a><span class="sd">        - If no section is closed, return False (indicating the channel is open for the ship).</span>
</span><span id="Channel-294"><a href="#Channel-294"><span class="linenos">294</span></a><span class="sd">        Args:</span>
</span><span id="Channel-295"><a href="#Channel-295"><span class="linenos">295</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="Channel-296"><a href="#Channel-296"><span class="linenos">296</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-297"><a href="#Channel-297"><span class="linenos">297</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel-298"><a href="#Channel-298"><span class="linenos">298</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-299"><a href="#Channel-299"><span class="linenos">299</span></a><span class="sd">            bool: True if the channel is closed for the ship, False otherwise.</span>
</span><span id="Channel-300"><a href="#Channel-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-301"><a href="#Channel-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel-302"><a href="#Channel-302"><span class="linenos">302</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-303"><a href="#Channel-303"><span class="linenos">303</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel-304"><a href="#Channel-304"><span class="linenos">304</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-305"><a href="#Channel-305"><span class="linenos">305</span></a>                    <span class="k">break</span>
</span><span id="Channel-306"><a href="#Channel-306"><span class="linenos">306</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-307"><a href="#Channel-307"><span class="linenos">307</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-308"><a href="#Channel-308"><span class="linenos">308</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel-309"><a href="#Channel-309"><span class="linenos">309</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-310"><a href="#Channel-310"><span class="linenos">310</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-311"><a href="#Channel-311"><span class="linenos">311</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-312"><a href="#Channel-312"><span class="linenos">312</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel-313"><a href="#Channel-313"><span class="linenos">313</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-314"><a href="#Channel-314"><span class="linenos">314</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel-315"><a href="#Channel-315"><span class="linenos">315</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel-316"><a href="#Channel-316"><span class="linenos">316</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-317"><a href="#Channel-317"><span class="linenos">317</span></a>                    <span class="k">continue</span>
</span><span id="Channel-318"><a href="#Channel-318"><span class="linenos">318</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-319"><a href="#Channel-319"><span class="linenos">319</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-320"><a href="#Channel-320"><span class="linenos">320</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel-321"><a href="#Channel-321"><span class="linenos">321</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-322"><a href="#Channel-322"><span class="linenos">322</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-323"><a href="#Channel-323"><span class="linenos">323</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-324"><a href="#Channel-324"><span class="linenos">324</span></a>
</span><span id="Channel-325"><a href="#Channel-325"><span class="linenos">325</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">beam_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel-326"><a href="#Channel-326"><span class="linenos">326</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-327"><a href="#Channel-327"><span class="linenos">327</span></a><span class="sd">        Check if the ship has beam restriction in the channel in any section at a given time step.</span>
</span><span id="Channel-328"><a href="#Channel-328"><span class="linenos">328</span></a><span class="sd">        Logic: </span>
</span><span id="Channel-329"><a href="#Channel-329"><span class="linenos">329</span></a><span class="sd">        - If the ship is entering the channel, check each section from the start to the last section.</span>
</span><span id="Channel-330"><a href="#Channel-330"><span class="linenos">330</span></a><span class="sd">        - If the ship is leaving the channel, check each section from the last section to the start.</span>
</span><span id="Channel-331"><a href="#Channel-331"><span class="linenos">331</span></a><span class="sd">        - For each section, calculate the end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="Channel-332"><a href="#Channel-332"><span class="linenos">332</span></a><span class="sd">        - For each section, check if the width of the ship exceeds the available width in the section.</span>
</span><span id="Channel-333"><a href="#Channel-333"><span class="linenos">333</span></a><span class="sd">        - If the width of the ship exceeds the available width in any section, return True (indicating beam restriction).</span>
</span><span id="Channel-334"><a href="#Channel-334"><span class="linenos">334</span></a><span class="sd">        - If no section has beam restriction, return False (indicating no beam restriction).</span>
</span><span id="Channel-335"><a href="#Channel-335"><span class="linenos">335</span></a><span class="sd">        Args:</span>
</span><span id="Channel-336"><a href="#Channel-336"><span class="linenos">336</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width and direction.</span>
</span><span id="Channel-337"><a href="#Channel-337"><span class="linenos">337</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-338"><a href="#Channel-338"><span class="linenos">338</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel-339"><a href="#Channel-339"><span class="linenos">339</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-340"><a href="#Channel-340"><span class="linenos">340</span></a><span class="sd">            bool: True if the ship has beam restriction, False otherwise.</span>
</span><span id="Channel-341"><a href="#Channel-341"><span class="linenos">341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-342"><a href="#Channel-342"><span class="linenos">342</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel-343"><a href="#Channel-343"><span class="linenos">343</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-344"><a href="#Channel-344"><span class="linenos">344</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel-345"><a href="#Channel-345"><span class="linenos">345</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-346"><a href="#Channel-346"><span class="linenos">346</span></a>                    <span class="k">break</span>
</span><span id="Channel-347"><a href="#Channel-347"><span class="linenos">347</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-348"><a href="#Channel-348"><span class="linenos">348</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-349"><a href="#Channel-349"><span class="linenos">349</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_width</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel-350"><a href="#Channel-350"><span class="linenos">350</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-351"><a href="#Channel-351"><span class="linenos">351</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-352"><a href="#Channel-352"><span class="linenos">352</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-353"><a href="#Channel-353"><span class="linenos">353</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel-354"><a href="#Channel-354"><span class="linenos">354</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-355"><a href="#Channel-355"><span class="linenos">355</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel-356"><a href="#Channel-356"><span class="linenos">356</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel-357"><a href="#Channel-357"><span class="linenos">357</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-358"><a href="#Channel-358"><span class="linenos">358</span></a>                    <span class="k">continue</span>
</span><span id="Channel-359"><a href="#Channel-359"><span class="linenos">359</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-360"><a href="#Channel-360"><span class="linenos">360</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-361"><a href="#Channel-361"><span class="linenos">361</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_width</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel-362"><a href="#Channel-362"><span class="linenos">362</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-363"><a href="#Channel-363"><span class="linenos">363</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-364"><a href="#Channel-364"><span class="linenos">364</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-365"><a href="#Channel-365"><span class="linenos">365</span></a>
</span><span id="Channel-366"><a href="#Channel-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">draft_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel-367"><a href="#Channel-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-368"><a href="#Channel-368"><span class="linenos">368</span></a><span class="sd">        Check if the ship has draft restriction in the channel in any section at a given time step.</span>
</span><span id="Channel-369"><a href="#Channel-369"><span class="linenos">369</span></a><span class="sd">        Logic is similar to beam_restriction, but checks for draft instead of width.</span>
</span><span id="Channel-370"><a href="#Channel-370"><span class="linenos">370</span></a><span class="sd">        Args:</span>
</span><span id="Channel-371"><a href="#Channel-371"><span class="linenos">371</span></a><span class="sd">            ship_info (dict): Information about the ship, including its draft and direction.</span>
</span><span id="Channel-372"><a href="#Channel-372"><span class="linenos">372</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-373"><a href="#Channel-373"><span class="linenos">373</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel-374"><a href="#Channel-374"><span class="linenos">374</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-375"><a href="#Channel-375"><span class="linenos">375</span></a><span class="sd">            bool: True if the ship has draft restriction, False otherwise.</span>
</span><span id="Channel-376"><a href="#Channel-376"><span class="linenos">376</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-377"><a href="#Channel-377"><span class="linenos">377</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel-378"><a href="#Channel-378"><span class="linenos">378</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-379"><a href="#Channel-379"><span class="linenos">379</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel-380"><a href="#Channel-380"><span class="linenos">380</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-381"><a href="#Channel-381"><span class="linenos">381</span></a>                    <span class="k">break</span>
</span><span id="Channel-382"><a href="#Channel-382"><span class="linenos">382</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-383"><a href="#Channel-383"><span class="linenos">383</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-384"><a href="#Channel-384"><span class="linenos">384</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_draft</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel-385"><a href="#Channel-385"><span class="linenos">385</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-386"><a href="#Channel-386"><span class="linenos">386</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-387"><a href="#Channel-387"><span class="linenos">387</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-388"><a href="#Channel-388"><span class="linenos">388</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel-389"><a href="#Channel-389"><span class="linenos">389</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-390"><a href="#Channel-390"><span class="linenos">390</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel-391"><a href="#Channel-391"><span class="linenos">391</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel-392"><a href="#Channel-392"><span class="linenos">392</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-393"><a href="#Channel-393"><span class="linenos">393</span></a>                    <span class="k">continue</span>
</span><span id="Channel-394"><a href="#Channel-394"><span class="linenos">394</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-395"><a href="#Channel-395"><span class="linenos">395</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-396"><a href="#Channel-396"><span class="linenos">396</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_draft</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel-397"><a href="#Channel-397"><span class="linenos">397</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-398"><a href="#Channel-398"><span class="linenos">398</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-399"><a href="#Channel-399"><span class="linenos">399</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-400"><a href="#Channel-400"><span class="linenos">400</span></a>
</span><span id="Channel-401"><a href="#Channel-401"><span class="linenos">401</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">minimal_spacing_not_avlbl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel-402"><a href="#Channel-402"><span class="linenos">402</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-403"><a href="#Channel-403"><span class="linenos">403</span></a><span class="sd">        Check if the minimal spacing for the ship is not available in the channel in any section at a given time step.</span>
</span><span id="Channel-404"><a href="#Channel-404"><span class="linenos">404</span></a><span class="sd">        Logic is similar to beam_restriction, but checks for minimal spacing instead of width.</span>
</span><span id="Channel-405"><a href="#Channel-405"><span class="linenos">405</span></a><span class="sd">        Args:</span>
</span><span id="Channel-406"><a href="#Channel-406"><span class="linenos">406</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="Channel-407"><a href="#Channel-407"><span class="linenos">407</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-408"><a href="#Channel-408"><span class="linenos">408</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel-409"><a href="#Channel-409"><span class="linenos">409</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-410"><a href="#Channel-410"><span class="linenos">410</span></a><span class="sd">            bool: True if the minimal spacing is not available, False otherwise.</span>
</span><span id="Channel-411"><a href="#Channel-411"><span class="linenos">411</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-412"><a href="#Channel-412"><span class="linenos">412</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel-413"><a href="#Channel-413"><span class="linenos">413</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-414"><a href="#Channel-414"><span class="linenos">414</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel-415"><a href="#Channel-415"><span class="linenos">415</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-416"><a href="#Channel-416"><span class="linenos">416</span></a>                    <span class="k">break</span>
</span><span id="Channel-417"><a href="#Channel-417"><span class="linenos">417</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-418"><a href="#Channel-418"><span class="linenos">418</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-419"><a href="#Channel-419"><span class="linenos">419</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accomodate_gap_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="Channel-420"><a href="#Channel-420"><span class="linenos">420</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-421"><a href="#Channel-421"><span class="linenos">421</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-422"><a href="#Channel-422"><span class="linenos">422</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-423"><a href="#Channel-423"><span class="linenos">423</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel-424"><a href="#Channel-424"><span class="linenos">424</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-425"><a href="#Channel-425"><span class="linenos">425</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel-426"><a href="#Channel-426"><span class="linenos">426</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel-427"><a href="#Channel-427"><span class="linenos">427</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-428"><a href="#Channel-428"><span class="linenos">428</span></a>                    <span class="k">continue</span>
</span><span id="Channel-429"><a href="#Channel-429"><span class="linenos">429</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-430"><a href="#Channel-430"><span class="linenos">430</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-431"><a href="#Channel-431"><span class="linenos">431</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accomodate_gap_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="Channel-432"><a href="#Channel-432"><span class="linenos">432</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel-433"><a href="#Channel-433"><span class="linenos">433</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-434"><a href="#Channel-434"><span class="linenos">434</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-435"><a href="#Channel-435"><span class="linenos">435</span></a>
</span><span id="Channel-436"><a href="#Channel-436"><span class="linenos">436</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">daylight_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel-437"><a href="#Channel-437"><span class="linenos">437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-438"><a href="#Channel-438"><span class="linenos">438</span></a><span class="sd">        Check if the ship has daylight restriction in the channel at a given time step.</span>
</span><span id="Channel-439"><a href="#Channel-439"><span class="linenos">439</span></a><span class="sd">        Logic:</span>
</span><span id="Channel-440"><a href="#Channel-440"><span class="linenos">440</span></a><span class="sd">        - Check the ship&#39;s type and dimensions (width and length).</span>
</span><span id="Channel-441"><a href="#Channel-441"><span class="linenos">441</span></a><span class="sd">        - If the ship is a Container, Liquid, or DryBulk type, check if its width or length exceeds the specified limits.</span>
</span><span id="Channel-442"><a href="#Channel-442"><span class="linenos">442</span></a><span class="sd">        - If the ship exceeds the limits, check if it is daytime at the time of entry.</span>
</span><span id="Channel-443"><a href="#Channel-443"><span class="linenos">443</span></a><span class="sd">        - If it is not daytime, return True (indicating daylight restriction).</span>
</span><span id="Channel-444"><a href="#Channel-444"><span class="linenos">444</span></a><span class="sd">        - If the ship does not exceed the limits or it is daytime, return False (indicating no daylight restriction).</span>
</span><span id="Channel-445"><a href="#Channel-445"><span class="linenos">445</span></a><span class="sd">        Args:</span>
</span><span id="Channel-446"><a href="#Channel-446"><span class="linenos">446</span></a><span class="sd">            ship_info (dict): Information about the ship, including its type, width, and length.</span>
</span><span id="Channel-447"><a href="#Channel-447"><span class="linenos">447</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-448"><a href="#Channel-448"><span class="linenos">448</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel-449"><a href="#Channel-449"><span class="linenos">449</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-450"><a href="#Channel-450"><span class="linenos">450</span></a><span class="sd">            bool: True if the ship has daylight restriction, False otherwise.</span>
</span><span id="Channel-451"><a href="#Channel-451"><span class="linenos">451</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-452"><a href="#Channel-452"><span class="linenos">452</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Container&#39;</span><span class="p">:</span>
</span><span id="Channel-453"><a href="#Channel-453"><span class="linenos">453</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
</span><span id="Channel-454"><a href="#Channel-454"><span class="linenos">454</span></a>                <span class="c1"># if not daytime return True</span>
</span><span id="Channel-455"><a href="#Channel-455"><span class="linenos">455</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="Channel-456"><a href="#Channel-456"><span class="linenos">456</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Liquid&#39;</span><span class="p">:</span>
</span><span id="Channel-457"><a href="#Channel-457"><span class="linenos">457</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">:</span>
</span><span id="Channel-458"><a href="#Channel-458"><span class="linenos">458</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="Channel-459"><a href="#Channel-459"><span class="linenos">459</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DryBulk&#39;</span><span class="p">:</span>
</span><span id="Channel-460"><a href="#Channel-460"><span class="linenos">460</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">:</span>
</span><span id="Channel-461"><a href="#Channel-461"><span class="linenos">461</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="Channel-462"><a href="#Channel-462"><span class="linenos">462</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel-463"><a href="#Channel-463"><span class="linenos">463</span></a>
</span><span id="Channel-464"><a href="#Channel-464"><span class="linenos">464</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scheduler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel-465"><a href="#Channel-465"><span class="linenos">465</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-466"><a href="#Channel-466"><span class="linenos">466</span></a><span class="sd">        Schedule the ship to navigate through the channel. This happens before the ship actually moves through the channel.</span>
</span><span id="Channel-467"><a href="#Channel-467"><span class="linenos">467</span></a><span class="sd">        Logic:</span>
</span><span id="Channel-468"><a href="#Channel-468"><span class="linenos">468</span></a><span class="sd">        - Check if the ship has any restrictions in the channel (beam, draft, daylight, minimal spacing).</span>
</span><span id="Channel-469"><a href="#Channel-469"><span class="linenos">469</span></a><span class="sd">        - If there are any restrictions, log the ship&#39;s information and return.</span>
</span><span id="Channel-470"><a href="#Channel-470"><span class="linenos">470</span></a><span class="sd">        - If there are no restrictions, update the ship&#39;s logs and schedule the ship to move through the channel.</span>
</span><span id="Channel-471"><a href="#Channel-471"><span class="linenos">471</span></a><span class="sd">        - If the ship is entering the channel, update the usage of each section in the channel.</span>
</span><span id="Channel-472"><a href="#Channel-472"><span class="linenos">472</span></a><span class="sd">        - If the ship is leaving the channel, update the usage of each section in reverse order.</span>
</span><span id="Channel-473"><a href="#Channel-473"><span class="linenos">473</span></a><span class="sd">        - Log the ship&#39;s movement through the channel.</span>
</span><span id="Channel-474"><a href="#Channel-474"><span class="linenos">474</span></a><span class="sd">        - Finally, yield the ship&#39;s movement through the channel.</span>
</span><span id="Channel-475"><a href="#Channel-475"><span class="linenos">475</span></a><span class="sd">        Note this is different from the move_through_channel method, which is called when the ship actually moves through the channel.</span>
</span><span id="Channel-476"><a href="#Channel-476"><span class="linenos">476</span></a><span class="sd">        The scheduler method is called as soon as the ship requests to enter the channel.</span>
</span><span id="Channel-477"><a href="#Channel-477"><span class="linenos">477</span></a><span class="sd">        If the ship has any restrictions, it will not be scheduled to move through the channel.</span>
</span><span id="Channel-478"><a href="#Channel-478"><span class="linenos">478</span></a><span class="sd">        Args:</span>
</span><span id="Channel-479"><a href="#Channel-479"><span class="linenos">479</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, width, draft, and speed.</span>
</span><span id="Channel-480"><a href="#Channel-480"><span class="linenos">480</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-481"><a href="#Channel-481"><span class="linenos">481</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="Channel-482"><a href="#Channel-482"><span class="linenos">482</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel-483"><a href="#Channel-483"><span class="linenos">483</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-484"><a href="#Channel-484"><span class="linenos">484</span></a><span class="sd">            None</span>
</span><span id="Channel-485"><a href="#Channel-485"><span class="linenos">485</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-486"><a href="#Channel-486"><span class="linenos">486</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-487"><a href="#Channel-487"><span class="linenos">487</span></a>
</span><span id="Channel-488"><a href="#Channel-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel-489"><a href="#Channel-489"><span class="linenos">489</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel-490"><a href="#Channel-490"><span class="linenos">490</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-491"><a href="#Channel-491"><span class="linenos">491</span></a>                    <span class="k">break</span>
</span><span id="Channel-492"><a href="#Channel-492"><span class="linenos">492</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-493"><a href="#Channel-493"><span class="linenos">493</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-494"><a href="#Channel-494"><span class="linenos">494</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">update_usage</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
</span><span id="Channel-495"><a href="#Channel-495"><span class="linenos">495</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">space_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">)</span>
</span><span id="Channel-496"><a href="#Channel-496"><span class="linenos">496</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-497"><a href="#Channel-497"><span class="linenos">497</span></a>
</span><span id="Channel-498"><a href="#Channel-498"><span class="linenos">498</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel-499"><a href="#Channel-499"><span class="linenos">499</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel-500"><a href="#Channel-500"><span class="linenos">500</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel-501"><a href="#Channel-501"><span class="linenos">501</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-502"><a href="#Channel-502"><span class="linenos">502</span></a>                    <span class="k">continue</span>
</span><span id="Channel-503"><a href="#Channel-503"><span class="linenos">503</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-504"><a href="#Channel-504"><span class="linenos">504</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-505"><a href="#Channel-505"><span class="linenos">505</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">update_usage</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
</span><span id="Channel-506"><a href="#Channel-506"><span class="linenos">506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">section_number</span><span class="p">]</span><span class="o">.</span><span class="n">space_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">)</span>
</span><span id="Channel-507"><a href="#Channel-507"><span class="linenos">507</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-508"><a href="#Channel-508"><span class="linenos">508</span></a>
</span><span id="Channel-509"><a href="#Channel-509"><span class="linenos">509</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">move_through_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">):</span>
</span><span id="Channel-510"><a href="#Channel-510"><span class="linenos">510</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-511"><a href="#Channel-511"><span class="linenos">511</span></a><span class="sd">        Simulate the movement of the ship through the channel.</span>
</span><span id="Channel-512"><a href="#Channel-512"><span class="linenos">512</span></a><span class="sd">        Logic:</span>
</span><span id="Channel-513"><a href="#Channel-513"><span class="linenos">513</span></a><span class="sd">        - If the ship is entering the channel, iterate through each section from the start to the last section.</span>
</span><span id="Channel-514"><a href="#Channel-514"><span class="linenos">514</span></a><span class="sd">        - If the ship is leaving the channel, iterate through each section from the last section to the start.</span>
</span><span id="Channel-515"><a href="#Channel-515"><span class="linenos">515</span></a><span class="sd">        - For each section, calculate the speed and end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="Channel-516"><a href="#Channel-516"><span class="linenos">516</span></a><span class="sd">        - Log the ship&#39;s movement through the section, including its ship_id, ship_type, width, draft, and direction.</span>
</span><span id="Channel-517"><a href="#Channel-517"><span class="linenos">517</span></a><span class="sd">        - Yield the ship&#39;s movement through the section.</span>
</span><span id="Channel-518"><a href="#Channel-518"><span class="linenos">518</span></a><span class="sd">        - Log the time spent in each section.</span>
</span><span id="Channel-519"><a href="#Channel-519"><span class="linenos">519</span></a><span class="sd">        - Finally, update the ship&#39;s logs with the time spent in the channel.</span>
</span><span id="Channel-520"><a href="#Channel-520"><span class="linenos">520</span></a><span class="sd">        - If the ship is entering the channel, log the time spent in each section going in.</span>
</span><span id="Channel-521"><a href="#Channel-521"><span class="linenos">521</span></a><span class="sd">        - If the ship is leaving the channel, log the time spent in each section going out.</span>
</span><span id="Channel-522"><a href="#Channel-522"><span class="linenos">522</span></a><span class="sd">        Note this is different from the scheduler method,which schedules before the ship actually moves through the channel.</span>
</span><span id="Channel-523"><a href="#Channel-523"><span class="linenos">523</span></a><span class="sd">        The sheduler happens as soon as the ship requests to enter the channel.</span>
</span><span id="Channel-524"><a href="#Channel-524"><span class="linenos">524</span></a><span class="sd">        The move_through_channel method is called when the ship actually moves through the channel (when there are no restrictions).</span>
</span><span id="Channel-525"><a href="#Channel-525"><span class="linenos">525</span></a><span class="sd">        Args:</span>
</span><span id="Channel-526"><a href="#Channel-526"><span class="linenos">526</span></a><span class="sd">            ship_info (dict): Information about the ship, including its ship_id, ship_type, width, draft, and direction.</span>
</span><span id="Channel-527"><a href="#Channel-527"><span class="linenos">527</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-528"><a href="#Channel-528"><span class="linenos">528</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="Channel-529"><a href="#Channel-529"><span class="linenos">529</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-530"><a href="#Channel-530"><span class="linenos">530</span></a><span class="sd">            None</span>
</span><span id="Channel-531"><a href="#Channel-531"><span class="linenos">531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-532"><a href="#Channel-532"><span class="linenos">532</span></a>        <span class="n">enter_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-533"><a href="#Channel-533"><span class="linenos">533</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel-534"><a href="#Channel-534"><span class="linenos">534</span></a>
</span><span id="Channel-535"><a href="#Channel-535"><span class="linenos">535</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel-536"><a href="#Channel-536"><span class="linenos">536</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel-537"><a href="#Channel-537"><span class="linenos">537</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-538"><a href="#Channel-538"><span class="linenos">538</span></a>                    <span class="k">break</span>
</span><span id="Channel-539"><a href="#Channel-539"><span class="linenos">539</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-540"><a href="#Channel-540"><span class="linenos">540</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-541"><a href="#Channel-541"><span class="linenos">541</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span><span class="p">)</span>
</span><span id="Channel-542"><a href="#Channel-542"><span class="linenos">542</span></a>                <span class="n">log_line</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot;ships_in_channel.txt&quot;</span><span class="p">,</span>
</span><span id="Channel-543"><a href="#Channel-543"><span class="linenos">543</span></a>                         <span class="sa">f</span><span class="s2">&quot;Ship </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of width </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> and draft </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> spent from </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_time</span><span class="si">}</span><span class="s2"> in section </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> going in&quot;</span><span class="p">)</span>
</span><span id="Channel-544"><a href="#Channel-544"><span class="linenos">544</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-545"><a href="#Channel-545"><span class="linenos">545</span></a>
</span><span id="Channel-546"><a href="#Channel-546"><span class="linenos">546</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel-547"><a href="#Channel-547"><span class="linenos">547</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel-548"><a href="#Channel-548"><span class="linenos">548</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel-549"><a href="#Channel-549"><span class="linenos">549</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel-550"><a href="#Channel-550"><span class="linenos">550</span></a>                    <span class="k">continue</span>
</span><span id="Channel-551"><a href="#Channel-551"><span class="linenos">551</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel-552"><a href="#Channel-552"><span class="linenos">552</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel-553"><a href="#Channel-553"><span class="linenos">553</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span><span class="p">)</span>
</span><span id="Channel-554"><a href="#Channel-554"><span class="linenos">554</span></a>                <span class="n">log_line</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot;ships_in_channel.txt&quot;</span><span class="p">,</span>
</span><span id="Channel-555"><a href="#Channel-555"><span class="linenos">555</span></a>                         <span class="sa">f</span><span class="s2">&quot;Ship </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of width </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> and draft </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> spent from </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_time</span><span class="si">}</span><span class="s2"> in section </span><span class="si">{</span><span class="n">section_number</span><span class="si">}</span><span class="s2"> going out&quot;</span><span class="p">)</span>
</span><span id="Channel-556"><a href="#Channel-556"><span class="linenos">556</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel-557"><a href="#Channel-557"><span class="linenos">557</span></a>
</span><span id="Channel-558"><a href="#Channel-558"><span class="linenos">558</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_restrictions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">):</span>
</span><span id="Channel-559"><a href="#Channel-559"><span class="linenos">559</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-560"><a href="#Channel-560"><span class="linenos">560</span></a><span class="sd">        Check if the ship has any restrictions in the channel at a given time step.</span>
</span><span id="Channel-561"><a href="#Channel-561"><span class="linenos">561</span></a><span class="sd">        Args:</span>
</span><span id="Channel-562"><a href="#Channel-562"><span class="linenos">562</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, width, draft, and ship type.</span>
</span><span id="Channel-563"><a href="#Channel-563"><span class="linenos">563</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-564"><a href="#Channel-564"><span class="linenos">564</span></a><span class="sd">            request_time (int): The time step when the ship requests to enter the channel.</span>
</span><span id="Channel-565"><a href="#Channel-565"><span class="linenos">565</span></a><span class="sd">            wait_beam (int): The number of time steps the ship has waited for beam restrictions.</span>
</span><span id="Channel-566"><a href="#Channel-566"><span class="linenos">566</span></a><span class="sd">            wait_draft (int): The number of time steps the ship has waited for draft restrictions.</span>
</span><span id="Channel-567"><a href="#Channel-567"><span class="linenos">567</span></a><span class="sd">            wait_daylight (int): The number of time steps the ship has waited for daylight restrictions.</span>
</span><span id="Channel-568"><a href="#Channel-568"><span class="linenos">568</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-569"><a href="#Channel-569"><span class="linenos">569</span></a><span class="sd">            tuple: A tuple containing:</span>
</span><span id="Channel-570"><a href="#Channel-570"><span class="linenos">570</span></a><span class="sd">                - restrictions (bool): True if there are any restrictions, False otherwise.</span>
</span><span id="Channel-571"><a href="#Channel-571"><span class="linenos">571</span></a><span class="sd">                - wait_beam (int): The updated number of time steps the ship has waited for beam restrictions.</span>
</span><span id="Channel-572"><a href="#Channel-572"><span class="linenos">572</span></a><span class="sd">                - wait_draft (int): The updated number of time steps the ship has waited for draft restrictions.</span>
</span><span id="Channel-573"><a href="#Channel-573"><span class="linenos">573</span></a><span class="sd">                - wait_daylight (int): The updated number of time steps the ship has waited for daylight restrictions.</span>
</span><span id="Channel-574"><a href="#Channel-574"><span class="linenos">574</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-575"><a href="#Channel-575"><span class="linenos">575</span></a>        <span class="n">channel_closed_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed_restriction</span><span class="p">(</span>
</span><span id="Channel-576"><a href="#Channel-576"><span class="linenos">576</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-577"><a href="#Channel-577"><span class="linenos">577</span></a>        <span class="n">beam_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_restriction</span><span class="p">(</span>
</span><span id="Channel-578"><a href="#Channel-578"><span class="linenos">578</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-579"><a href="#Channel-579"><span class="linenos">579</span></a>        <span class="n">draft_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_restriction</span><span class="p">(</span>
</span><span id="Channel-580"><a href="#Channel-580"><span class="linenos">580</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-581"><a href="#Channel-581"><span class="linenos">581</span></a>        <span class="n">daylight_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daylight_restriction</span><span class="p">(</span>
</span><span id="Channel-582"><a href="#Channel-582"><span class="linenos">582</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-583"><a href="#Channel-583"><span class="linenos">583</span></a>
</span><span id="Channel-584"><a href="#Channel-584"><span class="linenos">584</span></a>        <span class="k">if</span> <span class="n">beam_restriction</span><span class="p">:</span>
</span><span id="Channel-585"><a href="#Channel-585"><span class="linenos">585</span></a>            <span class="n">wait_beam</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-586"><a href="#Channel-586"><span class="linenos">586</span></a>        <span class="k">if</span> <span class="n">draft_restriction</span><span class="p">:</span>
</span><span id="Channel-587"><a href="#Channel-587"><span class="linenos">587</span></a>            <span class="n">wait_draft</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-588"><a href="#Channel-588"><span class="linenos">588</span></a>        <span class="k">if</span> <span class="n">daylight_restriction</span><span class="p">:</span>
</span><span id="Channel-589"><a href="#Channel-589"><span class="linenos">589</span></a>            <span class="n">wait_daylight</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-590"><a href="#Channel-590"><span class="linenos">590</span></a>
</span><span id="Channel-591"><a href="#Channel-591"><span class="linenos">591</span></a>        <span class="n">restrictions</span> <span class="o">=</span> <span class="n">beam_restriction</span> <span class="ow">or</span> <span class="n">draft_restriction</span> <span class="ow">or</span> <span class="n">daylight_restriction</span> <span class="ow">or</span> <span class="n">channel_closed_restriction</span>
</span><span id="Channel-592"><a href="#Channel-592"><span class="linenos">592</span></a>
</span><span id="Channel-593"><a href="#Channel-593"><span class="linenos">593</span></a>        <span class="k">return</span> <span class="n">restrictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span>
</span><span id="Channel-594"><a href="#Channel-594"><span class="linenos">594</span></a>
</span><span id="Channel-595"><a href="#Channel-595"><span class="linenos">595</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">run_id</span><span class="p">):</span>
</span><span id="Channel-596"><a href="#Channel-596"><span class="linenos">596</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel-597"><a href="#Channel-597"><span class="linenos">597</span></a><span class="sd">        Process for handling the ship&#39;s entry into the channel.</span>
</span><span id="Channel-598"><a href="#Channel-598"><span class="linenos">598</span></a><span class="sd">        It handles the scheduling and movement of the ship through the channel, including checking for restrictions and logging the ship&#39;s information.</span>
</span><span id="Channel-599"><a href="#Channel-599"><span class="linenos">599</span></a><span class="sd">        The process has the following steps:</span>
</span><span id="Channel-600"><a href="#Channel-600"><span class="linenos">600</span></a><span class="sd">        1. Check if the ship is entering or leaving the channel based on its direction.</span>
</span><span id="Channel-601"><a href="#Channel-601"><span class="linenos">601</span></a><span class="sd">        2. If the ship is entering the channel, then:</span>
</span><span id="Channel-602"><a href="#Channel-602"><span class="linenos">602</span></a><span class="sd">            2.1. Get the pilots based on the time of day (day or night).</span>
</span><span id="Channel-603"><a href="#Channel-603"><span class="linenos">603</span></a><span class="sd">            2.2. Check when the ship is allowed to enter being free of restrictions.</span>
</span><span id="Channel-604"><a href="#Channel-604"><span class="linenos">604</span></a><span class="sd">            2.3 Schedule the ship to move through the channel.</span>
</span><span id="Channel-605"><a href="#Channel-605"><span class="linenos">605</span></a><span class="sd">            2.4 Wait till the ship can move through the channel.</span>
</span><span id="Channel-606"><a href="#Channel-606"><span class="linenos">606</span></a><span class="sd">            2.5 Move the ship through the channel.</span>
</span><span id="Channel-607"><a href="#Channel-607"><span class="linenos">607</span></a><span class="sd">            2.6 Get the tugboats and steer the ship.</span>
</span><span id="Channel-608"><a href="#Channel-608"><span class="linenos">608</span></a><span class="sd">        3. If the ship is leaving the channel, then:</span>
</span><span id="Channel-609"><a href="#Channel-609"><span class="linenos">609</span></a><span class="sd">            3.1. Get the pilots based on the time of day (day or night).</span>
</span><span id="Channel-610"><a href="#Channel-610"><span class="linenos">610</span></a><span class="sd">            3.2 Get the tugboats and steer the ship.</span>
</span><span id="Channel-611"><a href="#Channel-611"><span class="linenos">611</span></a><span class="sd">            3.3.Check when the ship is allowed to leave being free of restrictions.</span>
</span><span id="Channel-612"><a href="#Channel-612"><span class="linenos">612</span></a><span class="sd">            3.4 Schedule the ship to move through the channel.</span>
</span><span id="Channel-613"><a href="#Channel-613"><span class="linenos">613</span></a><span class="sd">            3.5 Wait till the ship can move through the channel.</span>
</span><span id="Channel-614"><a href="#Channel-614"><span class="linenos">614</span></a><span class="sd">            3.6 Move the ship through the channel.</span>
</span><span id="Channel-615"><a href="#Channel-615"><span class="linenos">615</span></a><span class="sd">        Args:</span>
</span><span id="Channel-616"><a href="#Channel-616"><span class="linenos">616</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, pilots, tugboats, and other attributes.</span>
</span><span id="Channel-617"><a href="#Channel-617"><span class="linenos">617</span></a><span class="sd">            day (bool): Whether it is daytime or nighttime.</span>
</span><span id="Channel-618"><a href="#Channel-618"><span class="linenos">618</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel-619"><a href="#Channel-619"><span class="linenos">619</span></a><span class="sd">            ship_id (int): The identifier for the ship.</span>
</span><span id="Channel-620"><a href="#Channel-620"><span class="linenos">620</span></a><span class="sd">            ship_terminal (str): The terminal where the ship is headed.</span>
</span><span id="Channel-621"><a href="#Channel-621"><span class="linenos">621</span></a><span class="sd">            ship_type (str): The type of the ship (e.g., Container, Liquid, DryBulk).</span>
</span><span id="Channel-622"><a href="#Channel-622"><span class="linenos">622</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="Channel-623"><a href="#Channel-623"><span class="linenos">623</span></a><span class="sd">        Returns:</span>
</span><span id="Channel-624"><a href="#Channel-624"><span class="linenos">624</span></a><span class="sd">            None</span>
</span><span id="Channel-625"><a href="#Channel-625"><span class="linenos">625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel-626"><a href="#Channel-626"><span class="linenos">626</span></a>        <span class="n">lastSection</span> <span class="o">=</span> <span class="n">lastSection</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel-627"><a href="#Channel-627"><span class="linenos">627</span></a>        <span class="n">request_time_initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-628"><a href="#Channel-628"><span class="linenos">628</span></a>
</span><span id="Channel-629"><a href="#Channel-629"><span class="linenos">629</span></a>        <span class="n">inbound_closed_tuples</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">INBOUND_CLOSED</span>
</span><span id="Channel-630"><a href="#Channel-630"><span class="linenos">630</span></a>        <span class="n">outbound_closed_tuples</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">OUTBOUND_CLOSED</span>
</span><span id="Channel-631"><a href="#Channel-631"><span class="linenos">631</span></a>
</span><span id="Channel-632"><a href="#Channel-632"><span class="linenos">632</span></a>        <span class="n">wait_queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">request_time_initial</span>
</span><span id="Channel-633"><a href="#Channel-633"><span class="linenos">633</span></a>
</span><span id="Channel-634"><a href="#Channel-634"><span class="linenos">634</span></a>        <span class="c1"># If ship travels in</span>
</span><span id="Channel-635"><a href="#Channel-635"><span class="linenos">635</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel-636"><a href="#Channel-636"><span class="linenos">636</span></a>            <span class="n">ship_entering_channel_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-637"><a href="#Channel-637"><span class="linenos">637</span></a>
</span><span id="Channel-638"><a href="#Channel-638"><span class="linenos">638</span></a>            <span class="c1"># get pilots</span>
</span><span id="Channel-639"><a href="#Channel-639"><span class="linenos">639</span></a>            <span class="n">day</span> <span class="o">=</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">ship_entering_channel_time</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
</span><span id="Channel-640"><a href="#Channel-640"><span class="linenos">640</span></a>
</span><span id="Channel-641"><a href="#Channel-641"><span class="linenos">641</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel-642"><a href="#Channel-642"><span class="linenos">642</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel-643"><a href="#Channel-643"><span class="linenos">643</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel-644"><a href="#Channel-644"><span class="linenos">644</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel-645"><a href="#Channel-645"><span class="linenos">645</span></a>            <span class="n">time_to_get_pilot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">ship_entering_channel_time</span>
</span><span id="Channel-646"><a href="#Channel-646"><span class="linenos">646</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel-647"><a href="#Channel-647"><span class="linenos">647</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_pilot_in</span><span class="o">=</span><span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel-648"><a href="#Channel-648"><span class="linenos">648</span></a>
</span><span id="Channel-649"><a href="#Channel-649"><span class="linenos">649</span></a>            <span class="c1"># travel anchorage to mouth of the channel</span>
</span><span id="Channel-650"><a href="#Channel-650"><span class="linenos">650</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel-651"><a href="#Channel-651"><span class="linenos">651</span></a>                <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel-652"><a href="#Channel-652"><span class="linenos">652</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel-653"><a href="#Channel-653"><span class="linenos">653</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="Channel-654"><a href="#Channel-654"><span class="linenos">654</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel-655"><a href="#Channel-655"><span class="linenos">655</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel-656"><a href="#Channel-656"><span class="linenos">656</span></a>                             <span class="n">time_to_common_channel_in</span><span class="o">=</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel-657"><a href="#Channel-657"><span class="linenos">657</span></a>
</span><span id="Channel-658"><a href="#Channel-658"><span class="linenos">658</span></a>            <span class="c1"># Schedule the ship to move through the channel</span>
</span><span id="Channel-659"><a href="#Channel-659"><span class="linenos">659</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
</span><span id="Channel-660"><a href="#Channel-660"><span class="linenos">660</span></a>                <span class="k">yield</span> <span class="n">request</span>
</span><span id="Channel-661"><a href="#Channel-661"><span class="linenos">661</span></a>
</span><span id="Channel-662"><a href="#Channel-662"><span class="linenos">662</span></a>                <span class="n">request_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-663"><a href="#Channel-663"><span class="linenos">663</span></a>                <span class="n">wait_daylight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-664"><a href="#Channel-664"><span class="linenos">664</span></a>                <span class="n">wait_beam</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-665"><a href="#Channel-665"><span class="linenos">665</span></a>                <span class="n">wait_draft</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-666"><a href="#Channel-666"><span class="linenos">666</span></a>                <span class="c1"># Note that multiple restrictions can be active at the same time</span>
</span><span id="Channel-667"><a href="#Channel-667"><span class="linenos">667</span></a>                <span class="n">wait_total_restriction</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-668"><a href="#Channel-668"><span class="linenos">668</span></a>                <span class="n">wait_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-669"><a href="#Channel-669"><span class="linenos">669</span></a>
</span><span id="Channel-670"><a href="#Channel-670"><span class="linenos">670</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">:</span>
</span><span id="Channel-671"><a href="#Channel-671"><span class="linenos">671</span></a>                    <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel-672"><a href="#Channel-672"><span class="linenos">672</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel-673"><a href="#Channel-673"><span class="linenos">673</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-674"><a href="#Channel-674"><span class="linenos">674</span></a>                    <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-675"><a href="#Channel-675"><span class="linenos">675</span></a>
</span><span id="Channel-676"><a href="#Channel-676"><span class="linenos">676</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-677"><a href="#Channel-677"><span class="linenos">677</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-678"><a href="#Channel-678"><span class="linenos">678</span></a>                            <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-679"><a href="#Channel-679"><span class="linenos">679</span></a>
</span><span id="Channel-680"><a href="#Channel-680"><span class="linenos">680</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-681"><a href="#Channel-681"><span class="linenos">681</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-682"><a href="#Channel-682"><span class="linenos">682</span></a>
</span><span id="Channel-683"><a href="#Channel-683"><span class="linenos">683</span></a>                    <span class="k">while</span> <span class="n">restrcictions</span> <span class="ow">or</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_inbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel-684"><a href="#Channel-684"><span class="linenos">684</span></a>                        <span class="k">if</span> <span class="n">channel_closed_inbound</span><span class="p">:</span>
</span><span id="Channel-685"><a href="#Channel-685"><span class="linenos">685</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Channel closed inbound at time&quot;</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-686"><a href="#Channel-686"><span class="linenos">686</span></a>
</span><span id="Channel-687"><a href="#Channel-687"><span class="linenos">687</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-688"><a href="#Channel-688"><span class="linenos">688</span></a>                        <span class="n">wait_total_restriction</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-689"><a href="#Channel-689"><span class="linenos">689</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-690"><a href="#Channel-690"><span class="linenos">690</span></a>                        <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel-691"><a href="#Channel-691"><span class="linenos">691</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel-692"><a href="#Channel-692"><span class="linenos">692</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-693"><a href="#Channel-693"><span class="linenos">693</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-694"><a href="#Channel-694"><span class="linenos">694</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-695"><a href="#Channel-695"><span class="linenos">695</span></a>                        <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-696"><a href="#Channel-696"><span class="linenos">696</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-697"><a href="#Channel-697"><span class="linenos">697</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-698"><a href="#Channel-698"><span class="linenos">698</span></a>                                <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-699"><a href="#Channel-699"><span class="linenos">699</span></a>
</span><span id="Channel-700"><a href="#Channel-700"><span class="linenos">700</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Channel-701"><a href="#Channel-701"><span class="linenos">701</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-702"><a href="#Channel-702"><span class="linenos">702</span></a>
</span><span id="Channel-703"><a href="#Channel-703"><span class="linenos">703</span></a>                    <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-704"><a href="#Channel-704"><span class="linenos">704</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-705"><a href="#Channel-705"><span class="linenos">705</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-706"><a href="#Channel-706"><span class="linenos">706</span></a>                            <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-707"><a href="#Channel-707"><span class="linenos">707</span></a>
</span><span id="Channel-708"><a href="#Channel-708"><span class="linenos">708</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-709"><a href="#Channel-709"><span class="linenos">709</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-710"><a href="#Channel-710"><span class="linenos">710</span></a>
</span><span id="Channel-711"><a href="#Channel-711"><span class="linenos">711</span></a>                    <span class="k">while</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_inbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel-712"><a href="#Channel-712"><span class="linenos">712</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-713"><a href="#Channel-713"><span class="linenos">713</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-714"><a href="#Channel-714"><span class="linenos">714</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-715"><a href="#Channel-715"><span class="linenos">715</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-716"><a href="#Channel-716"><span class="linenos">716</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-717"><a href="#Channel-717"><span class="linenos">717</span></a>                        <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-718"><a href="#Channel-718"><span class="linenos">718</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-719"><a href="#Channel-719"><span class="linenos">719</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-720"><a href="#Channel-720"><span class="linenos">720</span></a>                                <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-721"><a href="#Channel-721"><span class="linenos">721</span></a>
</span><span id="Channel-722"><a href="#Channel-722"><span class="linenos">722</span></a>                <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel-723"><a href="#Channel-723"><span class="linenos">723</span></a>                                 <span class="n">time_for_restriction_in</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B:</span><span class="si">{</span><span class="n">wait_beam</span><span class="si">}</span><span class="s1">, D:</span><span class="si">{</span><span class="n">wait_draft</span><span class="si">}</span><span class="s1">, DL:</span><span class="si">{</span><span class="n">wait_daylight</span><span class="si">}</span><span class="s1">, Q:</span><span class="si">{</span><span class="n">wait_queue</span><span class="si">}</span><span class="s1">, T:</span><span class="si">{</span><span class="n">wait_total</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Channel-724"><a href="#Channel-724"><span class="linenos">724</span></a>
</span><span id="Channel-725"><a href="#Channel-725"><span class="linenos">725</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span>
</span><span id="Channel-726"><a href="#Channel-726"><span class="linenos">726</span></a>                               <span class="n">enter_time</span><span class="o">=</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-727"><a href="#Channel-727"><span class="linenos">727</span></a>
</span><span id="Channel-728"><a href="#Channel-728"><span class="linenos">728</span></a>            <span class="c1"># travel through the channel</span>
</span><span id="Channel-729"><a href="#Channel-729"><span class="linenos">729</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">request_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
</span><span id="Channel-730"><a href="#Channel-730"><span class="linenos">730</span></a>            <span class="n">time_entered_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-731"><a href="#Channel-731"><span class="linenos">731</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move_through_channel</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">))</span>
</span><span id="Channel-732"><a href="#Channel-732"><span class="linenos">732</span></a>            <span class="n">time_to_travel_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_entered_channel</span>
</span><span id="Channel-733"><a href="#Channel-733"><span class="linenos">733</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel-734"><a href="#Channel-734"><span class="linenos">734</span></a>                             <span class="n">time_to_travel_channel_in</span><span class="o">=</span><span class="n">time_to_travel_channel</span><span class="p">)</span>
</span><span id="Channel-735"><a href="#Channel-735"><span class="linenos">735</span></a>
</span><span id="Channel-736"><a href="#Channel-736"><span class="linenos">736</span></a>            <span class="c1"># get tugs</span>
</span><span id="Channel-737"><a href="#Channel-737"><span class="linenos">737</span></a>            <span class="n">time_tug_req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-738"><a href="#Channel-738"><span class="linenos">738</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel-739"><a href="#Channel-739"><span class="linenos">739</span></a>            <span class="n">time_to_get_tugs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_tug_req</span>
</span><span id="Channel-740"><a href="#Channel-740"><span class="linenos">740</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel-741"><a href="#Channel-741"><span class="linenos">741</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_tugs_in</span><span class="o">=</span><span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="Channel-742"><a href="#Channel-742"><span class="linenos">742</span></a>
</span><span id="Channel-743"><a href="#Channel-743"><span class="linenos">743</span></a>            <span class="c1"># steer the ship</span>
</span><span id="Channel-744"><a href="#Channel-744"><span class="linenos">744</span></a>            <span class="n">time_to_tug_steer</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel-745"><a href="#Channel-745"><span class="linenos">745</span></a>                <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel-746"><a href="#Channel-746"><span class="linenos">746</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel-747"><a href="#Channel-747"><span class="linenos">747</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel-748"><a href="#Channel-748"><span class="linenos">748</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_tug_steer_in</span><span class="o">=</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel-749"><a href="#Channel-749"><span class="linenos">749</span></a>
</span><span id="Channel-750"><a href="#Channel-750"><span class="linenos">750</span></a>            <span class="c1"># put the tugs back</span>
</span><span id="Channel-751"><a href="#Channel-751"><span class="linenos">751</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel-752"><a href="#Channel-752"><span class="linenos">752</span></a>
</span><span id="Channel-753"><a href="#Channel-753"><span class="linenos">753</span></a>            <span class="c1"># Release pilots</span>
</span><span id="Channel-754"><a href="#Channel-754"><span class="linenos">754</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel-755"><a href="#Channel-755"><span class="linenos">755</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel-756"><a href="#Channel-756"><span class="linenos">756</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel-757"><a href="#Channel-757"><span class="linenos">757</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel-758"><a href="#Channel-758"><span class="linenos">758</span></a>
</span><span id="Channel-759"><a href="#Channel-759"><span class="linenos">759</span></a>            <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;out&#39;</span> <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span> <span class="k">else</span> <span class="s1">&#39;in&#39;</span>
</span><span id="Channel-760"><a href="#Channel-760"><span class="linenos">760</span></a>
</span><span id="Channel-761"><a href="#Channel-761"><span class="linenos">761</span></a>        <span class="c1"># If ship travels out</span>
</span><span id="Channel-762"><a href="#Channel-762"><span class="linenos">762</span></a>        <span class="c1"># Dont enter this if ship is going in even though ship_info[&#39;direction&#39;] is &#39;out&#39;</span>
</span><span id="Channel-763"><a href="#Channel-763"><span class="linenos">763</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel-764"><a href="#Channel-764"><span class="linenos">764</span></a>            <span class="n">ship_entering_channel_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-765"><a href="#Channel-765"><span class="linenos">765</span></a>
</span><span id="Channel-766"><a href="#Channel-766"><span class="linenos">766</span></a>            <span class="c1"># get pilots</span>
</span><span id="Channel-767"><a href="#Channel-767"><span class="linenos">767</span></a>            <span class="n">day</span> <span class="o">=</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">ship_entering_channel_time</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
</span><span id="Channel-768"><a href="#Channel-768"><span class="linenos">768</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel-769"><a href="#Channel-769"><span class="linenos">769</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel-770"><a href="#Channel-770"><span class="linenos">770</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel-771"><a href="#Channel-771"><span class="linenos">771</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel-772"><a href="#Channel-772"><span class="linenos">772</span></a>            <span class="n">time_to_get_pilot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">ship_entering_channel_time</span>
</span><span id="Channel-773"><a href="#Channel-773"><span class="linenos">773</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel-774"><a href="#Channel-774"><span class="linenos">774</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_pilot_out</span><span class="o">=</span><span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel-775"><a href="#Channel-775"><span class="linenos">775</span></a>
</span><span id="Channel-776"><a href="#Channel-776"><span class="linenos">776</span></a>            <span class="c1"># get tugs</span>
</span><span id="Channel-777"><a href="#Channel-777"><span class="linenos">777</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel-778"><a href="#Channel-778"><span class="linenos">778</span></a>            <span class="n">time_to_get_tugs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="Channel-779"><a href="#Channel-779"><span class="linenos">779</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel-780"><a href="#Channel-780"><span class="linenos">780</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel-781"><a href="#Channel-781"><span class="linenos">781</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_tugs_out</span><span class="o">=</span><span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="Channel-782"><a href="#Channel-782"><span class="linenos">782</span></a>
</span><span id="Channel-783"><a href="#Channel-783"><span class="linenos">783</span></a>            <span class="c1"># make a uturn</span>
</span><span id="Channel-784"><a href="#Channel-784"><span class="linenos">784</span></a>            <span class="n">time_to_uturn</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel-785"><a href="#Channel-785"><span class="linenos">785</span></a>                <span class="n">TIME_FOR_UTURN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_UTURN</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel-786"><a href="#Channel-786"><span class="linenos">786</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_uturn</span><span class="p">)</span>
</span><span id="Channel-787"><a href="#Channel-787"><span class="linenos">787</span></a>            <span class="n">time_for_uturn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="Channel-788"><a href="#Channel-788"><span class="linenos">788</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span> <span class="o">+</span> <span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="Channel-789"><a href="#Channel-789"><span class="linenos">789</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel-790"><a href="#Channel-790"><span class="linenos">790</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_for_uturn</span><span class="o">=</span><span class="n">time_for_uturn</span><span class="p">)</span>
</span><span id="Channel-791"><a href="#Channel-791"><span class="linenos">791</span></a>
</span><span id="Channel-792"><a href="#Channel-792"><span class="linenos">792</span></a>            <span class="c1"># steer the ship</span>
</span><span id="Channel-793"><a href="#Channel-793"><span class="linenos">793</span></a>            <span class="n">time_to_tug_steer</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel-794"><a href="#Channel-794"><span class="linenos">794</span></a>                <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel-795"><a href="#Channel-795"><span class="linenos">795</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel-796"><a href="#Channel-796"><span class="linenos">796</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel-797"><a href="#Channel-797"><span class="linenos">797</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_tug_steer_out</span><span class="o">=</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel-798"><a href="#Channel-798"><span class="linenos">798</span></a>
</span><span id="Channel-799"><a href="#Channel-799"><span class="linenos">799</span></a>            <span class="c1"># put the tugs back</span>
</span><span id="Channel-800"><a href="#Channel-800"><span class="linenos">800</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel-801"><a href="#Channel-801"><span class="linenos">801</span></a>
</span><span id="Channel-802"><a href="#Channel-802"><span class="linenos">802</span></a>            <span class="c1"># Schedule the ship to move through the channel</span>
</span><span id="Channel-803"><a href="#Channel-803"><span class="linenos">803</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
</span><span id="Channel-804"><a href="#Channel-804"><span class="linenos">804</span></a>                <span class="k">yield</span> <span class="n">request</span>
</span><span id="Channel-805"><a href="#Channel-805"><span class="linenos">805</span></a>                <span class="n">request_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-806"><a href="#Channel-806"><span class="linenos">806</span></a>                <span class="n">wait_daylight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-807"><a href="#Channel-807"><span class="linenos">807</span></a>                <span class="n">wait_beam</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-808"><a href="#Channel-808"><span class="linenos">808</span></a>                <span class="n">wait_draft</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-809"><a href="#Channel-809"><span class="linenos">809</span></a>                <span class="c1"># Note that multiple restrictions can be active at the same time</span>
</span><span id="Channel-810"><a href="#Channel-810"><span class="linenos">810</span></a>                <span class="n">wait_total_restriction</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-811"><a href="#Channel-811"><span class="linenos">811</span></a>                <span class="n">wait_queue</span> <span class="o">=</span> <span class="n">request_time</span> <span class="o">-</span> <span class="n">request_time_initial</span>
</span><span id="Channel-812"><a href="#Channel-812"><span class="linenos">812</span></a>                <span class="n">wait_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel-813"><a href="#Channel-813"><span class="linenos">813</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">:</span>
</span><span id="Channel-814"><a href="#Channel-814"><span class="linenos">814</span></a>                    <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel-815"><a href="#Channel-815"><span class="linenos">815</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel-816"><a href="#Channel-816"><span class="linenos">816</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-817"><a href="#Channel-817"><span class="linenos">817</span></a>                    <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-818"><a href="#Channel-818"><span class="linenos">818</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-819"><a href="#Channel-819"><span class="linenos">819</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-820"><a href="#Channel-820"><span class="linenos">820</span></a>                            <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-821"><a href="#Channel-821"><span class="linenos">821</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-822"><a href="#Channel-822"><span class="linenos">822</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-823"><a href="#Channel-823"><span class="linenos">823</span></a>                    <span class="k">while</span> <span class="n">restrcictions</span> <span class="ow">or</span> <span class="n">channel_closed_outbound</span> <span class="ow">or</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel-824"><a href="#Channel-824"><span class="linenos">824</span></a>
</span><span id="Channel-825"><a href="#Channel-825"><span class="linenos">825</span></a>                        <span class="k">if</span> <span class="n">channel_closed_outbound</span><span class="p">:</span>
</span><span id="Channel-826"><a href="#Channel-826"><span class="linenos">826</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Channel closed outbound at time&quot;</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-827"><a href="#Channel-827"><span class="linenos">827</span></a>
</span><span id="Channel-828"><a href="#Channel-828"><span class="linenos">828</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-829"><a href="#Channel-829"><span class="linenos">829</span></a>                        <span class="n">wait_total_restriction</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-830"><a href="#Channel-830"><span class="linenos">830</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-831"><a href="#Channel-831"><span class="linenos">831</span></a>                        <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel-832"><a href="#Channel-832"><span class="linenos">832</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel-833"><a href="#Channel-833"><span class="linenos">833</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-834"><a href="#Channel-834"><span class="linenos">834</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-835"><a href="#Channel-835"><span class="linenos">835</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-836"><a href="#Channel-836"><span class="linenos">836</span></a>
</span><span id="Channel-837"><a href="#Channel-837"><span class="linenos">837</span></a>                        <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-838"><a href="#Channel-838"><span class="linenos">838</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-839"><a href="#Channel-839"><span class="linenos">839</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-840"><a href="#Channel-840"><span class="linenos">840</span></a>                                <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-841"><a href="#Channel-841"><span class="linenos">841</span></a>
</span><span id="Channel-842"><a href="#Channel-842"><span class="linenos">842</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Channel-843"><a href="#Channel-843"><span class="linenos">843</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-844"><a href="#Channel-844"><span class="linenos">844</span></a>                    <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-845"><a href="#Channel-845"><span class="linenos">845</span></a>
</span><span id="Channel-846"><a href="#Channel-846"><span class="linenos">846</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-847"><a href="#Channel-847"><span class="linenos">847</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-848"><a href="#Channel-848"><span class="linenos">848</span></a>                            <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-849"><a href="#Channel-849"><span class="linenos">849</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-850"><a href="#Channel-850"><span class="linenos">850</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-851"><a href="#Channel-851"><span class="linenos">851</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-852"><a href="#Channel-852"><span class="linenos">852</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-853"><a href="#Channel-853"><span class="linenos">853</span></a>                    <span class="k">while</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_outbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel-854"><a href="#Channel-854"><span class="linenos">854</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-855"><a href="#Channel-855"><span class="linenos">855</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel-856"><a href="#Channel-856"><span class="linenos">856</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-857"><a href="#Channel-857"><span class="linenos">857</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel-858"><a href="#Channel-858"><span class="linenos">858</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-859"><a href="#Channel-859"><span class="linenos">859</span></a>
</span><span id="Channel-860"><a href="#Channel-860"><span class="linenos">860</span></a>                        <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel-861"><a href="#Channel-861"><span class="linenos">861</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel-862"><a href="#Channel-862"><span class="linenos">862</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel-863"><a href="#Channel-863"><span class="linenos">863</span></a>                                <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel-864"><a href="#Channel-864"><span class="linenos">864</span></a>
</span><span id="Channel-865"><a href="#Channel-865"><span class="linenos">865</span></a>                <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel-866"><a href="#Channel-866"><span class="linenos">866</span></a>                                 <span class="n">time_for_restriction_out</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B:</span><span class="si">{</span><span class="n">wait_beam</span><span class="si">}</span><span class="s1">, D:</span><span class="si">{</span><span class="n">wait_draft</span><span class="si">}</span><span class="s1">, DL:</span><span class="si">{</span><span class="n">wait_daylight</span><span class="si">}</span><span class="s1">, Q:</span><span class="si">{</span><span class="n">wait_queue</span><span class="si">}</span><span class="s1">, T:</span><span class="si">{</span><span class="n">wait_total</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Channel-867"><a href="#Channel-867"><span class="linenos">867</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span>
</span><span id="Channel-868"><a href="#Channel-868"><span class="linenos">868</span></a>                               <span class="n">enter_time</span><span class="o">=</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel-869"><a href="#Channel-869"><span class="linenos">869</span></a>
</span><span id="Channel-870"><a href="#Channel-870"><span class="linenos">870</span></a>            <span class="c1"># travel through the channel</span>
</span><span id="Channel-871"><a href="#Channel-871"><span class="linenos">871</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">request_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
</span><span id="Channel-872"><a href="#Channel-872"><span class="linenos">872</span></a>            <span class="n">time_entered_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel-873"><a href="#Channel-873"><span class="linenos">873</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move_through_channel</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">))</span>
</span><span id="Channel-874"><a href="#Channel-874"><span class="linenos">874</span></a>            <span class="n">time_to_travel_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_entered_channel</span>
</span><span id="Channel-875"><a href="#Channel-875"><span class="linenos">875</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel-876"><a href="#Channel-876"><span class="linenos">876</span></a>                             <span class="n">time_to_travel_channel_out</span><span class="o">=</span><span class="n">time_to_travel_channel</span><span class="p">)</span>
</span><span id="Channel-877"><a href="#Channel-877"><span class="linenos">877</span></a>
</span><span id="Channel-878"><a href="#Channel-878"><span class="linenos">878</span></a>            <span class="c1"># travel from mouth of the channel to anchorage</span>
</span><span id="Channel-879"><a href="#Channel-879"><span class="linenos">879</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel-880"><a href="#Channel-880"><span class="linenos">880</span></a>                <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel-881"><a href="#Channel-881"><span class="linenos">881</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel-882"><a href="#Channel-882"><span class="linenos">882</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel-883"><a href="#Channel-883"><span class="linenos">883</span></a>                             <span class="n">time_to_common_channel_out</span><span class="o">=</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel-884"><a href="#Channel-884"><span class="linenos">884</span></a>
</span><span id="Channel-885"><a href="#Channel-885"><span class="linenos">885</span></a>            <span class="c1"># Release pilots</span>
</span><span id="Channel-886"><a href="#Channel-886"><span class="linenos">886</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel-887"><a href="#Channel-887"><span class="linenos">887</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel-888"><a href="#Channel-888"><span class="linenos">888</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel-889"><a href="#Channel-889"><span class="linenos">889</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Class for the entire channel.</p>

<p>This class manages the sections of the channel and handles ship navigation through it. It implements the necessary methods to check for restrictions, schedule ships, and log their movements.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_logs (list):</strong>  List to log ship information.</li>
<li><strong>env (Env):</strong>  The simulation environment.</li>
<li><strong>numSections (int):</strong>  Number of sections in the channel.</li>
<li><strong>simulation_time (int):</strong>  Total simulation time for the channel.</li>
<li><strong>safeTwoway (bool):</strong>  Whether the channel is safe for two-way traffic.</li>
<li><strong>channel_events (list):</strong>  List to log channel events.</li>
<li><strong>channel_logs (list):</strong>  List to log channel information.</li>
<li><strong>day_pilots (simpy.Container):</strong>  Simpy container for day pilots.</li>
<li><strong>night_pilots (simpy.Container):</strong>  Simpy container for night pilots.</li>
<li><strong>tugboats (simpy.Container):</strong>  Simpy container for tugboats.</li>
<li><strong>turnoffTime (dict):</strong>  Dictionary with turnoff times and conditions.</li>
<li><strong>channel_scheduer (Resource):</strong>  Resource for scheduling channel usage.</li>
<li><strong>seed (int):</strong>  Random seed for reproducibility.</li>
</ul>
</div>


                            <div id="Channel.channel_closed" class="classattr">
                                        <input id="Channel.channel_closed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">channel_closed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.channel_closed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.channel_closed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.channel_closed-272"><a href="#Channel.channel_closed-272"><span class="linenos">272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
</span><span id="Channel.channel_closed-273"><a href="#Channel.channel_closed-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.channel_closed-274"><a href="#Channel.channel_closed-274"><span class="linenos">274</span></a><span class="sd">        Check if the channel is closed at a given time step.</span>
</span><span id="Channel.channel_closed-275"><a href="#Channel.channel_closed-275"><span class="linenos">275</span></a><span class="sd">        Args:</span>
</span><span id="Channel.channel_closed-276"><a href="#Channel.channel_closed-276"><span class="linenos">276</span></a><span class="sd">            time (int): The time step to check for channel closure.</span>
</span><span id="Channel.channel_closed-277"><a href="#Channel.channel_closed-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.channel_closed-278"><a href="#Channel.channel_closed-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span><span class="p">[</span><span class="s2">&quot;switch&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;channel_closed&quot;</span><span class="p">:</span>
</span><span id="Channel.channel_closed-279"><a href="#Channel.channel_closed-279"><span class="linenos">279</span></a>            <span class="k">for</span> <span class="n">start_end_tuples</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">turnoffTime</span><span class="p">[</span><span class="s2">&quot;closed_between&quot;</span><span class="p">]:</span>
</span><span id="Channel.channel_closed-280"><a href="#Channel.channel_closed-280"><span class="linenos">280</span></a>                <span class="k">if</span> <span class="n">start_end_tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span> <span class="o">&lt;</span> <span class="n">start_end_tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="Channel.channel_closed-281"><a href="#Channel.channel_closed-281"><span class="linenos">281</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.channel_closed-282"><a href="#Channel.channel_closed-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check if the channel is closed at a given time step.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>time (int):</strong>  The time step to check for channel closure.</li>
</ul>
</div>


                            </div>
                            <div id="Channel.channel_closed_restriction" class="classattr">
                                        <input id="Channel.channel_closed_restriction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">channel_closed_restriction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">lastSection</span>, </span><span class="param"><span class="n">enter_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.channel_closed_restriction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.channel_closed_restriction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.channel_closed_restriction-284"><a href="#Channel.channel_closed_restriction-284"><span class="linenos">284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_closed_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel.channel_closed_restriction-285"><a href="#Channel.channel_closed_restriction-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.channel_closed_restriction-286"><a href="#Channel.channel_closed_restriction-286"><span class="linenos">286</span></a><span class="sd">        Check if the ship has beam restriction in the channel in any section at a given time step.</span>
</span><span id="Channel.channel_closed_restriction-287"><a href="#Channel.channel_closed_restriction-287"><span class="linenos">287</span></a><span class="sd">        Logic: </span>
</span><span id="Channel.channel_closed_restriction-288"><a href="#Channel.channel_closed_restriction-288"><span class="linenos">288</span></a><span class="sd">        - If the ship is entering the channel, check each section from the start to the last section.</span>
</span><span id="Channel.channel_closed_restriction-289"><a href="#Channel.channel_closed_restriction-289"><span class="linenos">289</span></a><span class="sd">        - If the ship is leaving the channel, check each section from the last section to the start.</span>
</span><span id="Channel.channel_closed_restriction-290"><a href="#Channel.channel_closed_restriction-290"><span class="linenos">290</span></a><span class="sd">        - For each section, calculate the end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="Channel.channel_closed_restriction-291"><a href="#Channel.channel_closed_restriction-291"><span class="linenos">291</span></a><span class="sd">        - For each section, check if the channel is closed at the end time.</span>
</span><span id="Channel.channel_closed_restriction-292"><a href="#Channel.channel_closed_restriction-292"><span class="linenos">292</span></a><span class="sd">        - If the channel is closed at the end time, return True (indicating the channel is closed for the ship).</span>
</span><span id="Channel.channel_closed_restriction-293"><a href="#Channel.channel_closed_restriction-293"><span class="linenos">293</span></a><span class="sd">        - If no section is closed, return False (indicating the channel is open for the ship).</span>
</span><span id="Channel.channel_closed_restriction-294"><a href="#Channel.channel_closed_restriction-294"><span class="linenos">294</span></a><span class="sd">        Args:</span>
</span><span id="Channel.channel_closed_restriction-295"><a href="#Channel.channel_closed_restriction-295"><span class="linenos">295</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="Channel.channel_closed_restriction-296"><a href="#Channel.channel_closed_restriction-296"><span class="linenos">296</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.channel_closed_restriction-297"><a href="#Channel.channel_closed_restriction-297"><span class="linenos">297</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel.channel_closed_restriction-298"><a href="#Channel.channel_closed_restriction-298"><span class="linenos">298</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.channel_closed_restriction-299"><a href="#Channel.channel_closed_restriction-299"><span class="linenos">299</span></a><span class="sd">            bool: True if the channel is closed for the ship, False otherwise.</span>
</span><span id="Channel.channel_closed_restriction-300"><a href="#Channel.channel_closed_restriction-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.channel_closed_restriction-301"><a href="#Channel.channel_closed_restriction-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel.channel_closed_restriction-302"><a href="#Channel.channel_closed_restriction-302"><span class="linenos">302</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.channel_closed_restriction-303"><a href="#Channel.channel_closed_restriction-303"><span class="linenos">303</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel.channel_closed_restriction-304"><a href="#Channel.channel_closed_restriction-304"><span class="linenos">304</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.channel_closed_restriction-305"><a href="#Channel.channel_closed_restriction-305"><span class="linenos">305</span></a>                    <span class="k">break</span>
</span><span id="Channel.channel_closed_restriction-306"><a href="#Channel.channel_closed_restriction-306"><span class="linenos">306</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.channel_closed_restriction-307"><a href="#Channel.channel_closed_restriction-307"><span class="linenos">307</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.channel_closed_restriction-308"><a href="#Channel.channel_closed_restriction-308"><span class="linenos">308</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel.channel_closed_restriction-309"><a href="#Channel.channel_closed_restriction-309"><span class="linenos">309</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.channel_closed_restriction-310"><a href="#Channel.channel_closed_restriction-310"><span class="linenos">310</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.channel_closed_restriction-311"><a href="#Channel.channel_closed_restriction-311"><span class="linenos">311</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel.channel_closed_restriction-312"><a href="#Channel.channel_closed_restriction-312"><span class="linenos">312</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel.channel_closed_restriction-313"><a href="#Channel.channel_closed_restriction-313"><span class="linenos">313</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.channel_closed_restriction-314"><a href="#Channel.channel_closed_restriction-314"><span class="linenos">314</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel.channel_closed_restriction-315"><a href="#Channel.channel_closed_restriction-315"><span class="linenos">315</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel.channel_closed_restriction-316"><a href="#Channel.channel_closed_restriction-316"><span class="linenos">316</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.channel_closed_restriction-317"><a href="#Channel.channel_closed_restriction-317"><span class="linenos">317</span></a>                    <span class="k">continue</span>
</span><span id="Channel.channel_closed_restriction-318"><a href="#Channel.channel_closed_restriction-318"><span class="linenos">318</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.channel_closed_restriction-319"><a href="#Channel.channel_closed_restriction-319"><span class="linenos">319</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.channel_closed_restriction-320"><a href="#Channel.channel_closed_restriction-320"><span class="linenos">320</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel.channel_closed_restriction-321"><a href="#Channel.channel_closed_restriction-321"><span class="linenos">321</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.channel_closed_restriction-322"><a href="#Channel.channel_closed_restriction-322"><span class="linenos">322</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.channel_closed_restriction-323"><a href="#Channel.channel_closed_restriction-323"><span class="linenos">323</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check if the ship has beam restriction in the channel in any section at a given time step.
Logic: </p>

<ul>
<li>If the ship is entering the channel, check each section from the start to the last section.</li>
<li>If the ship is leaving the channel, check each section from the last section to the start.</li>
<li>For each section, calculate the end time based on the ship's speed and length of the section.</li>
<li>For each section, check if the channel is closed at the end time.</li>
<li>If the channel is closed at the end time, return True (indicating the channel is closed for the ship).</li>
<li>If no section is closed, return False (indicating the channel is open for the ship).</li>
</ul>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its direction.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>enter_time (int):</strong>  The time step when the ship enters the channel.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the channel is closed for the ship, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.beam_restriction" class="classattr">
                                        <input id="Channel.beam_restriction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_restriction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">lastSection</span>, </span><span class="param"><span class="n">enter_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.beam_restriction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.beam_restriction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.beam_restriction-325"><a href="#Channel.beam_restriction-325"><span class="linenos">325</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">beam_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel.beam_restriction-326"><a href="#Channel.beam_restriction-326"><span class="linenos">326</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.beam_restriction-327"><a href="#Channel.beam_restriction-327"><span class="linenos">327</span></a><span class="sd">        Check if the ship has beam restriction in the channel in any section at a given time step.</span>
</span><span id="Channel.beam_restriction-328"><a href="#Channel.beam_restriction-328"><span class="linenos">328</span></a><span class="sd">        Logic: </span>
</span><span id="Channel.beam_restriction-329"><a href="#Channel.beam_restriction-329"><span class="linenos">329</span></a><span class="sd">        - If the ship is entering the channel, check each section from the start to the last section.</span>
</span><span id="Channel.beam_restriction-330"><a href="#Channel.beam_restriction-330"><span class="linenos">330</span></a><span class="sd">        - If the ship is leaving the channel, check each section from the last section to the start.</span>
</span><span id="Channel.beam_restriction-331"><a href="#Channel.beam_restriction-331"><span class="linenos">331</span></a><span class="sd">        - For each section, calculate the end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="Channel.beam_restriction-332"><a href="#Channel.beam_restriction-332"><span class="linenos">332</span></a><span class="sd">        - For each section, check if the width of the ship exceeds the available width in the section.</span>
</span><span id="Channel.beam_restriction-333"><a href="#Channel.beam_restriction-333"><span class="linenos">333</span></a><span class="sd">        - If the width of the ship exceeds the available width in any section, return True (indicating beam restriction).</span>
</span><span id="Channel.beam_restriction-334"><a href="#Channel.beam_restriction-334"><span class="linenos">334</span></a><span class="sd">        - If no section has beam restriction, return False (indicating no beam restriction).</span>
</span><span id="Channel.beam_restriction-335"><a href="#Channel.beam_restriction-335"><span class="linenos">335</span></a><span class="sd">        Args:</span>
</span><span id="Channel.beam_restriction-336"><a href="#Channel.beam_restriction-336"><span class="linenos">336</span></a><span class="sd">            ship_info (dict): Information about the ship, including its width and direction.</span>
</span><span id="Channel.beam_restriction-337"><a href="#Channel.beam_restriction-337"><span class="linenos">337</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.beam_restriction-338"><a href="#Channel.beam_restriction-338"><span class="linenos">338</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel.beam_restriction-339"><a href="#Channel.beam_restriction-339"><span class="linenos">339</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.beam_restriction-340"><a href="#Channel.beam_restriction-340"><span class="linenos">340</span></a><span class="sd">            bool: True if the ship has beam restriction, False otherwise.</span>
</span><span id="Channel.beam_restriction-341"><a href="#Channel.beam_restriction-341"><span class="linenos">341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.beam_restriction-342"><a href="#Channel.beam_restriction-342"><span class="linenos">342</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel.beam_restriction-343"><a href="#Channel.beam_restriction-343"><span class="linenos">343</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.beam_restriction-344"><a href="#Channel.beam_restriction-344"><span class="linenos">344</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel.beam_restriction-345"><a href="#Channel.beam_restriction-345"><span class="linenos">345</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.beam_restriction-346"><a href="#Channel.beam_restriction-346"><span class="linenos">346</span></a>                    <span class="k">break</span>
</span><span id="Channel.beam_restriction-347"><a href="#Channel.beam_restriction-347"><span class="linenos">347</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.beam_restriction-348"><a href="#Channel.beam_restriction-348"><span class="linenos">348</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.beam_restriction-349"><a href="#Channel.beam_restriction-349"><span class="linenos">349</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_width</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel.beam_restriction-350"><a href="#Channel.beam_restriction-350"><span class="linenos">350</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.beam_restriction-351"><a href="#Channel.beam_restriction-351"><span class="linenos">351</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.beam_restriction-352"><a href="#Channel.beam_restriction-352"><span class="linenos">352</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel.beam_restriction-353"><a href="#Channel.beam_restriction-353"><span class="linenos">353</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel.beam_restriction-354"><a href="#Channel.beam_restriction-354"><span class="linenos">354</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.beam_restriction-355"><a href="#Channel.beam_restriction-355"><span class="linenos">355</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel.beam_restriction-356"><a href="#Channel.beam_restriction-356"><span class="linenos">356</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel.beam_restriction-357"><a href="#Channel.beam_restriction-357"><span class="linenos">357</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.beam_restriction-358"><a href="#Channel.beam_restriction-358"><span class="linenos">358</span></a>                    <span class="k">continue</span>
</span><span id="Channel.beam_restriction-359"><a href="#Channel.beam_restriction-359"><span class="linenos">359</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.beam_restriction-360"><a href="#Channel.beam_restriction-360"><span class="linenos">360</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.beam_restriction-361"><a href="#Channel.beam_restriction-361"><span class="linenos">361</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_width</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel.beam_restriction-362"><a href="#Channel.beam_restriction-362"><span class="linenos">362</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.beam_restriction-363"><a href="#Channel.beam_restriction-363"><span class="linenos">363</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.beam_restriction-364"><a href="#Channel.beam_restriction-364"><span class="linenos">364</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check if the ship has beam restriction in the channel in any section at a given time step.
Logic: </p>

<ul>
<li>If the ship is entering the channel, check each section from the start to the last section.</li>
<li>If the ship is leaving the channel, check each section from the last section to the start.</li>
<li>For each section, calculate the end time based on the ship's speed and length of the section.</li>
<li>For each section, check if the width of the ship exceeds the available width in the section.</li>
<li>If the width of the ship exceeds the available width in any section, return True (indicating beam restriction).</li>
<li>If no section has beam restriction, return False (indicating no beam restriction).</li>
</ul>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its width and direction.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>enter_time (int):</strong>  The time step when the ship enters the channel.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the ship has beam restriction, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.draft_restriction" class="classattr">
                                        <input id="Channel.draft_restriction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draft_restriction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">lastSection</span>, </span><span class="param"><span class="n">enter_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.draft_restriction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.draft_restriction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.draft_restriction-366"><a href="#Channel.draft_restriction-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">draft_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel.draft_restriction-367"><a href="#Channel.draft_restriction-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.draft_restriction-368"><a href="#Channel.draft_restriction-368"><span class="linenos">368</span></a><span class="sd">        Check if the ship has draft restriction in the channel in any section at a given time step.</span>
</span><span id="Channel.draft_restriction-369"><a href="#Channel.draft_restriction-369"><span class="linenos">369</span></a><span class="sd">        Logic is similar to beam_restriction, but checks for draft instead of width.</span>
</span><span id="Channel.draft_restriction-370"><a href="#Channel.draft_restriction-370"><span class="linenos">370</span></a><span class="sd">        Args:</span>
</span><span id="Channel.draft_restriction-371"><a href="#Channel.draft_restriction-371"><span class="linenos">371</span></a><span class="sd">            ship_info (dict): Information about the ship, including its draft and direction.</span>
</span><span id="Channel.draft_restriction-372"><a href="#Channel.draft_restriction-372"><span class="linenos">372</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.draft_restriction-373"><a href="#Channel.draft_restriction-373"><span class="linenos">373</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel.draft_restriction-374"><a href="#Channel.draft_restriction-374"><span class="linenos">374</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.draft_restriction-375"><a href="#Channel.draft_restriction-375"><span class="linenos">375</span></a><span class="sd">            bool: True if the ship has draft restriction, False otherwise.</span>
</span><span id="Channel.draft_restriction-376"><a href="#Channel.draft_restriction-376"><span class="linenos">376</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.draft_restriction-377"><a href="#Channel.draft_restriction-377"><span class="linenos">377</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel.draft_restriction-378"><a href="#Channel.draft_restriction-378"><span class="linenos">378</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.draft_restriction-379"><a href="#Channel.draft_restriction-379"><span class="linenos">379</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel.draft_restriction-380"><a href="#Channel.draft_restriction-380"><span class="linenos">380</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.draft_restriction-381"><a href="#Channel.draft_restriction-381"><span class="linenos">381</span></a>                    <span class="k">break</span>
</span><span id="Channel.draft_restriction-382"><a href="#Channel.draft_restriction-382"><span class="linenos">382</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.draft_restriction-383"><a href="#Channel.draft_restriction-383"><span class="linenos">383</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.draft_restriction-384"><a href="#Channel.draft_restriction-384"><span class="linenos">384</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_draft</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel.draft_restriction-385"><a href="#Channel.draft_restriction-385"><span class="linenos">385</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.draft_restriction-386"><a href="#Channel.draft_restriction-386"><span class="linenos">386</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.draft_restriction-387"><a href="#Channel.draft_restriction-387"><span class="linenos">387</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel.draft_restriction-388"><a href="#Channel.draft_restriction-388"><span class="linenos">388</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel.draft_restriction-389"><a href="#Channel.draft_restriction-389"><span class="linenos">389</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.draft_restriction-390"><a href="#Channel.draft_restriction-390"><span class="linenos">390</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel.draft_restriction-391"><a href="#Channel.draft_restriction-391"><span class="linenos">391</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel.draft_restriction-392"><a href="#Channel.draft_restriction-392"><span class="linenos">392</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.draft_restriction-393"><a href="#Channel.draft_restriction-393"><span class="linenos">393</span></a>                    <span class="k">continue</span>
</span><span id="Channel.draft_restriction-394"><a href="#Channel.draft_restriction-394"><span class="linenos">394</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.draft_restriction-395"><a href="#Channel.draft_restriction-395"><span class="linenos">395</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.draft_restriction-396"><a href="#Channel.draft_restriction-396"><span class="linenos">396</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accommodate_draft</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
</span><span id="Channel.draft_restriction-397"><a href="#Channel.draft_restriction-397"><span class="linenos">397</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.draft_restriction-398"><a href="#Channel.draft_restriction-398"><span class="linenos">398</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.draft_restriction-399"><a href="#Channel.draft_restriction-399"><span class="linenos">399</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check if the ship has draft restriction in the channel in any section at a given time step.
Logic is similar to beam_restriction, but checks for draft instead of width.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its draft and direction.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>enter_time (int):</strong>  The time step when the ship enters the channel.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the ship has draft restriction, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.minimal_spacing_not_avlbl" class="classattr">
                                        <input id="Channel.minimal_spacing_not_avlbl-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">minimal_spacing_not_avlbl</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">lastSection</span>, </span><span class="param"><span class="n">enter_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.minimal_spacing_not_avlbl-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.minimal_spacing_not_avlbl"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.minimal_spacing_not_avlbl-401"><a href="#Channel.minimal_spacing_not_avlbl-401"><span class="linenos">401</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">minimal_spacing_not_avlbl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel.minimal_spacing_not_avlbl-402"><a href="#Channel.minimal_spacing_not_avlbl-402"><span class="linenos">402</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.minimal_spacing_not_avlbl-403"><a href="#Channel.minimal_spacing_not_avlbl-403"><span class="linenos">403</span></a><span class="sd">        Check if the minimal spacing for the ship is not available in the channel in any section at a given time step.</span>
</span><span id="Channel.minimal_spacing_not_avlbl-404"><a href="#Channel.minimal_spacing_not_avlbl-404"><span class="linenos">404</span></a><span class="sd">        Logic is similar to beam_restriction, but checks for minimal spacing instead of width.</span>
</span><span id="Channel.minimal_spacing_not_avlbl-405"><a href="#Channel.minimal_spacing_not_avlbl-405"><span class="linenos">405</span></a><span class="sd">        Args:</span>
</span><span id="Channel.minimal_spacing_not_avlbl-406"><a href="#Channel.minimal_spacing_not_avlbl-406"><span class="linenos">406</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction.</span>
</span><span id="Channel.minimal_spacing_not_avlbl-407"><a href="#Channel.minimal_spacing_not_avlbl-407"><span class="linenos">407</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.minimal_spacing_not_avlbl-408"><a href="#Channel.minimal_spacing_not_avlbl-408"><span class="linenos">408</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel.minimal_spacing_not_avlbl-409"><a href="#Channel.minimal_spacing_not_avlbl-409"><span class="linenos">409</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.minimal_spacing_not_avlbl-410"><a href="#Channel.minimal_spacing_not_avlbl-410"><span class="linenos">410</span></a><span class="sd">            bool: True if the minimal spacing is not available, False otherwise.</span>
</span><span id="Channel.minimal_spacing_not_avlbl-411"><a href="#Channel.minimal_spacing_not_avlbl-411"><span class="linenos">411</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.minimal_spacing_not_avlbl-412"><a href="#Channel.minimal_spacing_not_avlbl-412"><span class="linenos">412</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel.minimal_spacing_not_avlbl-413"><a href="#Channel.minimal_spacing_not_avlbl-413"><span class="linenos">413</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.minimal_spacing_not_avlbl-414"><a href="#Channel.minimal_spacing_not_avlbl-414"><span class="linenos">414</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel.minimal_spacing_not_avlbl-415"><a href="#Channel.minimal_spacing_not_avlbl-415"><span class="linenos">415</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.minimal_spacing_not_avlbl-416"><a href="#Channel.minimal_spacing_not_avlbl-416"><span class="linenos">416</span></a>                    <span class="k">break</span>
</span><span id="Channel.minimal_spacing_not_avlbl-417"><a href="#Channel.minimal_spacing_not_avlbl-417"><span class="linenos">417</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.minimal_spacing_not_avlbl-418"><a href="#Channel.minimal_spacing_not_avlbl-418"><span class="linenos">418</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.minimal_spacing_not_avlbl-419"><a href="#Channel.minimal_spacing_not_avlbl-419"><span class="linenos">419</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accomodate_gap_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="Channel.minimal_spacing_not_avlbl-420"><a href="#Channel.minimal_spacing_not_avlbl-420"><span class="linenos">420</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.minimal_spacing_not_avlbl-421"><a href="#Channel.minimal_spacing_not_avlbl-421"><span class="linenos">421</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.minimal_spacing_not_avlbl-422"><a href="#Channel.minimal_spacing_not_avlbl-422"><span class="linenos">422</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Channel.minimal_spacing_not_avlbl-423"><a href="#Channel.minimal_spacing_not_avlbl-423"><span class="linenos">423</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel.minimal_spacing_not_avlbl-424"><a href="#Channel.minimal_spacing_not_avlbl-424"><span class="linenos">424</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.minimal_spacing_not_avlbl-425"><a href="#Channel.minimal_spacing_not_avlbl-425"><span class="linenos">425</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel.minimal_spacing_not_avlbl-426"><a href="#Channel.minimal_spacing_not_avlbl-426"><span class="linenos">426</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel.minimal_spacing_not_avlbl-427"><a href="#Channel.minimal_spacing_not_avlbl-427"><span class="linenos">427</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.minimal_spacing_not_avlbl-428"><a href="#Channel.minimal_spacing_not_avlbl-428"><span class="linenos">428</span></a>                    <span class="k">continue</span>
</span><span id="Channel.minimal_spacing_not_avlbl-429"><a href="#Channel.minimal_spacing_not_avlbl-429"><span class="linenos">429</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.minimal_spacing_not_avlbl-430"><a href="#Channel.minimal_spacing_not_avlbl-430"><span class="linenos">430</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.minimal_spacing_not_avlbl-431"><a href="#Channel.minimal_spacing_not_avlbl-431"><span class="linenos">431</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">can_accomodate_gap_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">):</span>
</span><span id="Channel.minimal_spacing_not_avlbl-432"><a href="#Channel.minimal_spacing_not_avlbl-432"><span class="linenos">432</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Channel.minimal_spacing_not_avlbl-433"><a href="#Channel.minimal_spacing_not_avlbl-433"><span class="linenos">433</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.minimal_spacing_not_avlbl-434"><a href="#Channel.minimal_spacing_not_avlbl-434"><span class="linenos">434</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check if the minimal spacing for the ship is not available in the channel in any section at a given time step.
Logic is similar to beam_restriction, but checks for minimal spacing instead of width.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its direction.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>enter_time (int):</strong>  The time step when the ship enters the channel.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the minimal spacing is not available, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.daylight_restriction" class="classattr">
                                        <input id="Channel.daylight_restriction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">daylight_restriction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">lastSection</span>, </span><span class="param"><span class="n">enter_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.daylight_restriction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.daylight_restriction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.daylight_restriction-436"><a href="#Channel.daylight_restriction-436"><span class="linenos">436</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">daylight_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel.daylight_restriction-437"><a href="#Channel.daylight_restriction-437"><span class="linenos">437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.daylight_restriction-438"><a href="#Channel.daylight_restriction-438"><span class="linenos">438</span></a><span class="sd">        Check if the ship has daylight restriction in the channel at a given time step.</span>
</span><span id="Channel.daylight_restriction-439"><a href="#Channel.daylight_restriction-439"><span class="linenos">439</span></a><span class="sd">        Logic:</span>
</span><span id="Channel.daylight_restriction-440"><a href="#Channel.daylight_restriction-440"><span class="linenos">440</span></a><span class="sd">        - Check the ship&#39;s type and dimensions (width and length).</span>
</span><span id="Channel.daylight_restriction-441"><a href="#Channel.daylight_restriction-441"><span class="linenos">441</span></a><span class="sd">        - If the ship is a Container, Liquid, or DryBulk type, check if its width or length exceeds the specified limits.</span>
</span><span id="Channel.daylight_restriction-442"><a href="#Channel.daylight_restriction-442"><span class="linenos">442</span></a><span class="sd">        - If the ship exceeds the limits, check if it is daytime at the time of entry.</span>
</span><span id="Channel.daylight_restriction-443"><a href="#Channel.daylight_restriction-443"><span class="linenos">443</span></a><span class="sd">        - If it is not daytime, return True (indicating daylight restriction).</span>
</span><span id="Channel.daylight_restriction-444"><a href="#Channel.daylight_restriction-444"><span class="linenos">444</span></a><span class="sd">        - If the ship does not exceed the limits or it is daytime, return False (indicating no daylight restriction).</span>
</span><span id="Channel.daylight_restriction-445"><a href="#Channel.daylight_restriction-445"><span class="linenos">445</span></a><span class="sd">        Args:</span>
</span><span id="Channel.daylight_restriction-446"><a href="#Channel.daylight_restriction-446"><span class="linenos">446</span></a><span class="sd">            ship_info (dict): Information about the ship, including its type, width, and length.</span>
</span><span id="Channel.daylight_restriction-447"><a href="#Channel.daylight_restriction-447"><span class="linenos">447</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.daylight_restriction-448"><a href="#Channel.daylight_restriction-448"><span class="linenos">448</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel.daylight_restriction-449"><a href="#Channel.daylight_restriction-449"><span class="linenos">449</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.daylight_restriction-450"><a href="#Channel.daylight_restriction-450"><span class="linenos">450</span></a><span class="sd">            bool: True if the ship has daylight restriction, False otherwise.</span>
</span><span id="Channel.daylight_restriction-451"><a href="#Channel.daylight_restriction-451"><span class="linenos">451</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.daylight_restriction-452"><a href="#Channel.daylight_restriction-452"><span class="linenos">452</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Container&#39;</span><span class="p">:</span>
</span><span id="Channel.daylight_restriction-453"><a href="#Channel.daylight_restriction-453"><span class="linenos">453</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
</span><span id="Channel.daylight_restriction-454"><a href="#Channel.daylight_restriction-454"><span class="linenos">454</span></a>                <span class="c1"># if not daytime return True</span>
</span><span id="Channel.daylight_restriction-455"><a href="#Channel.daylight_restriction-455"><span class="linenos">455</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="Channel.daylight_restriction-456"><a href="#Channel.daylight_restriction-456"><span class="linenos">456</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Liquid&#39;</span><span class="p">:</span>
</span><span id="Channel.daylight_restriction-457"><a href="#Channel.daylight_restriction-457"><span class="linenos">457</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">:</span>
</span><span id="Channel.daylight_restriction-458"><a href="#Channel.daylight_restriction-458"><span class="linenos">458</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="Channel.daylight_restriction-459"><a href="#Channel.daylight_restriction-459"><span class="linenos">459</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DryBulk&#39;</span><span class="p">:</span>
</span><span id="Channel.daylight_restriction-460"><a href="#Channel.daylight_restriction-460"><span class="linenos">460</span></a>            <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">120</span> <span class="ow">or</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">:</span>
</span><span id="Channel.daylight_restriction-461"><a href="#Channel.daylight_restriction-461"><span class="linenos">461</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">enter_time</span><span class="p">,</span> <span class="n">START_DAYLIGHT_RESTRICTION_HR</span><span class="p">,</span> <span class="n">STOP_DAYLIGHT_RESTRICTION_HR</span><span class="p">)</span>
</span><span id="Channel.daylight_restriction-462"><a href="#Channel.daylight_restriction-462"><span class="linenos">462</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check if the ship has daylight restriction in the channel at a given time step.
Logic:</p>

<ul>
<li>Check the ship's type and dimensions (width and length).</li>
<li>If the ship is a Container, Liquid, or DryBulk type, check if its width or length exceeds the specified limits.</li>
<li>If the ship exceeds the limits, check if it is daytime at the time of entry.</li>
<li>If it is not daytime, return True (indicating daylight restriction).</li>
<li>If the ship does not exceed the limits or it is daytime, return False (indicating no daylight restriction).</li>
</ul>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its type, width, and length.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>enter_time (int):</strong>  The time step when the ship enters the channel.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the ship has daylight restriction, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.scheduler" class="classattr">
                                        <input id="Channel.scheduler-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">scheduler</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">lastSection</span>, </span><span class="param"><span class="n">run_id</span>, </span><span class="param"><span class="n">enter_time</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.scheduler-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.scheduler"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.scheduler-464"><a href="#Channel.scheduler-464"><span class="linenos">464</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scheduler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">enter_time</span><span class="p">):</span>
</span><span id="Channel.scheduler-465"><a href="#Channel.scheduler-465"><span class="linenos">465</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.scheduler-466"><a href="#Channel.scheduler-466"><span class="linenos">466</span></a><span class="sd">        Schedule the ship to navigate through the channel. This happens before the ship actually moves through the channel.</span>
</span><span id="Channel.scheduler-467"><a href="#Channel.scheduler-467"><span class="linenos">467</span></a><span class="sd">        Logic:</span>
</span><span id="Channel.scheduler-468"><a href="#Channel.scheduler-468"><span class="linenos">468</span></a><span class="sd">        - Check if the ship has any restrictions in the channel (beam, draft, daylight, minimal spacing).</span>
</span><span id="Channel.scheduler-469"><a href="#Channel.scheduler-469"><span class="linenos">469</span></a><span class="sd">        - If there are any restrictions, log the ship&#39;s information and return.</span>
</span><span id="Channel.scheduler-470"><a href="#Channel.scheduler-470"><span class="linenos">470</span></a><span class="sd">        - If there are no restrictions, update the ship&#39;s logs and schedule the ship to move through the channel.</span>
</span><span id="Channel.scheduler-471"><a href="#Channel.scheduler-471"><span class="linenos">471</span></a><span class="sd">        - If the ship is entering the channel, update the usage of each section in the channel.</span>
</span><span id="Channel.scheduler-472"><a href="#Channel.scheduler-472"><span class="linenos">472</span></a><span class="sd">        - If the ship is leaving the channel, update the usage of each section in reverse order.</span>
</span><span id="Channel.scheduler-473"><a href="#Channel.scheduler-473"><span class="linenos">473</span></a><span class="sd">        - Log the ship&#39;s movement through the channel.</span>
</span><span id="Channel.scheduler-474"><a href="#Channel.scheduler-474"><span class="linenos">474</span></a><span class="sd">        - Finally, yield the ship&#39;s movement through the channel.</span>
</span><span id="Channel.scheduler-475"><a href="#Channel.scheduler-475"><span class="linenos">475</span></a><span class="sd">        Note this is different from the move_through_channel method, which is called when the ship actually moves through the channel.</span>
</span><span id="Channel.scheduler-476"><a href="#Channel.scheduler-476"><span class="linenos">476</span></a><span class="sd">        The scheduler method is called as soon as the ship requests to enter the channel.</span>
</span><span id="Channel.scheduler-477"><a href="#Channel.scheduler-477"><span class="linenos">477</span></a><span class="sd">        If the ship has any restrictions, it will not be scheduled to move through the channel.</span>
</span><span id="Channel.scheduler-478"><a href="#Channel.scheduler-478"><span class="linenos">478</span></a><span class="sd">        Args:</span>
</span><span id="Channel.scheduler-479"><a href="#Channel.scheduler-479"><span class="linenos">479</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, width, draft, and speed.</span>
</span><span id="Channel.scheduler-480"><a href="#Channel.scheduler-480"><span class="linenos">480</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.scheduler-481"><a href="#Channel.scheduler-481"><span class="linenos">481</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="Channel.scheduler-482"><a href="#Channel.scheduler-482"><span class="linenos">482</span></a><span class="sd">            enter_time (int): The time step when the ship enters the channel.</span>
</span><span id="Channel.scheduler-483"><a href="#Channel.scheduler-483"><span class="linenos">483</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.scheduler-484"><a href="#Channel.scheduler-484"><span class="linenos">484</span></a><span class="sd">            None</span>
</span><span id="Channel.scheduler-485"><a href="#Channel.scheduler-485"><span class="linenos">485</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.scheduler-486"><a href="#Channel.scheduler-486"><span class="linenos">486</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.scheduler-487"><a href="#Channel.scheduler-487"><span class="linenos">487</span></a>
</span><span id="Channel.scheduler-488"><a href="#Channel.scheduler-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel.scheduler-489"><a href="#Channel.scheduler-489"><span class="linenos">489</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel.scheduler-490"><a href="#Channel.scheduler-490"><span class="linenos">490</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.scheduler-491"><a href="#Channel.scheduler-491"><span class="linenos">491</span></a>                    <span class="k">break</span>
</span><span id="Channel.scheduler-492"><a href="#Channel.scheduler-492"><span class="linenos">492</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.scheduler-493"><a href="#Channel.scheduler-493"><span class="linenos">493</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.scheduler-494"><a href="#Channel.scheduler-494"><span class="linenos">494</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">update_usage</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
</span><span id="Channel.scheduler-495"><a href="#Channel.scheduler-495"><span class="linenos">495</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">space_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">)</span>
</span><span id="Channel.scheduler-496"><a href="#Channel.scheduler-496"><span class="linenos">496</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.scheduler-497"><a href="#Channel.scheduler-497"><span class="linenos">497</span></a>
</span><span id="Channel.scheduler-498"><a href="#Channel.scheduler-498"><span class="linenos">498</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel.scheduler-499"><a href="#Channel.scheduler-499"><span class="linenos">499</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel.scheduler-500"><a href="#Channel.scheduler-500"><span class="linenos">500</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel.scheduler-501"><a href="#Channel.scheduler-501"><span class="linenos">501</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.scheduler-502"><a href="#Channel.scheduler-502"><span class="linenos">502</span></a>                    <span class="k">continue</span>
</span><span id="Channel.scheduler-503"><a href="#Channel.scheduler-503"><span class="linenos">503</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.scheduler-504"><a href="#Channel.scheduler-504"><span class="linenos">504</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.scheduler-505"><a href="#Channel.scheduler-505"><span class="linenos">505</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">update_usage</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
</span><span id="Channel.scheduler-506"><a href="#Channel.scheduler-506"><span class="linenos">506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">section_number</span><span class="p">]</span><span class="o">.</span><span class="n">space_out</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">)</span>
</span><span id="Channel.scheduler-507"><a href="#Channel.scheduler-507"><span class="linenos">507</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span></pre></div>


            <div class="docstring"><p>Schedule the ship to navigate through the channel. This happens before the ship actually moves through the channel.
Logic:</p>

<ul>
<li>Check if the ship has any restrictions in the channel (beam, draft, daylight, minimal spacing).</li>
<li>If there are any restrictions, log the ship's information and return.</li>
<li>If there are no restrictions, update the ship's logs and schedule the ship to move through the channel.</li>
<li>If the ship is entering the channel, update the usage of each section in the channel.</li>
<li>If the ship is leaving the channel, update the usage of each section in reverse order.</li>
<li>Log the ship's movement through the channel.</li>
<li>Finally, yield the ship's movement through the channel.
Note this is different from the move_through_channel method, which is called when the ship actually moves through the channel.
The scheduler method is called as soon as the ship requests to enter the channel.
If the ship has any restrictions, it will not be scheduled to move through the channel.</li>
</ul>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its direction, width, draft, and speed.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>run_id (int):</strong>  The identifier for the current simulation run.</li>
<li><strong>enter_time (int):</strong>  The time step when the ship enters the channel.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.move_through_channel" class="classattr">
                                        <input id="Channel.move_through_channel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">move_through_channel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ship_info</span>, </span><span class="param"><span class="n">lastSection</span>, </span><span class="param"><span class="n">run_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.move_through_channel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.move_through_channel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.move_through_channel-509"><a href="#Channel.move_through_channel-509"><span class="linenos">509</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">move_through_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">):</span>
</span><span id="Channel.move_through_channel-510"><a href="#Channel.move_through_channel-510"><span class="linenos">510</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.move_through_channel-511"><a href="#Channel.move_through_channel-511"><span class="linenos">511</span></a><span class="sd">        Simulate the movement of the ship through the channel.</span>
</span><span id="Channel.move_through_channel-512"><a href="#Channel.move_through_channel-512"><span class="linenos">512</span></a><span class="sd">        Logic:</span>
</span><span id="Channel.move_through_channel-513"><a href="#Channel.move_through_channel-513"><span class="linenos">513</span></a><span class="sd">        - If the ship is entering the channel, iterate through each section from the start to the last section.</span>
</span><span id="Channel.move_through_channel-514"><a href="#Channel.move_through_channel-514"><span class="linenos">514</span></a><span class="sd">        - If the ship is leaving the channel, iterate through each section from the last section to the start.</span>
</span><span id="Channel.move_through_channel-515"><a href="#Channel.move_through_channel-515"><span class="linenos">515</span></a><span class="sd">        - For each section, calculate the speed and end time based on the ship&#39;s speed and length of the section.</span>
</span><span id="Channel.move_through_channel-516"><a href="#Channel.move_through_channel-516"><span class="linenos">516</span></a><span class="sd">        - Log the ship&#39;s movement through the section, including its ship_id, ship_type, width, draft, and direction.</span>
</span><span id="Channel.move_through_channel-517"><a href="#Channel.move_through_channel-517"><span class="linenos">517</span></a><span class="sd">        - Yield the ship&#39;s movement through the section.</span>
</span><span id="Channel.move_through_channel-518"><a href="#Channel.move_through_channel-518"><span class="linenos">518</span></a><span class="sd">        - Log the time spent in each section.</span>
</span><span id="Channel.move_through_channel-519"><a href="#Channel.move_through_channel-519"><span class="linenos">519</span></a><span class="sd">        - Finally, update the ship&#39;s logs with the time spent in the channel.</span>
</span><span id="Channel.move_through_channel-520"><a href="#Channel.move_through_channel-520"><span class="linenos">520</span></a><span class="sd">        - If the ship is entering the channel, log the time spent in each section going in.</span>
</span><span id="Channel.move_through_channel-521"><a href="#Channel.move_through_channel-521"><span class="linenos">521</span></a><span class="sd">        - If the ship is leaving the channel, log the time spent in each section going out.</span>
</span><span id="Channel.move_through_channel-522"><a href="#Channel.move_through_channel-522"><span class="linenos">522</span></a><span class="sd">        Note this is different from the scheduler method,which schedules before the ship actually moves through the channel.</span>
</span><span id="Channel.move_through_channel-523"><a href="#Channel.move_through_channel-523"><span class="linenos">523</span></a><span class="sd">        The sheduler happens as soon as the ship requests to enter the channel.</span>
</span><span id="Channel.move_through_channel-524"><a href="#Channel.move_through_channel-524"><span class="linenos">524</span></a><span class="sd">        The move_through_channel method is called when the ship actually moves through the channel (when there are no restrictions).</span>
</span><span id="Channel.move_through_channel-525"><a href="#Channel.move_through_channel-525"><span class="linenos">525</span></a><span class="sd">        Args:</span>
</span><span id="Channel.move_through_channel-526"><a href="#Channel.move_through_channel-526"><span class="linenos">526</span></a><span class="sd">            ship_info (dict): Information about the ship, including its ship_id, ship_type, width, draft, and direction.</span>
</span><span id="Channel.move_through_channel-527"><a href="#Channel.move_through_channel-527"><span class="linenos">527</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.move_through_channel-528"><a href="#Channel.move_through_channel-528"><span class="linenos">528</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="Channel.move_through_channel-529"><a href="#Channel.move_through_channel-529"><span class="linenos">529</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.move_through_channel-530"><a href="#Channel.move_through_channel-530"><span class="linenos">530</span></a><span class="sd">            None</span>
</span><span id="Channel.move_through_channel-531"><a href="#Channel.move_through_channel-531"><span class="linenos">531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.move_through_channel-532"><a href="#Channel.move_through_channel-532"><span class="linenos">532</span></a>        <span class="n">enter_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.move_through_channel-533"><a href="#Channel.move_through_channel-533"><span class="linenos">533</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">enter_time</span>
</span><span id="Channel.move_through_channel-534"><a href="#Channel.move_through_channel-534"><span class="linenos">534</span></a>
</span><span id="Channel.move_through_channel-535"><a href="#Channel.move_through_channel-535"><span class="linenos">535</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel.move_through_channel-536"><a href="#Channel.move_through_channel-536"><span class="linenos">536</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Channel.move_through_channel-537"><a href="#Channel.move_through_channel-537"><span class="linenos">537</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.move_through_channel-538"><a href="#Channel.move_through_channel-538"><span class="linenos">538</span></a>                    <span class="k">break</span>
</span><span id="Channel.move_through_channel-539"><a href="#Channel.move_through_channel-539"><span class="linenos">539</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.move_through_channel-540"><a href="#Channel.move_through_channel-540"><span class="linenos">540</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.move_through_channel-541"><a href="#Channel.move_through_channel-541"><span class="linenos">541</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span><span class="p">)</span>
</span><span id="Channel.move_through_channel-542"><a href="#Channel.move_through_channel-542"><span class="linenos">542</span></a>                <span class="n">log_line</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot;ships_in_channel.txt&quot;</span><span class="p">,</span>
</span><span id="Channel.move_through_channel-543"><a href="#Channel.move_through_channel-543"><span class="linenos">543</span></a>                         <span class="sa">f</span><span class="s2">&quot;Ship </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of width </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> and draft </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> spent from </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_time</span><span class="si">}</span><span class="s2"> in section </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> going in&quot;</span><span class="p">)</span>
</span><span id="Channel.move_through_channel-544"><a href="#Channel.move_through_channel-544"><span class="linenos">544</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span><span id="Channel.move_through_channel-545"><a href="#Channel.move_through_channel-545"><span class="linenos">545</span></a>
</span><span id="Channel.move_through_channel-546"><a href="#Channel.move_through_channel-546"><span class="linenos">546</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel.move_through_channel-547"><a href="#Channel.move_through_channel-547"><span class="linenos">547</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)):</span>
</span><span id="Channel.move_through_channel-548"><a href="#Channel.move_through_channel-548"><span class="linenos">548</span></a>                <span class="n">section_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel.move_through_channel-549"><a href="#Channel.move_through_channel-549"><span class="linenos">549</span></a>                <span class="k">if</span> <span class="n">section_number</span> <span class="o">&gt;</span> <span class="n">lastSection</span><span class="p">:</span>
</span><span id="Channel.move_through_channel-550"><a href="#Channel.move_through_channel-550"><span class="linenos">550</span></a>                    <span class="k">continue</span>
</span><span id="Channel.move_through_channel-551"><a href="#Channel.move_through_channel-551"><span class="linenos">551</span></a>                <span class="n">speed</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">speed</span>
</span><span id="Channel.move_through_channel-552"><a href="#Channel.move_through_channel-552"><span class="linenos">552</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span>
</span><span id="Channel.move_through_channel-553"><a href="#Channel.move_through_channel-553"><span class="linenos">553</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">speed</span><span class="p">)</span>
</span><span id="Channel.move_through_channel-554"><a href="#Channel.move_through_channel-554"><span class="linenos">554</span></a>                <span class="n">log_line</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot;ships_in_channel.txt&quot;</span><span class="p">,</span>
</span><span id="Channel.move_through_channel-555"><a href="#Channel.move_through_channel-555"><span class="linenos">555</span></a>                         <span class="sa">f</span><span class="s2">&quot;Ship </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;ship_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> of width </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> and draft </span><span class="si">{</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;draft&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> spent from </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_time</span><span class="si">}</span><span class="s2"> in section </span><span class="si">{</span><span class="n">section_number</span><span class="si">}</span><span class="s2"> going out&quot;</span><span class="p">)</span>
</span><span id="Channel.move_through_channel-556"><a href="#Channel.move_through_channel-556"><span class="linenos">556</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">end_time</span>
</span></pre></div>


            <div class="docstring"><p>Simulate the movement of the ship through the channel.
Logic:</p>

<ul>
<li>If the ship is entering the channel, iterate through each section from the start to the last section.</li>
<li>If the ship is leaving the channel, iterate through each section from the last section to the start.</li>
<li>For each section, calculate the speed and end time based on the ship's speed and length of the section.</li>
<li>Log the ship's movement through the section, including its ship_id, ship_type, width, draft, and direction.</li>
<li>Yield the ship's movement through the section.</li>
<li>Log the time spent in each section.</li>
<li>Finally, update the ship's logs with the time spent in the channel.</li>
<li>If the ship is entering the channel, log the time spent in each section going in.</li>
<li>If the ship is leaving the channel, log the time spent in each section going out.
Note this is different from the scheduler method,which schedules before the ship actually moves through the channel.
The sheduler happens as soon as the ship requests to enter the channel.
The move_through_channel method is called when the ship actually moves through the channel (when there are no restrictions).</li>
</ul>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its ship_id, ship_type, width, draft, and direction.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>run_id (int):</strong>  The identifier for the current simulation run.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.check_restrictions" class="classattr">
                                        <input id="Channel.check_restrictions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_restrictions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ship_info</span>,</span><span class="param">	<span class="n">lastSection</span>,</span><span class="param">	<span class="n">request_time</span>,</span><span class="param">	<span class="n">wait_beam</span>,</span><span class="param">	<span class="n">wait_draft</span>,</span><span class="param">	<span class="n">wait_daylight</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.check_restrictions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.check_restrictions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.check_restrictions-558"><a href="#Channel.check_restrictions-558"><span class="linenos">558</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_restrictions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">):</span>
</span><span id="Channel.check_restrictions-559"><a href="#Channel.check_restrictions-559"><span class="linenos">559</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.check_restrictions-560"><a href="#Channel.check_restrictions-560"><span class="linenos">560</span></a><span class="sd">        Check if the ship has any restrictions in the channel at a given time step.</span>
</span><span id="Channel.check_restrictions-561"><a href="#Channel.check_restrictions-561"><span class="linenos">561</span></a><span class="sd">        Args:</span>
</span><span id="Channel.check_restrictions-562"><a href="#Channel.check_restrictions-562"><span class="linenos">562</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, width, draft, and ship type.</span>
</span><span id="Channel.check_restrictions-563"><a href="#Channel.check_restrictions-563"><span class="linenos">563</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.check_restrictions-564"><a href="#Channel.check_restrictions-564"><span class="linenos">564</span></a><span class="sd">            request_time (int): The time step when the ship requests to enter the channel.</span>
</span><span id="Channel.check_restrictions-565"><a href="#Channel.check_restrictions-565"><span class="linenos">565</span></a><span class="sd">            wait_beam (int): The number of time steps the ship has waited for beam restrictions.</span>
</span><span id="Channel.check_restrictions-566"><a href="#Channel.check_restrictions-566"><span class="linenos">566</span></a><span class="sd">            wait_draft (int): The number of time steps the ship has waited for draft restrictions.</span>
</span><span id="Channel.check_restrictions-567"><a href="#Channel.check_restrictions-567"><span class="linenos">567</span></a><span class="sd">            wait_daylight (int): The number of time steps the ship has waited for daylight restrictions.</span>
</span><span id="Channel.check_restrictions-568"><a href="#Channel.check_restrictions-568"><span class="linenos">568</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.check_restrictions-569"><a href="#Channel.check_restrictions-569"><span class="linenos">569</span></a><span class="sd">            tuple: A tuple containing:</span>
</span><span id="Channel.check_restrictions-570"><a href="#Channel.check_restrictions-570"><span class="linenos">570</span></a><span class="sd">                - restrictions (bool): True if there are any restrictions, False otherwise.</span>
</span><span id="Channel.check_restrictions-571"><a href="#Channel.check_restrictions-571"><span class="linenos">571</span></a><span class="sd">                - wait_beam (int): The updated number of time steps the ship has waited for beam restrictions.</span>
</span><span id="Channel.check_restrictions-572"><a href="#Channel.check_restrictions-572"><span class="linenos">572</span></a><span class="sd">                - wait_draft (int): The updated number of time steps the ship has waited for draft restrictions.</span>
</span><span id="Channel.check_restrictions-573"><a href="#Channel.check_restrictions-573"><span class="linenos">573</span></a><span class="sd">                - wait_daylight (int): The updated number of time steps the ship has waited for daylight restrictions.</span>
</span><span id="Channel.check_restrictions-574"><a href="#Channel.check_restrictions-574"><span class="linenos">574</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.check_restrictions-575"><a href="#Channel.check_restrictions-575"><span class="linenos">575</span></a>        <span class="n">channel_closed_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed_restriction</span><span class="p">(</span>
</span><span id="Channel.check_restrictions-576"><a href="#Channel.check_restrictions-576"><span class="linenos">576</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.check_restrictions-577"><a href="#Channel.check_restrictions-577"><span class="linenos">577</span></a>        <span class="n">beam_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_restriction</span><span class="p">(</span>
</span><span id="Channel.check_restrictions-578"><a href="#Channel.check_restrictions-578"><span class="linenos">578</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.check_restrictions-579"><a href="#Channel.check_restrictions-579"><span class="linenos">579</span></a>        <span class="n">draft_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draft_restriction</span><span class="p">(</span>
</span><span id="Channel.check_restrictions-580"><a href="#Channel.check_restrictions-580"><span class="linenos">580</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.check_restrictions-581"><a href="#Channel.check_restrictions-581"><span class="linenos">581</span></a>        <span class="n">daylight_restriction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daylight_restriction</span><span class="p">(</span>
</span><span id="Channel.check_restrictions-582"><a href="#Channel.check_restrictions-582"><span class="linenos">582</span></a>            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.check_restrictions-583"><a href="#Channel.check_restrictions-583"><span class="linenos">583</span></a>
</span><span id="Channel.check_restrictions-584"><a href="#Channel.check_restrictions-584"><span class="linenos">584</span></a>        <span class="k">if</span> <span class="n">beam_restriction</span><span class="p">:</span>
</span><span id="Channel.check_restrictions-585"><a href="#Channel.check_restrictions-585"><span class="linenos">585</span></a>            <span class="n">wait_beam</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.check_restrictions-586"><a href="#Channel.check_restrictions-586"><span class="linenos">586</span></a>        <span class="k">if</span> <span class="n">draft_restriction</span><span class="p">:</span>
</span><span id="Channel.check_restrictions-587"><a href="#Channel.check_restrictions-587"><span class="linenos">587</span></a>            <span class="n">wait_draft</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.check_restrictions-588"><a href="#Channel.check_restrictions-588"><span class="linenos">588</span></a>        <span class="k">if</span> <span class="n">daylight_restriction</span><span class="p">:</span>
</span><span id="Channel.check_restrictions-589"><a href="#Channel.check_restrictions-589"><span class="linenos">589</span></a>            <span class="n">wait_daylight</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.check_restrictions-590"><a href="#Channel.check_restrictions-590"><span class="linenos">590</span></a>
</span><span id="Channel.check_restrictions-591"><a href="#Channel.check_restrictions-591"><span class="linenos">591</span></a>        <span class="n">restrictions</span> <span class="o">=</span> <span class="n">beam_restriction</span> <span class="ow">or</span> <span class="n">draft_restriction</span> <span class="ow">or</span> <span class="n">daylight_restriction</span> <span class="ow">or</span> <span class="n">channel_closed_restriction</span>
</span><span id="Channel.check_restrictions-592"><a href="#Channel.check_restrictions-592"><span class="linenos">592</span></a>
</span><span id="Channel.check_restrictions-593"><a href="#Channel.check_restrictions-593"><span class="linenos">593</span></a>        <span class="k">return</span> <span class="n">restrictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span>
</span></pre></div>


            <div class="docstring"><p>Check if the ship has any restrictions in the channel at a given time step.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its direction, width, draft, and ship type.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>request_time (int):</strong>  The time step when the ship requests to enter the channel.</li>
<li><strong>wait_beam (int):</strong>  The number of time steps the ship has waited for beam restrictions.</li>
<li><strong>wait_draft (int):</strong>  The number of time steps the ship has waited for draft restrictions.</li>
<li><strong>wait_daylight (int):</strong>  The number of time steps the ship has waited for daylight restrictions.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>tuple: A tuple containing:
      - restrictions (bool): True if there are any restrictions, False otherwise.
      - wait_beam (int): The updated number of time steps the ship has waited for beam restrictions.
      - wait_draft (int): The updated number of time steps the ship has waited for draft restrictions.
      - wait_daylight (int): The updated number of time steps the ship has waited for daylight restrictions.</p>
</blockquote>
</div>


                            </div>
                            <div id="Channel.channel_process" class="classattr">
                                        <input id="Channel.channel_process-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">channel_process</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ship_info</span>,</span><span class="param">	<span class="n">day</span>,</span><span class="param">	<span class="n">lastSection</span>,</span><span class="param">	<span class="n">ship_id</span>,</span><span class="param">	<span class="n">ship_terminal</span>,</span><span class="param">	<span class="n">ship_type</span>,</span><span class="param">	<span class="n">run_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Channel.channel_process-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Channel.channel_process"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Channel.channel_process-595"><a href="#Channel.channel_process-595"><span class="linenos">595</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">channel_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ship_info</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">run_id</span><span class="p">):</span>
</span><span id="Channel.channel_process-596"><a href="#Channel.channel_process-596"><span class="linenos">596</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Channel.channel_process-597"><a href="#Channel.channel_process-597"><span class="linenos">597</span></a><span class="sd">        Process for handling the ship&#39;s entry into the channel.</span>
</span><span id="Channel.channel_process-598"><a href="#Channel.channel_process-598"><span class="linenos">598</span></a><span class="sd">        It handles the scheduling and movement of the ship through the channel, including checking for restrictions and logging the ship&#39;s information.</span>
</span><span id="Channel.channel_process-599"><a href="#Channel.channel_process-599"><span class="linenos">599</span></a><span class="sd">        The process has the following steps:</span>
</span><span id="Channel.channel_process-600"><a href="#Channel.channel_process-600"><span class="linenos">600</span></a><span class="sd">        1. Check if the ship is entering or leaving the channel based on its direction.</span>
</span><span id="Channel.channel_process-601"><a href="#Channel.channel_process-601"><span class="linenos">601</span></a><span class="sd">        2. If the ship is entering the channel, then:</span>
</span><span id="Channel.channel_process-602"><a href="#Channel.channel_process-602"><span class="linenos">602</span></a><span class="sd">            2.1. Get the pilots based on the time of day (day or night).</span>
</span><span id="Channel.channel_process-603"><a href="#Channel.channel_process-603"><span class="linenos">603</span></a><span class="sd">            2.2. Check when the ship is allowed to enter being free of restrictions.</span>
</span><span id="Channel.channel_process-604"><a href="#Channel.channel_process-604"><span class="linenos">604</span></a><span class="sd">            2.3 Schedule the ship to move through the channel.</span>
</span><span id="Channel.channel_process-605"><a href="#Channel.channel_process-605"><span class="linenos">605</span></a><span class="sd">            2.4 Wait till the ship can move through the channel.</span>
</span><span id="Channel.channel_process-606"><a href="#Channel.channel_process-606"><span class="linenos">606</span></a><span class="sd">            2.5 Move the ship through the channel.</span>
</span><span id="Channel.channel_process-607"><a href="#Channel.channel_process-607"><span class="linenos">607</span></a><span class="sd">            2.6 Get the tugboats and steer the ship.</span>
</span><span id="Channel.channel_process-608"><a href="#Channel.channel_process-608"><span class="linenos">608</span></a><span class="sd">        3. If the ship is leaving the channel, then:</span>
</span><span id="Channel.channel_process-609"><a href="#Channel.channel_process-609"><span class="linenos">609</span></a><span class="sd">            3.1. Get the pilots based on the time of day (day or night).</span>
</span><span id="Channel.channel_process-610"><a href="#Channel.channel_process-610"><span class="linenos">610</span></a><span class="sd">            3.2 Get the tugboats and steer the ship.</span>
</span><span id="Channel.channel_process-611"><a href="#Channel.channel_process-611"><span class="linenos">611</span></a><span class="sd">            3.3.Check when the ship is allowed to leave being free of restrictions.</span>
</span><span id="Channel.channel_process-612"><a href="#Channel.channel_process-612"><span class="linenos">612</span></a><span class="sd">            3.4 Schedule the ship to move through the channel.</span>
</span><span id="Channel.channel_process-613"><a href="#Channel.channel_process-613"><span class="linenos">613</span></a><span class="sd">            3.5 Wait till the ship can move through the channel.</span>
</span><span id="Channel.channel_process-614"><a href="#Channel.channel_process-614"><span class="linenos">614</span></a><span class="sd">            3.6 Move the ship through the channel.</span>
</span><span id="Channel.channel_process-615"><a href="#Channel.channel_process-615"><span class="linenos">615</span></a><span class="sd">        Args:</span>
</span><span id="Channel.channel_process-616"><a href="#Channel.channel_process-616"><span class="linenos">616</span></a><span class="sd">            ship_info (dict): Information about the ship, including its direction, pilots, tugboats, and other attributes.</span>
</span><span id="Channel.channel_process-617"><a href="#Channel.channel_process-617"><span class="linenos">617</span></a><span class="sd">            day (bool): Whether it is daytime or nighttime.</span>
</span><span id="Channel.channel_process-618"><a href="#Channel.channel_process-618"><span class="linenos">618</span></a><span class="sd">            lastSection (int): The last section of the channel to check.</span>
</span><span id="Channel.channel_process-619"><a href="#Channel.channel_process-619"><span class="linenos">619</span></a><span class="sd">            ship_id (int): The identifier for the ship.</span>
</span><span id="Channel.channel_process-620"><a href="#Channel.channel_process-620"><span class="linenos">620</span></a><span class="sd">            ship_terminal (str): The terminal where the ship is headed.</span>
</span><span id="Channel.channel_process-621"><a href="#Channel.channel_process-621"><span class="linenos">621</span></a><span class="sd">            ship_type (str): The type of the ship (e.g., Container, Liquid, DryBulk).</span>
</span><span id="Channel.channel_process-622"><a href="#Channel.channel_process-622"><span class="linenos">622</span></a><span class="sd">            run_id (int): The identifier for the current simulation run.</span>
</span><span id="Channel.channel_process-623"><a href="#Channel.channel_process-623"><span class="linenos">623</span></a><span class="sd">        Returns:</span>
</span><span id="Channel.channel_process-624"><a href="#Channel.channel_process-624"><span class="linenos">624</span></a><span class="sd">            None</span>
</span><span id="Channel.channel_process-625"><a href="#Channel.channel_process-625"><span class="linenos">625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Channel.channel_process-626"><a href="#Channel.channel_process-626"><span class="linenos">626</span></a>        <span class="n">lastSection</span> <span class="o">=</span> <span class="n">lastSection</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-627"><a href="#Channel.channel_process-627"><span class="linenos">627</span></a>        <span class="n">request_time_initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-628"><a href="#Channel.channel_process-628"><span class="linenos">628</span></a>
</span><span id="Channel.channel_process-629"><a href="#Channel.channel_process-629"><span class="linenos">629</span></a>        <span class="n">inbound_closed_tuples</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">INBOUND_CLOSED</span>
</span><span id="Channel.channel_process-630"><a href="#Channel.channel_process-630"><span class="linenos">630</span></a>        <span class="n">outbound_closed_tuples</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">OUTBOUND_CLOSED</span>
</span><span id="Channel.channel_process-631"><a href="#Channel.channel_process-631"><span class="linenos">631</span></a>
</span><span id="Channel.channel_process-632"><a href="#Channel.channel_process-632"><span class="linenos">632</span></a>        <span class="n">wait_queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">request_time_initial</span>
</span><span id="Channel.channel_process-633"><a href="#Channel.channel_process-633"><span class="linenos">633</span></a>
</span><span id="Channel.channel_process-634"><a href="#Channel.channel_process-634"><span class="linenos">634</span></a>        <span class="c1"># If ship travels in</span>
</span><span id="Channel.channel_process-635"><a href="#Channel.channel_process-635"><span class="linenos">635</span></a>        <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
</span><span id="Channel.channel_process-636"><a href="#Channel.channel_process-636"><span class="linenos">636</span></a>            <span class="n">ship_entering_channel_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-637"><a href="#Channel.channel_process-637"><span class="linenos">637</span></a>
</span><span id="Channel.channel_process-638"><a href="#Channel.channel_process-638"><span class="linenos">638</span></a>            <span class="c1"># get pilots</span>
</span><span id="Channel.channel_process-639"><a href="#Channel.channel_process-639"><span class="linenos">639</span></a>            <span class="n">day</span> <span class="o">=</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">ship_entering_channel_time</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
</span><span id="Channel.channel_process-640"><a href="#Channel.channel_process-640"><span class="linenos">640</span></a>
</span><span id="Channel.channel_process-641"><a href="#Channel.channel_process-641"><span class="linenos">641</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel.channel_process-642"><a href="#Channel.channel_process-642"><span class="linenos">642</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-643"><a href="#Channel.channel_process-643"><span class="linenos">643</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel.channel_process-644"><a href="#Channel.channel_process-644"><span class="linenos">644</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-645"><a href="#Channel.channel_process-645"><span class="linenos">645</span></a>            <span class="n">time_to_get_pilot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">ship_entering_channel_time</span>
</span><span id="Channel.channel_process-646"><a href="#Channel.channel_process-646"><span class="linenos">646</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-647"><a href="#Channel.channel_process-647"><span class="linenos">647</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_pilot_in</span><span class="o">=</span><span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel.channel_process-648"><a href="#Channel.channel_process-648"><span class="linenos">648</span></a>
</span><span id="Channel.channel_process-649"><a href="#Channel.channel_process-649"><span class="linenos">649</span></a>            <span class="c1"># travel anchorage to mouth of the channel</span>
</span><span id="Channel.channel_process-650"><a href="#Channel.channel_process-650"><span class="linenos">650</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel.channel_process-651"><a href="#Channel.channel_process-651"><span class="linenos">651</span></a>                <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel.channel_process-652"><a href="#Channel.channel_process-652"><span class="linenos">652</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel.channel_process-653"><a href="#Channel.channel_process-653"><span class="linenos">653</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="Channel.channel_process-654"><a href="#Channel.channel_process-654"><span class="linenos">654</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel.channel_process-655"><a href="#Channel.channel_process-655"><span class="linenos">655</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel.channel_process-656"><a href="#Channel.channel_process-656"><span class="linenos">656</span></a>                             <span class="n">time_to_common_channel_in</span><span class="o">=</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel.channel_process-657"><a href="#Channel.channel_process-657"><span class="linenos">657</span></a>
</span><span id="Channel.channel_process-658"><a href="#Channel.channel_process-658"><span class="linenos">658</span></a>            <span class="c1"># Schedule the ship to move through the channel</span>
</span><span id="Channel.channel_process-659"><a href="#Channel.channel_process-659"><span class="linenos">659</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
</span><span id="Channel.channel_process-660"><a href="#Channel.channel_process-660"><span class="linenos">660</span></a>                <span class="k">yield</span> <span class="n">request</span>
</span><span id="Channel.channel_process-661"><a href="#Channel.channel_process-661"><span class="linenos">661</span></a>
</span><span id="Channel.channel_process-662"><a href="#Channel.channel_process-662"><span class="linenos">662</span></a>                <span class="n">request_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-663"><a href="#Channel.channel_process-663"><span class="linenos">663</span></a>                <span class="n">wait_daylight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-664"><a href="#Channel.channel_process-664"><span class="linenos">664</span></a>                <span class="n">wait_beam</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-665"><a href="#Channel.channel_process-665"><span class="linenos">665</span></a>                <span class="n">wait_draft</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-666"><a href="#Channel.channel_process-666"><span class="linenos">666</span></a>                <span class="c1"># Note that multiple restrictions can be active at the same time</span>
</span><span id="Channel.channel_process-667"><a href="#Channel.channel_process-667"><span class="linenos">667</span></a>                <span class="n">wait_total_restriction</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-668"><a href="#Channel.channel_process-668"><span class="linenos">668</span></a>                <span class="n">wait_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-669"><a href="#Channel.channel_process-669"><span class="linenos">669</span></a>
</span><span id="Channel.channel_process-670"><a href="#Channel.channel_process-670"><span class="linenos">670</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">:</span>
</span><span id="Channel.channel_process-671"><a href="#Channel.channel_process-671"><span class="linenos">671</span></a>                    <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel.channel_process-672"><a href="#Channel.channel_process-672"><span class="linenos">672</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel.channel_process-673"><a href="#Channel.channel_process-673"><span class="linenos">673</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-674"><a href="#Channel.channel_process-674"><span class="linenos">674</span></a>                    <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-675"><a href="#Channel.channel_process-675"><span class="linenos">675</span></a>
</span><span id="Channel.channel_process-676"><a href="#Channel.channel_process-676"><span class="linenos">676</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-677"><a href="#Channel.channel_process-677"><span class="linenos">677</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-678"><a href="#Channel.channel_process-678"><span class="linenos">678</span></a>                            <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-679"><a href="#Channel.channel_process-679"><span class="linenos">679</span></a>
</span><span id="Channel.channel_process-680"><a href="#Channel.channel_process-680"><span class="linenos">680</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-681"><a href="#Channel.channel_process-681"><span class="linenos">681</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-682"><a href="#Channel.channel_process-682"><span class="linenos">682</span></a>
</span><span id="Channel.channel_process-683"><a href="#Channel.channel_process-683"><span class="linenos">683</span></a>                    <span class="k">while</span> <span class="n">restrcictions</span> <span class="ow">or</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_inbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel.channel_process-684"><a href="#Channel.channel_process-684"><span class="linenos">684</span></a>                        <span class="k">if</span> <span class="n">channel_closed_inbound</span><span class="p">:</span>
</span><span id="Channel.channel_process-685"><a href="#Channel.channel_process-685"><span class="linenos">685</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Channel closed inbound at time&quot;</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-686"><a href="#Channel.channel_process-686"><span class="linenos">686</span></a>
</span><span id="Channel.channel_process-687"><a href="#Channel.channel_process-687"><span class="linenos">687</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-688"><a href="#Channel.channel_process-688"><span class="linenos">688</span></a>                        <span class="n">wait_total_restriction</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-689"><a href="#Channel.channel_process-689"><span class="linenos">689</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-690"><a href="#Channel.channel_process-690"><span class="linenos">690</span></a>                        <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel.channel_process-691"><a href="#Channel.channel_process-691"><span class="linenos">691</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel.channel_process-692"><a href="#Channel.channel_process-692"><span class="linenos">692</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-693"><a href="#Channel.channel_process-693"><span class="linenos">693</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-694"><a href="#Channel.channel_process-694"><span class="linenos">694</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-695"><a href="#Channel.channel_process-695"><span class="linenos">695</span></a>                        <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-696"><a href="#Channel.channel_process-696"><span class="linenos">696</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-697"><a href="#Channel.channel_process-697"><span class="linenos">697</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-698"><a href="#Channel.channel_process-698"><span class="linenos">698</span></a>                                <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-699"><a href="#Channel.channel_process-699"><span class="linenos">699</span></a>
</span><span id="Channel.channel_process-700"><a href="#Channel.channel_process-700"><span class="linenos">700</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Channel.channel_process-701"><a href="#Channel.channel_process-701"><span class="linenos">701</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-702"><a href="#Channel.channel_process-702"><span class="linenos">702</span></a>
</span><span id="Channel.channel_process-703"><a href="#Channel.channel_process-703"><span class="linenos">703</span></a>                    <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-704"><a href="#Channel.channel_process-704"><span class="linenos">704</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-705"><a href="#Channel.channel_process-705"><span class="linenos">705</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-706"><a href="#Channel.channel_process-706"><span class="linenos">706</span></a>                            <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-707"><a href="#Channel.channel_process-707"><span class="linenos">707</span></a>
</span><span id="Channel.channel_process-708"><a href="#Channel.channel_process-708"><span class="linenos">708</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-709"><a href="#Channel.channel_process-709"><span class="linenos">709</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-710"><a href="#Channel.channel_process-710"><span class="linenos">710</span></a>
</span><span id="Channel.channel_process-711"><a href="#Channel.channel_process-711"><span class="linenos">711</span></a>                    <span class="k">while</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_inbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel.channel_process-712"><a href="#Channel.channel_process-712"><span class="linenos">712</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-713"><a href="#Channel.channel_process-713"><span class="linenos">713</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-714"><a href="#Channel.channel_process-714"><span class="linenos">714</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-715"><a href="#Channel.channel_process-715"><span class="linenos">715</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-716"><a href="#Channel.channel_process-716"><span class="linenos">716</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-717"><a href="#Channel.channel_process-717"><span class="linenos">717</span></a>                        <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-718"><a href="#Channel.channel_process-718"><span class="linenos">718</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">inbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-719"><a href="#Channel.channel_process-719"><span class="linenos">719</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-720"><a href="#Channel.channel_process-720"><span class="linenos">720</span></a>                                <span class="n">channel_closed_inbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-721"><a href="#Channel.channel_process-721"><span class="linenos">721</span></a>
</span><span id="Channel.channel_process-722"><a href="#Channel.channel_process-722"><span class="linenos">722</span></a>                <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel.channel_process-723"><a href="#Channel.channel_process-723"><span class="linenos">723</span></a>                                 <span class="n">time_for_restriction_in</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B:</span><span class="si">{</span><span class="n">wait_beam</span><span class="si">}</span><span class="s1">, D:</span><span class="si">{</span><span class="n">wait_draft</span><span class="si">}</span><span class="s1">, DL:</span><span class="si">{</span><span class="n">wait_daylight</span><span class="si">}</span><span class="s1">, Q:</span><span class="si">{</span><span class="n">wait_queue</span><span class="si">}</span><span class="s1">, T:</span><span class="si">{</span><span class="n">wait_total</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Channel.channel_process-724"><a href="#Channel.channel_process-724"><span class="linenos">724</span></a>
</span><span id="Channel.channel_process-725"><a href="#Channel.channel_process-725"><span class="linenos">725</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-726"><a href="#Channel.channel_process-726"><span class="linenos">726</span></a>                               <span class="n">enter_time</span><span class="o">=</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-727"><a href="#Channel.channel_process-727"><span class="linenos">727</span></a>
</span><span id="Channel.channel_process-728"><a href="#Channel.channel_process-728"><span class="linenos">728</span></a>            <span class="c1"># travel through the channel</span>
</span><span id="Channel.channel_process-729"><a href="#Channel.channel_process-729"><span class="linenos">729</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">request_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
</span><span id="Channel.channel_process-730"><a href="#Channel.channel_process-730"><span class="linenos">730</span></a>            <span class="n">time_entered_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-731"><a href="#Channel.channel_process-731"><span class="linenos">731</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move_through_channel</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">))</span>
</span><span id="Channel.channel_process-732"><a href="#Channel.channel_process-732"><span class="linenos">732</span></a>            <span class="n">time_to_travel_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_entered_channel</span>
</span><span id="Channel.channel_process-733"><a href="#Channel.channel_process-733"><span class="linenos">733</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel.channel_process-734"><a href="#Channel.channel_process-734"><span class="linenos">734</span></a>                             <span class="n">time_to_travel_channel_in</span><span class="o">=</span><span class="n">time_to_travel_channel</span><span class="p">)</span>
</span><span id="Channel.channel_process-735"><a href="#Channel.channel_process-735"><span class="linenos">735</span></a>
</span><span id="Channel.channel_process-736"><a href="#Channel.channel_process-736"><span class="linenos">736</span></a>            <span class="c1"># get tugs</span>
</span><span id="Channel.channel_process-737"><a href="#Channel.channel_process-737"><span class="linenos">737</span></a>            <span class="n">time_tug_req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-738"><a href="#Channel.channel_process-738"><span class="linenos">738</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-739"><a href="#Channel.channel_process-739"><span class="linenos">739</span></a>            <span class="n">time_to_get_tugs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_tug_req</span>
</span><span id="Channel.channel_process-740"><a href="#Channel.channel_process-740"><span class="linenos">740</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-741"><a href="#Channel.channel_process-741"><span class="linenos">741</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_tugs_in</span><span class="o">=</span><span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="Channel.channel_process-742"><a href="#Channel.channel_process-742"><span class="linenos">742</span></a>
</span><span id="Channel.channel_process-743"><a href="#Channel.channel_process-743"><span class="linenos">743</span></a>            <span class="c1"># steer the ship</span>
</span><span id="Channel.channel_process-744"><a href="#Channel.channel_process-744"><span class="linenos">744</span></a>            <span class="n">time_to_tug_steer</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel.channel_process-745"><a href="#Channel.channel_process-745"><span class="linenos">745</span></a>                <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel.channel_process-746"><a href="#Channel.channel_process-746"><span class="linenos">746</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel.channel_process-747"><a href="#Channel.channel_process-747"><span class="linenos">747</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-748"><a href="#Channel.channel_process-748"><span class="linenos">748</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_tug_steer_in</span><span class="o">=</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel.channel_process-749"><a href="#Channel.channel_process-749"><span class="linenos">749</span></a>
</span><span id="Channel.channel_process-750"><a href="#Channel.channel_process-750"><span class="linenos">750</span></a>            <span class="c1"># put the tugs back</span>
</span><span id="Channel.channel_process-751"><a href="#Channel.channel_process-751"><span class="linenos">751</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-752"><a href="#Channel.channel_process-752"><span class="linenos">752</span></a>
</span><span id="Channel.channel_process-753"><a href="#Channel.channel_process-753"><span class="linenos">753</span></a>            <span class="c1"># Release pilots</span>
</span><span id="Channel.channel_process-754"><a href="#Channel.channel_process-754"><span class="linenos">754</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel.channel_process-755"><a href="#Channel.channel_process-755"><span class="linenos">755</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-756"><a href="#Channel.channel_process-756"><span class="linenos">756</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel.channel_process-757"><a href="#Channel.channel_process-757"><span class="linenos">757</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-758"><a href="#Channel.channel_process-758"><span class="linenos">758</span></a>
</span><span id="Channel.channel_process-759"><a href="#Channel.channel_process-759"><span class="linenos">759</span></a>            <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;out&#39;</span> <span class="k">if</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span> <span class="k">else</span> <span class="s1">&#39;in&#39;</span>
</span><span id="Channel.channel_process-760"><a href="#Channel.channel_process-760"><span class="linenos">760</span></a>
</span><span id="Channel.channel_process-761"><a href="#Channel.channel_process-761"><span class="linenos">761</span></a>        <span class="c1"># If ship travels out</span>
</span><span id="Channel.channel_process-762"><a href="#Channel.channel_process-762"><span class="linenos">762</span></a>        <span class="c1"># Dont enter this if ship is going in even though ship_info[&#39;direction&#39;] is &#39;out&#39;</span>
</span><span id="Channel.channel_process-763"><a href="#Channel.channel_process-763"><span class="linenos">763</span></a>        <span class="k">elif</span> <span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
</span><span id="Channel.channel_process-764"><a href="#Channel.channel_process-764"><span class="linenos">764</span></a>            <span class="n">ship_entering_channel_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-765"><a href="#Channel.channel_process-765"><span class="linenos">765</span></a>
</span><span id="Channel.channel_process-766"><a href="#Channel.channel_process-766"><span class="linenos">766</span></a>            <span class="c1"># get pilots</span>
</span><span id="Channel.channel_process-767"><a href="#Channel.channel_process-767"><span class="linenos">767</span></a>            <span class="n">day</span> <span class="o">=</span> <span class="n">is_daytime</span><span class="p">(</span><span class="n">ship_entering_channel_time</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
</span><span id="Channel.channel_process-768"><a href="#Channel.channel_process-768"><span class="linenos">768</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel.channel_process-769"><a href="#Channel.channel_process-769"><span class="linenos">769</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-770"><a href="#Channel.channel_process-770"><span class="linenos">770</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel.channel_process-771"><a href="#Channel.channel_process-771"><span class="linenos">771</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-772"><a href="#Channel.channel_process-772"><span class="linenos">772</span></a>            <span class="n">time_to_get_pilot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">ship_entering_channel_time</span>
</span><span id="Channel.channel_process-773"><a href="#Channel.channel_process-773"><span class="linenos">773</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-774"><a href="#Channel.channel_process-774"><span class="linenos">774</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_pilot_out</span><span class="o">=</span><span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel.channel_process-775"><a href="#Channel.channel_process-775"><span class="linenos">775</span></a>
</span><span id="Channel.channel_process-776"><a href="#Channel.channel_process-776"><span class="linenos">776</span></a>            <span class="c1"># get tugs</span>
</span><span id="Channel.channel_process-777"><a href="#Channel.channel_process-777"><span class="linenos">777</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-778"><a href="#Channel.channel_process-778"><span class="linenos">778</span></a>            <span class="n">time_to_get_tugs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="Channel.channel_process-779"><a href="#Channel.channel_process-779"><span class="linenos">779</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span><span class="p">)</span>
</span><span id="Channel.channel_process-780"><a href="#Channel.channel_process-780"><span class="linenos">780</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-781"><a href="#Channel.channel_process-781"><span class="linenos">781</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_get_tugs_out</span><span class="o">=</span><span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="Channel.channel_process-782"><a href="#Channel.channel_process-782"><span class="linenos">782</span></a>
</span><span id="Channel.channel_process-783"><a href="#Channel.channel_process-783"><span class="linenos">783</span></a>            <span class="c1"># make a uturn</span>
</span><span id="Channel.channel_process-784"><a href="#Channel.channel_process-784"><span class="linenos">784</span></a>            <span class="n">time_to_uturn</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel.channel_process-785"><a href="#Channel.channel_process-785"><span class="linenos">785</span></a>                <span class="n">TIME_FOR_UTURN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_UTURN</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel.channel_process-786"><a href="#Channel.channel_process-786"><span class="linenos">786</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_uturn</span><span class="p">)</span>
</span><span id="Channel.channel_process-787"><a href="#Channel.channel_process-787"><span class="linenos">787</span></a>            <span class="n">time_for_uturn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> \
</span><span id="Channel.channel_process-788"><a href="#Channel.channel_process-788"><span class="linenos">788</span></a>                <span class="p">(</span><span class="n">ship_entering_channel_time</span> <span class="o">+</span> <span class="n">time_to_get_pilot</span> <span class="o">+</span> <span class="n">time_to_get_tugs</span><span class="p">)</span>
</span><span id="Channel.channel_process-789"><a href="#Channel.channel_process-789"><span class="linenos">789</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-790"><a href="#Channel.channel_process-790"><span class="linenos">790</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_for_uturn</span><span class="o">=</span><span class="n">time_for_uturn</span><span class="p">)</span>
</span><span id="Channel.channel_process-791"><a href="#Channel.channel_process-791"><span class="linenos">791</span></a>
</span><span id="Channel.channel_process-792"><a href="#Channel.channel_process-792"><span class="linenos">792</span></a>            <span class="c1"># steer the ship</span>
</span><span id="Channel.channel_process-793"><a href="#Channel.channel_process-793"><span class="linenos">793</span></a>            <span class="n">time_to_tug_steer</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel.channel_process-794"><a href="#Channel.channel_process-794"><span class="linenos">794</span></a>                <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_FOR_TUG_STEER</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel.channel_process-795"><a href="#Channel.channel_process-795"><span class="linenos">795</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel.channel_process-796"><a href="#Channel.channel_process-796"><span class="linenos">796</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-797"><a href="#Channel.channel_process-797"><span class="linenos">797</span></a>                             <span class="n">ship_terminal</span><span class="p">,</span> <span class="n">time_to_tug_steer_out</span><span class="o">=</span><span class="n">time_to_tug_steer</span><span class="p">)</span>
</span><span id="Channel.channel_process-798"><a href="#Channel.channel_process-798"><span class="linenos">798</span></a>
</span><span id="Channel.channel_process-799"><a href="#Channel.channel_process-799"><span class="linenos">799</span></a>            <span class="c1"># put the tugs back</span>
</span><span id="Channel.channel_process-800"><a href="#Channel.channel_process-800"><span class="linenos">800</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">tugboats</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;tugboats&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-801"><a href="#Channel.channel_process-801"><span class="linenos">801</span></a>
</span><span id="Channel.channel_process-802"><a href="#Channel.channel_process-802"><span class="linenos">802</span></a>            <span class="c1"># Schedule the ship to move through the channel</span>
</span><span id="Channel.channel_process-803"><a href="#Channel.channel_process-803"><span class="linenos">803</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_scheduer</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
</span><span id="Channel.channel_process-804"><a href="#Channel.channel_process-804"><span class="linenos">804</span></a>                <span class="k">yield</span> <span class="n">request</span>
</span><span id="Channel.channel_process-805"><a href="#Channel.channel_process-805"><span class="linenos">805</span></a>                <span class="n">request_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-806"><a href="#Channel.channel_process-806"><span class="linenos">806</span></a>                <span class="n">wait_daylight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-807"><a href="#Channel.channel_process-807"><span class="linenos">807</span></a>                <span class="n">wait_beam</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-808"><a href="#Channel.channel_process-808"><span class="linenos">808</span></a>                <span class="n">wait_draft</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-809"><a href="#Channel.channel_process-809"><span class="linenos">809</span></a>                <span class="c1"># Note that multiple restrictions can be active at the same time</span>
</span><span id="Channel.channel_process-810"><a href="#Channel.channel_process-810"><span class="linenos">810</span></a>                <span class="n">wait_total_restriction</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-811"><a href="#Channel.channel_process-811"><span class="linenos">811</span></a>                <span class="n">wait_queue</span> <span class="o">=</span> <span class="n">request_time</span> <span class="o">-</span> <span class="n">request_time_initial</span>
</span><span id="Channel.channel_process-812"><a href="#Channel.channel_process-812"><span class="linenos">812</span></a>                <span class="n">wait_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Channel.channel_process-813"><a href="#Channel.channel_process-813"><span class="linenos">813</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safeTwoway</span><span class="p">:</span>
</span><span id="Channel.channel_process-814"><a href="#Channel.channel_process-814"><span class="linenos">814</span></a>                    <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel.channel_process-815"><a href="#Channel.channel_process-815"><span class="linenos">815</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel.channel_process-816"><a href="#Channel.channel_process-816"><span class="linenos">816</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-817"><a href="#Channel.channel_process-817"><span class="linenos">817</span></a>                    <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-818"><a href="#Channel.channel_process-818"><span class="linenos">818</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-819"><a href="#Channel.channel_process-819"><span class="linenos">819</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-820"><a href="#Channel.channel_process-820"><span class="linenos">820</span></a>                            <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-821"><a href="#Channel.channel_process-821"><span class="linenos">821</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-822"><a href="#Channel.channel_process-822"><span class="linenos">822</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-823"><a href="#Channel.channel_process-823"><span class="linenos">823</span></a>                    <span class="k">while</span> <span class="n">restrcictions</span> <span class="ow">or</span> <span class="n">channel_closed_outbound</span> <span class="ow">or</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel.channel_process-824"><a href="#Channel.channel_process-824"><span class="linenos">824</span></a>
</span><span id="Channel.channel_process-825"><a href="#Channel.channel_process-825"><span class="linenos">825</span></a>                        <span class="k">if</span> <span class="n">channel_closed_outbound</span><span class="p">:</span>
</span><span id="Channel.channel_process-826"><a href="#Channel.channel_process-826"><span class="linenos">826</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Channel closed outbound at time&quot;</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-827"><a href="#Channel.channel_process-827"><span class="linenos">827</span></a>
</span><span id="Channel.channel_process-828"><a href="#Channel.channel_process-828"><span class="linenos">828</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-829"><a href="#Channel.channel_process-829"><span class="linenos">829</span></a>                        <span class="n">wait_total_restriction</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-830"><a href="#Channel.channel_process-830"><span class="linenos">830</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-831"><a href="#Channel.channel_process-831"><span class="linenos">831</span></a>                        <span class="n">restrcictions</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restrictions</span><span class="p">(</span>
</span><span id="Channel.channel_process-832"><a href="#Channel.channel_process-832"><span class="linenos">832</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">,</span> <span class="n">wait_beam</span><span class="p">,</span> <span class="n">wait_draft</span><span class="p">,</span> <span class="n">wait_daylight</span><span class="p">)</span>
</span><span id="Channel.channel_process-833"><a href="#Channel.channel_process-833"><span class="linenos">833</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-834"><a href="#Channel.channel_process-834"><span class="linenos">834</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-835"><a href="#Channel.channel_process-835"><span class="linenos">835</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-836"><a href="#Channel.channel_process-836"><span class="linenos">836</span></a>
</span><span id="Channel.channel_process-837"><a href="#Channel.channel_process-837"><span class="linenos">837</span></a>                        <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-838"><a href="#Channel.channel_process-838"><span class="linenos">838</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-839"><a href="#Channel.channel_process-839"><span class="linenos">839</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-840"><a href="#Channel.channel_process-840"><span class="linenos">840</span></a>                                <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-841"><a href="#Channel.channel_process-841"><span class="linenos">841</span></a>
</span><span id="Channel.channel_process-842"><a href="#Channel.channel_process-842"><span class="linenos">842</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Channel.channel_process-843"><a href="#Channel.channel_process-843"><span class="linenos">843</span></a>                    <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-844"><a href="#Channel.channel_process-844"><span class="linenos">844</span></a>                    <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-845"><a href="#Channel.channel_process-845"><span class="linenos">845</span></a>
</span><span id="Channel.channel_process-846"><a href="#Channel.channel_process-846"><span class="linenos">846</span></a>                    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-847"><a href="#Channel.channel_process-847"><span class="linenos">847</span></a>                        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-848"><a href="#Channel.channel_process-848"><span class="linenos">848</span></a>                            <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-849"><a href="#Channel.channel_process-849"><span class="linenos">849</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-850"><a href="#Channel.channel_process-850"><span class="linenos">850</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-851"><a href="#Channel.channel_process-851"><span class="linenos">851</span></a>                    <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-852"><a href="#Channel.channel_process-852"><span class="linenos">852</span></a>                        <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-853"><a href="#Channel.channel_process-853"><span class="linenos">853</span></a>                    <span class="k">while</span> <span class="n">channel_closwed</span> <span class="ow">or</span> <span class="n">channel_closed_outbound</span> <span class="ow">or</span> <span class="n">no_spacing</span><span class="p">:</span>
</span><span id="Channel.channel_process-854"><a href="#Channel.channel_process-854"><span class="linenos">854</span></a>                        <span class="n">wait_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-855"><a href="#Channel.channel_process-855"><span class="linenos">855</span></a>                        <span class="n">request_time</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Channel.channel_process-856"><a href="#Channel.channel_process-856"><span class="linenos">856</span></a>                        <span class="n">channel_closwed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_closed</span><span class="p">(</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-857"><a href="#Channel.channel_process-857"><span class="linenos">857</span></a>                        <span class="n">no_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_spacing_not_avlbl</span><span class="p">(</span>
</span><span id="Channel.channel_process-858"><a href="#Channel.channel_process-858"><span class="linenos">858</span></a>                            <span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-859"><a href="#Channel.channel_process-859"><span class="linenos">859</span></a>
</span><span id="Channel.channel_process-860"><a href="#Channel.channel_process-860"><span class="linenos">860</span></a>                        <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Channel.channel_process-861"><a href="#Channel.channel_process-861"><span class="linenos">861</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">outbound_closed_tuples</span><span class="p">:</span>
</span><span id="Channel.channel_process-862"><a href="#Channel.channel_process-862"><span class="linenos">862</span></a>                            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">request_time</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Channel.channel_process-863"><a href="#Channel.channel_process-863"><span class="linenos">863</span></a>                                <span class="n">channel_closed_outbound</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Channel.channel_process-864"><a href="#Channel.channel_process-864"><span class="linenos">864</span></a>
</span><span id="Channel.channel_process-865"><a href="#Channel.channel_process-865"><span class="linenos">865</span></a>                <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel.channel_process-866"><a href="#Channel.channel_process-866"><span class="linenos">866</span></a>                                 <span class="n">time_for_restriction_out</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B:</span><span class="si">{</span><span class="n">wait_beam</span><span class="si">}</span><span class="s1">, D:</span><span class="si">{</span><span class="n">wait_draft</span><span class="si">}</span><span class="s1">, DL:</span><span class="si">{</span><span class="n">wait_daylight</span><span class="si">}</span><span class="s1">, Q:</span><span class="si">{</span><span class="n">wait_queue</span><span class="si">}</span><span class="s1">, T:</span><span class="si">{</span><span class="n">wait_total</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Channel.channel_process-867"><a href="#Channel.channel_process-867"><span class="linenos">867</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span>
</span><span id="Channel.channel_process-868"><a href="#Channel.channel_process-868"><span class="linenos">868</span></a>                               <span class="n">enter_time</span><span class="o">=</span><span class="n">request_time</span><span class="p">)</span>
</span><span id="Channel.channel_process-869"><a href="#Channel.channel_process-869"><span class="linenos">869</span></a>
</span><span id="Channel.channel_process-870"><a href="#Channel.channel_process-870"><span class="linenos">870</span></a>            <span class="c1"># travel through the channel</span>
</span><span id="Channel.channel_process-871"><a href="#Channel.channel_process-871"><span class="linenos">871</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">request_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
</span><span id="Channel.channel_process-872"><a href="#Channel.channel_process-872"><span class="linenos">872</span></a>            <span class="n">time_entered_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
</span><span id="Channel.channel_process-873"><a href="#Channel.channel_process-873"><span class="linenos">873</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move_through_channel</span><span class="p">(</span><span class="n">ship_info</span><span class="p">,</span> <span class="n">lastSection</span><span class="p">,</span> <span class="n">run_id</span><span class="p">))</span>
</span><span id="Channel.channel_process-874"><a href="#Channel.channel_process-874"><span class="linenos">874</span></a>            <span class="n">time_to_travel_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">time_entered_channel</span>
</span><span id="Channel.channel_process-875"><a href="#Channel.channel_process-875"><span class="linenos">875</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel.channel_process-876"><a href="#Channel.channel_process-876"><span class="linenos">876</span></a>                             <span class="n">time_to_travel_channel_out</span><span class="o">=</span><span class="n">time_to_travel_channel</span><span class="p">)</span>
</span><span id="Channel.channel_process-877"><a href="#Channel.channel_process-877"><span class="linenos">877</span></a>
</span><span id="Channel.channel_process-878"><a href="#Channel.channel_process-878"><span class="linenos">878</span></a>            <span class="c1"># travel from mouth of the channel to anchorage</span>
</span><span id="Channel.channel_process-879"><a href="#Channel.channel_process-879"><span class="linenos">879</span></a>            <span class="n">time_to_common_channel</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="Channel.channel_process-880"><a href="#Channel.channel_process-880"><span class="linenos">880</span></a>                <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TIME_COMMON_CHANNEL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Channel.channel_process-881"><a href="#Channel.channel_process-881"><span class="linenos">881</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel.channel_process-882"><a href="#Channel.channel_process-882"><span class="linenos">882</span></a>            <span class="n">update_ship_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ship_logs</span><span class="p">,</span> <span class="n">ship_type</span><span class="p">,</span> <span class="n">ship_id</span><span class="p">,</span> <span class="n">ship_terminal</span><span class="p">,</span>
</span><span id="Channel.channel_process-883"><a href="#Channel.channel_process-883"><span class="linenos">883</span></a>                             <span class="n">time_to_common_channel_out</span><span class="o">=</span><span class="n">time_to_common_channel</span><span class="p">)</span>
</span><span id="Channel.channel_process-884"><a href="#Channel.channel_process-884"><span class="linenos">884</span></a>
</span><span id="Channel.channel_process-885"><a href="#Channel.channel_process-885"><span class="linenos">885</span></a>            <span class="c1"># Release pilots</span>
</span><span id="Channel.channel_process-886"><a href="#Channel.channel_process-886"><span class="linenos">886</span></a>            <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
</span><span id="Channel.channel_process-887"><a href="#Channel.channel_process-887"><span class="linenos">887</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span><span id="Channel.channel_process-888"><a href="#Channel.channel_process-888"><span class="linenos">888</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Channel.channel_process-889"><a href="#Channel.channel_process-889"><span class="linenos">889</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">night_pilots</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">ship_info</span><span class="p">[</span><span class="s1">&#39;pilots&#39;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Process for handling the ship's entry into the channel.
It handles the scheduling and movement of the ship through the channel, including checking for restrictions and logging the ship's information.
The process has the following steps:</p>

<ol>
<li>Check if the ship is entering or leaving the channel based on its direction.</li>
<li>If the ship is entering the channel, then:
2.1. Get the pilots based on the time of day (day or night).
2.2. Check when the ship is allowed to enter being free of restrictions.
2.3 Schedule the ship to move through the channel.
2.4 Wait till the ship can move through the channel.
2.5 Move the ship through the channel.
2.6 Get the tugboats and steer the ship.</li>
<li>If the ship is leaving the channel, then:
3.1. Get the pilots based on the time of day (day or night).
3.2 Get the tugboats and steer the ship.
3.3.Check when the ship is allowed to leave being free of restrictions.
3.4 Schedule the ship to move through the channel.
3.5 Wait till the ship can move through the channel.
3.6 Move the ship through the channel.</li>
</ol>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>ship_info (dict):</strong>  Information about the ship, including its direction, pilots, tugboats, and other attributes.</li>
<li><strong>day (bool):</strong>  Whether it is daytime or nighttime.</li>
<li><strong>lastSection (int):</strong>  The last section of the channel to check.</li>
<li><strong>ship_id (int):</strong>  The identifier for the ship.</li>
<li><strong>ship_terminal (str):</strong>  The terminal where the ship is headed.</li>
<li><strong>ship_type (str):</strong>  The type of the ship (e.g., Container, Liquid, DryBulk).</li>
<li><strong>run_id (int):</strong>  The identifier for the current simulation run.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>